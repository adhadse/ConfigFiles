{"version":3,"sources":["webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/tokens.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/positioning.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/extractors/regexp.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/overrides/tokens.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/index.css?745c","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/adapter_manager.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/converter.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/connection_manager.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/overrides/maps.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/console.css?14a4","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/virtual/console.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/virtual/document.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/editor_integration/editor_adapter.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/adapters/adapter.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/adapters/file_editor/file_editor.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/adapters/file_editor/index.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/adapters/notebook/notebook.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/adapters/notebook/index.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/command_manager.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/statusbar.css?4498","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/errors.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/code-check.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/code-clock.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/code-warning.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/components/icons.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/components/utils.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/components/statusbar.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/extractors/manager.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/completion.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/feature.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/lsp.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/editor_integration/codemirror.js","webpack://@jupyterlab/application-top/./node_modules/vscode-languageserver-types/lib/esm/main.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/completion/item.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/completion/completion_handler.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/completion/model.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/completion/renderer.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/completion/completion.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/completion/index.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/diagnostics.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/jump-to.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/jump_to.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/diagnostics_listing.css?3362","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/diagnostics/listing.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/diagnostics/diagnostics.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/diagnostics/index.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/highlight-type.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/highlight.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/highlights.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/hover.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/components/free_tooltip.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/hover.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/rename.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/rename.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/signature.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/icons/syntax-highlight.svg","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/features/syntax_highlighting.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/manager.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/overrides/index.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython/extractors.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython/overrides.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython/index.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython-bigquery/extractors.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython-bigquery/index.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython-rpy2/rpy2.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython-rpy2/extractors.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython-rpy2/overrides.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython-rpy2/index.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython-sql/extractors.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/ipython-sql/index.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/transclusions/defaults.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/virtual/codemirror_editor.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/virtual/editor.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/index.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/lib/utils.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/node_modules/@krassowski/completion-theme/lib/types.js","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/console.css","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/diagnostics_listing.css","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/highlight.css","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/index.css","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/signature.css","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/statusbar.css","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/tooltip.css","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/variables/base.css","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/variables/cm-themes.css","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/variables/jupyterlab-dark.css","webpack://@jupyterlab/application-top/./node_modules/@krassowski/jupyterlab-lsp/style/variables/jupyterlab-light.css"],"names":["ILanguageServerManager","URL_NS","PLUGIN_ID","ILSPFeatureManager","Token","ILSPAdapterManager","ILSPVirtualEditorManager","ILSPCodeExtractorsManager","ILSPLogConsole","is_equal","self","other","line","ch","position_at_offset","offset","lines","column","text_line","length","offset_at_position","position","lines_include_breaks","break_increment","i","PositionError","Error","getIndexOfCaptureGroup","expression","matched_string","value_of_captured_group","captured_groups","exec","console","warn","offset_in_match","full_matched","group","slice","indexOf","group_end_offset","RegExpForeignCodeExtractor","constructor","options","this","language","global_expression","RegExp","pattern","test_expression","standalone","is_standalone","file_extension","has_foreign_code","code","result","test","lastIndex","extract_foreign_code","split","extracts","Array","started_from","match","host_code_fragment","chosen_replacer","is_new_api_replacer","foreign_replacer","foreign_capture_groups","join","extract_to_foreign","position_shift","foreign_code_fragment","replace","prefix","extract_arguments","end_index","keep_in_host","substring","index","foreign_code_group_value","Math","min","foreign_group_index_in_match","start_offset","start","end","push","host_code","foreign_code","range","virtual_shift","final_host_code_fragment","ILSPCodeOverridesManager","insert","singleton","update","WidgetAdapterManager","shell","adapters","Map","adapterChanged","Signal","adapterDisposed","adapterTypeAdded","adapterTypes","currentChanged","connect","refreshAdapterFromCurrentWidget","registerAdapterType","emit","extension","type","tracker","widgetAdded","widget","connectWidget","registerExtension","manager","adapter","registerAdapter","id","get_id","re_connector","current","currentWidget","has","get","currentAdapter","old","set","disconnect","delete","disposed","context","pathChanged","reconnect","dispose","isAnyActive","some","WIDGET_ADAPTER_MANAGER","activate","app","provides","autoStart","PositionConverter","character","DocumentConnectionManager","on_new_connection","connection","on","e","error","message","forEachDocumentOfConnection","virtual_document","uri","closed","ignored_languages","add","capabilities","initialized","updateServerConfigurations","initial_configurations","closed_manually","connections","documents","Set","connected","disconnected","documents_changed","language_server_manager","Private","setLanguageServerManager","connect_document_signals","foreign_document_opened","on_foreign_document_opened","foreign_document_closed","on_foreign_document_closed","disconnect_document_signals","foreign","foreign_documents","values","_host","log","foreign_document","uris","solve_uris","matchingServers","getMatchingServers","debug","language_server_id","updateConfiguration","allServerSettings","setConfiguration","hasOwnProperty","rawSettings","parsedSettings","serverSettings","settings","updateServerConfiguration","callback","virtual_document_uri","a_connection","entries","reconnect_delay","retrials_left","interval","success","then","catch","firstTimeoutSeconds","secondTimeoutMinutes","connect_socket","document_path","isReady","round","_a","_b","unregister_document","updateLogging","logAllCommunication","setTrace","clientNotifications","value","wsBase","PageConfig","rootUri","virtualDocumentsUri","baseUri","has_lsp_supported_file","getLanguageServerManager","documentUri","URLExt","startsWith","base","document","server","socket","_connections","_promise","_language_server_manager","async","onCreate","LSPConnection","WebSocket","languageId","serverUri","serverIdentifier","setMaxListeners","sendConfigurationChange","OverridesMap","magic_overrides","super","map","m","replacement","_override_for","key","ReversibleOverridesMap","overrides","filter","override","reverse","override_for","cell","replace_all","raw_lines","substituted_lines","skip_inspect","reverse_replace_all","to_string","args","arg","textual","JSON","stringify","k","FloatingConsole","scope","element","createElement","className","body","appendChild","bindThis","remove","append","text","kind","entry","innerHTML","scrollTop","scrollHeight","BrowserConsole","window","bind","ConsoleWrapper","breadcrumbs","_scope","changed","_rebind_functions","no_op","bind_arg","implementation","verbosity","ConsoleSingleton","setting_registry","load","updateSettings","composite","loggingConsole","loggingLevel","LOG_CONSOLE","requires","ISettingRegistry","is_within_range","VirtualDocumentInfo","version","_document","VirtualDocument","isDisposed","blank_lines_between_cells","path","parent","overrides_registry","cell_magics_overrides","line_magics_overrides","foreign_extractors_registry","foreign_code_extractors","foreign_extractors","virtual_lines","source_lines","instance_id","instances_count","unused_standalone_documents","_remaining_lifetime","unused_documents","document_info","update_manager","UpdateManager","clear","doc","close_all_foreign_documents","line_blocks","Infinity","last_virtual_line","last_source_line","forward_closed_signal","host","forward_opened_signal","open_foreign","Object","assign","parent_host","virtual_id","document_at_source_position","source_line","source_position_ce","editor_line","foreign_documents_map","source_position_cm","is_within_foreign","source_position","virtual_position_at_document","virtual_line","choose_foreign_document","extractor","foreign_exists","unused_standalone","pop","block","editor_shift","foreign_document_map","cell_code","results","kept_cell_code","editor","ce_editor","foreign_shift","append_code_block","cell_code_kept","decode_code_block","raw_code","cell_override","prepare_code_block","l","id_path","skip","maps","source_cell_lines","lines_padding","repeat","lines_in_last_block","close_expired_documents","remaining_lifetime","close_foreign","ancestry","concat","encodedPath","encodeURI","transform_source_to_editor","pos","transform_virtual_to_editor","virtual_position","transform_virtual_to_source","root","get_editor_at_virtual_line","get_editor_at_source_line","maybe_emit_changed","previous_value","collect_documents","collected","foreign_languages","forEach","is_update_in_progress","update_lock","update_done","Promise","resolve","document_updated","block_added","update_began","update_finished","on_updated","root_document","can_update","fn","blocks","reject","code_block","EditorAdapter","features","change","saveChange","feature","register","is_registered","last_change","err","root_position","get_cursor_position","document_at_root_position","afterChange","invalidateLastChange","undefined","sender","createButton","Dialog","StatusMessage","timer","timeout","expire_timer","setTimeout","clearTimeout","mime_type_language_map","WidgetAdapter","connection_manager","adapterConnected","activeEditorChanged","editorRemoved","editorAdded","status_message","isConnected","trans","translator","nullTranslator","saveState","on_save_state","on_connection_closed","code_overrides","virtual_editor","disconnect_adapter","mime_type","without_parameters","subtype","substr","model","contentChanged","onContentChanged","editors","reload_connection","init_virtual","connect_document","state","completedManually","documents_to_save","sendSaved","update_documents","get_editor_value","data","connect_adapter","promise","document_changed","loggerSourceName","user_console","logger","getLogger","serverNotifications","showDialog","title","__","serverRequests","setHandler","params","actionItems","actions","buttons","action","label","choice","button","send_open","connection_context","sendOpenWhenReady","create_virtual_editor","editorType","editor_type_manager","findBestImplementation","virtualEditorConstructor","create_virtual_document","connect_contentChanged_signal","is_init","sendFullTextChange","with_update_lock","updateAfterChange","create_adapter","get_features","textDocument","synchronization","dynamicRegistration","willSave","didSave","willSaveWaitUntil","workspace","didChangeConfiguration","feature_manager","on_connected","adapter_features","featureEditorIntegrationConstructor","editorIntegrationFactory","editor_name","integration","_slot","get_position_from_context_menu","leaf_node","contextMenuHitTest","left","top","getBoundingClientRect","event","_contextMenuEvent","clientX","clientY","stopPropagation","window_coords_to_root_position","get_context","root_position_to_virtual_position","get_context_from_context_menu","FileEditorAdapter","editor_widget","content","init_once_ready","codeMirrorMimeType","mimeType","contentsModel","fileType","docRegistry","getFileTypeForModel","mimeTypes","parts","ready","mimeTypeChanged","get_editor_index","get_editor_wrapper","wrapper_element","node","context_from_active_document","ce_cursor","getCursorPosition","ce_to_cm","get_editor_index_at","language_file_extension","FileEditorContextMenuEntryPoint","FILE_EDITOR_ADAPTER","optional","IEditorTracker","adapterManager","fileEditorTracker","name","entrypoint","context_menu","selector","rank_group","rank_group_size","NotebookAdapter","is_ready","isVisible","widgets","sessionContext","session","kernel","ce_editor_to_cell","known_editors_ids","_c","_d","language_info","info","_language_info","_session","newValue","old_language_info","update_language_info","new_language_info","mimetype","kernelChanged","on_kernel_changed","activeCellChanged","language_metadata","codeMimetype","_connectModelSignals","modelChanged","notebook","cells","handle_cell_change","cellsAdded","cellsRemoved","convertedToMarkdownOrRaw","convertedToCode","newValues","oldValues","cellModel","cellWidget","find","uuid","activeCell","cm_cursor","transform_from_editor_to_root","get_cell_at","findIndex","other_cell","CellContextMenuEntryPoint","NOTEBOOK_ADAPTER","INotebookTracker","notebookTracker","Number","EPSILON","add_context_separator","is_context_menu_over_token","token","get_token_at","LSPCommandManager","add_to_palette","category","adapter_manager","palette","suffix","entry_point","commands","cmd","create_id","addCommand","execute","isEnabled","is_enabled","is_visible","icon","should_attach","attach_command","addItem","command","attach_to","ContextCommandManager","contextMenu","rank","get_rank","position_in_group","menu","isAttached","is_context_menu_open","current_adapter","is_widget_current","is_relative","is_rank_relative","relative","external_link","url","href","target","rel","migration_guide_url","jupyter_hub_migration_url","SERVER_EXTENSION_404","codeWarningIcon","LabIcon","svgstr","codeClockIcon","codeCheckIcon","getBreadcrumbs","collapse","endsWith","full_path","size","has_multiple_editors","first_line","last_line","first_cell","last_cell","cell_locator","get_breadcrumbs","focus_on","scrollIntoView","focus","DocumentLocator","props","onClick","okButton","ServerStatus","list","spec","languages","display_name","CollapsibleList","handleClick","setState","isCollapsed","startCollapsed","render","collapseExpandIcon","caretUpIcon","caretDownIcon","react","tag","LanguageServerInfo","specification","specs","urls","serverId","troubleshoot","install","HelpButton","arguments","servers","_n","LSPPopup","VDomRenderer","addClass","servers_available","servers_available_not_in_use","running_servers","documents_by_language","documents_by_server","documents_html","status","isInitialized","circleIcon","circleEmptyIcon","elementSize","missing_languages","specs_for_missing","getMatchingSpecs","SELECTED_CLASS","LSPStatus","widget_manager","displayText","Model","_popup","showPopup","anchor","align","interactiveItem","caption","interactiveStateObserver","MutationObserver","has_selected","classList","contains","removeClass","onAfterAttach","msg","observe","attributes","attributeFilter","onBeforeDetach","GroupItem","spacing","long_message","status_icon","TextItem","source","short_message","feature_message","StatusButtonExtension","createItem","status_bar_item","translator_bundle","createNew","panel","item","toolbar","insertAfter","collect_languages","toLocaleLowerCase","classByStatus","no_server_extension","waiting","initializing","initialized_but_some_missing","connecting","iconByStatus","shortMessageByStatus","VDomModel","widget_adapter_manager","server_extension_status","_onChange","stateChanged","_adapter","change_adapter","sessions","available_servers","is_server_running","detected_languages","matchedServers","main_document","server_ids","_connection_manager","documents_map","supported_languages","detected_documents","all_documents","detected_documents_set","connected_documents","initialized_documents","absent_documents","documents_with_available_servers","documents_with_known_servers","open_connections","statusCode","stopIcon","bindprops","uninitialized","_np","unconnected","CodeExtractorsManager","registry","host_language","CODE_EXTRACTORS_MANAGER","FeatureSettings","settingRegistry","featureID","plugins","accept","setting","DiagnosticSeverity","DiagnosticTag","CompletionItemTag","CompletionItemKind","DocumentHighlightKind","CompletionTriggerKind","AdditionalCompletionTriggerKinds","Languages","toDocumentChanges","changes","documentChanges","keys","edits","offset_from_lsp","lsp_to_ce","CodeMirrorIntegration","editor_handlers","connection_handlers","wrapper_handlers","labIntegration","event_name","handler","wrapper","getWrapperElement","addEventListener","off","removeEventListener","range_to_editor_range","cm_editor","lsp_to_cm","start_in_root","transform_virtual_position_to_root_position","get_editor_at_root_position","ce_editor_to_cm_editor","position_from_mouse","coordsChar","editor_position","get_cm_editor","get_language_at","getModeAt","extract_last_character","origin","highlight_range","class_name","getDoc","markText","is_whole_document_edit","edit","workspaceEdit","current_uri","applied_changes","edited_cells","errors","edits_by_offset","old_to_new_line","new_text","last_end","current_old_line","current_new_line","start_offsets","sort","a","b","new_lines","get_or_create","newText","replaced_fragment","assert","apply_single_edit","all_empty","every","appliedChanges","modifiedCells","wasGranular","replace_fragment","fragment_start","fragment_end","newFragmentText","raw_value","getValue","old_value","cm_to_ce","up_to_offset","from_offset","new_value","cursor","getCursor","replaceRange","setCursor","scroll","start_editor","end_editor","last_editor","recently_replaced","DocumentUri","is","URI","integer","MIN_VALUE","MAX_VALUE","uinteger","Position","create","candidate","Is","objectLiteral","Range","one","two","three","four","Location","string","LocationLink","targetUri","targetRange","targetSelectionRange","originSelectionRange","Color","red","green","blue","alpha","numberRange","ColorInformation","color","ColorPresentation","textEdit","additionalTextEdits","TextEdit","typedArray","FoldingRangeKind","Comment","Imports","Region","FoldingRange","startLine","endLine","startCharacter","endCharacter","collapsedText","defined","DiagnosticRelatedInformation","location","Warning","Information","Hint","Unnecessary","Deprecated","CodeDescription","Diagnostic","severity","relatedInformation","number","codeDescription","Command","_i","del","ChangeAnnotation","needsConfirmation","description","boolean","ChangeAnnotationIdentifier","AnnotatedTextEdit","annotation","annotationId","TextDocumentEdit","OptionalVersionedTextDocumentIdentifier","isArray","CreateFile","overwrite","ignoreIfExists","RenameFile","oldUri","newUri","DeleteFile","recursive","ignoreIfNotExists","WorkspaceEdit","TextEditChangeImpl","changeAnnotations","prototype","assertChangeAnnotations","manage","all","splice","ChangeAnnotations","annotations","_annotations","_counter","_size","defineProperty","enumerable","configurable","idOrAnnotation","nextId","toString","WorkspaceChange","_this","_textEditChanges","_workspaceEdit","_changeAnnotations","textEditChange","initDocumentChanges","getTextEditChange","textDocumentEdit","initChanges","createFile","optionsOrAnnotation","operation","renameFile","deleteFile","TextDocumentIdentifier","VersionedTextDocumentIdentifier","TextDocumentItem","MarkupKind","PlainText","Markdown","MarkupContent","Text","Method","Function","Constructor","Field","Variable","Class","Interface","Module","Property","Unit","Value","Enum","Keyword","Snippet","File","Reference","Folder","EnumMember","Constant","Struct","Event","Operator","TypeParameter","InsertTextFormat","InsertReplaceEdit","InsertTextMode","asIs","adjustIndentation","CompletionItemLabelDetails","detail","CompletionItem","CompletionList","items","isIncomplete","MarkedString","fromPlainText","plainText","Hover","contents","ParameterInformation","documentation","SignatureInformation","parameters","Read","Write","DocumentHighlight","SymbolKind","Namespace","Package","String","Boolean","Key","Null","SymbolTag","SymbolInformation","containerName","WorkspaceSymbol","DocumentSymbol","selectionRange","children","deprecated","tags","CodeActionKind","Empty","QuickFix","Refactor","RefactorExtract","RefactorInline","RefactorRewrite","Source","SourceOrganizeImports","SourceFixAll","CodeActionTriggerKind","Invoked","Automatic","CodeActionContext","diagnostics","only","triggerKind","CodeAction","kindOrCommandOrEdit","checkKind","isPreferred","CodeLens","FormattingOptions","tabSize","insertSpaces","DocumentLink","SelectionRange","SemanticTokenTypes","SemanticTokenModifiers","SemanticTokens","resultId","InlineValueText","InlineValueVariableLookup","variableName","caseSensitiveLookup","InlineValueEvaluatableExpression","InlineValueContext","frameId","stoppedLocation","InlayHintKind","Type","Parameter","InlayHintLabelPart","tooltip","InlayHint","textEdits","paddingLeft","paddingRight","WorkspaceFolder","EOL","TextDocument","FullTextDocument","lineCount","func","getText","positionAt","offsetAt","applyEdits","sortedEdits","mergeSort","diff","lastModifiedOffset","startOffset","endOffset","compare","p","right","leftIdx","rightIdx","ret","_uri","_languageId","_version","_content","_lineOffsets","getLineOffsets","lineOffsets","isLineStart","charAt","max","low","high","mid","floor","lineOffset","nextLineOffset","call","check","LazyCompletionItem","connector","_setDocumentation","_requested_resolution","_resolved","_detail","_is_documentation_markdown","_documentation","_currentInsertText","insertText","sortText","filterText","supportsResolution","get_connection","isCompletionResolveProvider","needsResolution","isResolved","getCompletionResolve","resolvedCompletionItem","should_show_documentation","ICompletionItemsResponseType","CompletionHandler","LSPConnector","responseType","_editor","_context_connector","ContextConnector","kernel_options","_kernel_connector","KernelConnector","_kernel_and_context_connector","CompletionConnector","lab_integration","kernelCompletionsFirst","disableCompletionsFrom","suppressContinuousHintingIn","suppressTriggerCharacterIn","showDocumentation","waitForBusyKernel","kernelResponseTimeout","request","getTokenForPosition","trigger_kind","AutoInvoked","suppress_continuous_hinting_in","TriggerCharacter","suppress_trigger_character_in","getPositionAt","position_in_token","typed_character","end_in_root","cursor_in_root","virtual_start","virtual_end","virtual_cursor","lsp_promise","use_lsp_completions","fetch_lsp","kernelTimeout","_kernel_timeout","use_kernel_completions","_has_kernel","_is_kernel_idle","_should_wait_for_busy_kernel","kernelLanguage","_kernel_language","toLowerCase","default_kernel_promise","fetch","kernel_promise","race","matches","metadata","lsp","replies","transform_reply","merge_replies","fallback_connector","reply","suppress_if_needed","lspCompletionItems","getCompletion","all_non_prefixed","includes","pathPrefix","completionItem","icon_for","prefix_offset","response","priority","themeManager","get_icon","types","_jupyter_types_experimental","kernel_completions_first","fallbackIcon","minEnd","minStart","maxStart","getLine","insertTextSet","processedItems","trim","processedItem","query","save","cursor_at_request","hasFocus","cursor_now","escapeHTML","textContent","GenericCompleterModel","CompleterModel","defaultOptions","completionItems","unfilteredItems","_sortAndFilter","setCompletionItems","preFilterMatches","_markFragment","getFilterText","getHighlightableLabelRegion","matched","filterMatch","lowerCaseQuery","caseSensitive","StringExt","includePerfectMatches","labelMatch","labelPrefix","score","marked","indices","itemClone","getPrototypeOf","getOwnPropertyDescriptors","compareMatches","x","delta","localeCompare","LSPCompleterModel","LSPCompletionRenderer","Completer","ITEM_PLACEHOLDER_CLASS","EXTRA_INFO_CLASS","activeChanged","itemShown","elementToItem","WeakMap","wasActivated","visibilityObserver","IntersectionObserver","isIntersecting","li","threshold","activityObserver","mutations","mutation","HTMLLIElement","inactive","getExtraInfo","_e","_f","labelExtra","integrator","updateExtraInfo","extraText","extraElement","getElementsByClassName","createCompletionItemNode","orderedTypes","lsp_item","createDocumentationNode","isDocumentationMarkdown","markdownRenderer","renderModel","trusted","setData","latexTypesetter","typeset","DOC_PANEL_SELECTOR","DOC_PANEL_PLACEHOLDER_CLASS","CompletionCM","_completionCharacters","getLanguageCompletionCharacters","last_character","completionCharacters","invoke_completer","continuousHinting","CompletionLabIntegration","completionManager","completionThemeManager","renderMimeRegistry","_latestActiveItem","markdown_renderer","createRenderer","renderer","active_completion_changed","resolve_and_update","disable","swap_adapter","set_theme","theme","set_icons_overrides","typesMap","dataset","lspCompleterLayout","layout","current_completion_handler","fetchDocumentation","set_doc_panel_placeholder","refresh_doc_panel","active_completion","current_index","current_items","previous","resolve_and_update_from_item","next","set_connector","connect_completion","activeEditor","set_completion_connector","current_completion_connector","completer","editor_changed","_activeIndex","active","docPanel","querySelector","setAttribute","enable","completionIcon","completion","FEATURE_ID","COMPLETION_PLUGIN","ICompletionManager","IRenderMimeRegistry","featureManager","iconsThemeManager","logConsole","snippetSupport","commitCharactersSupport","documentationFormat","deprecatedSupport","preselectSupport","tagSupport","valueSet","contextSupport","jumpToIcon","jumpBackIcon","CMJumpToDefinition","jumper","modifierKey","getDefinition","targets","handle_jump","preventDefault","get_uri_and_range","location_or_locations","locations","location_or_link","document_uri","target_info","editor_index","editor_position_ce","contents_path","global_jump","is_symlink","jump_data","decodeURIComponent","document_manager","services","JumperLabIntegration","documentManager","jumpers","fileEditor","CodeMirrorEditor","FileEditorJumper","NotebookJumper","COMMANDS","jump_feature","isDefinitionSupported","global_jump_back","JUMP_PLUGIN","IDocumentManager","ITranslator","declaration","linkSupport","definition","typeDefinition","DIAGNOSTICS_LISTING_CLASS","DIAGNOSTICS_PLACEHOLDER_CLASS","DiagnosticsDatabase","apply","Column","render_cell","is_available","render_header","listing","SortableTH","is_sort_key","sort_key","sortIcon","sort_direction","message_without_code","diagnostic","code_str","DiagnosticsListing","severityTranslations","columns","row","db","cell_number","diagnostics_db","by_document","from","diagnostic_data","cell_id","find_editor","flattened","_diagnostics","sorted_column","sorter","sorted","columns_to_display","elements","jump_to","columns_headers","get_diagnostic","diagnosticsIcon","CMD_COLUMN_VISIBILITY","CMD_JUMP_TO_DIAGNOSTIC","CMD_COPY_DIAGNOSTIC","CMD_IGNORE_DIAGNOSTIC_CODE","CMD_IGNORE_DIAGNOSTIC_MSG","escapeRegExp","DiagnosticsPanel","_widget","initWidget","MainAreaWidget","closable","get_column","columns_menu","Menu","isToggled","submenu","ignore_diagnostics_menu","get_row","tr","tagName","ignoreCodes","refreshDiagnostics","ignoreMessagesPatterns","navigator","clipboard","writeText","prompt","copyIcon","diagnostics_panel","diagnostics_databases","DiagnosticsCM","marked_diagnostics","switchDiagnosticsPanelSource","handleDiagnostic","last_response","setDiagnostics","unique_editor_ids","clearDocumentDiagnostics","collapseOverlappingDiagnostics","range_id_to_range","range_id_to_diagnostics","get_range_id","range_id","ranges_list","range_diagnostics","defaultSeverity","filterDiagnostics","ignoredDiagnosticsCodes","ignoredMessagesRegExp","diagnostics_list","markers_to_retain","diagnostics_by_range","last_line_number","start_in_editor","end_in_editor","range_in_editor","diagnostic_hash","highestSeverityCode","classNames","d","marker","removeUnusedDiagnosticMarkers","to_retain","diagnostics_feature","panel_widget","ref","widget_id","mode","activateById","DIAGNOSTICS_PLUGIN","publishDiagnostics","highlightIcon","highlight","highlightTypeIcon","getReferences","isReferencesSupported","getTypeDefinition","isTypeDefinitionSupported","HighlightsCM","highlight_markers","last_token","onBlur","removeOnBlur","clear_markers","onCursorActivity","handleHighlight","kind_class","on_cursor_activity","sent_version","getDocumentHighlights","debounced_get_highlight","invoke","highlights","version_after","create_debouncer","Debouncer","debouncerDelay","HIGHLIGHTS_PLUGIN","MIN_HEIGHT","MAX_HEIGHT","CLASS_NAME","FreeTooltip","Tooltip","_setGeometry","MimeModel","bundle","handleEvent","isHidden","keyCode","hideOnKeyPress","getOffsetAt","alignment","tokens","last","getCoordinateForPosition","style","getComputedStyle","parseInt","HoverBox","maxHeight","minHeight","horizontal","privilege","EditorTooltipManager","rendermime_registry","currentTooltip","currentOptions","markup","rendermime","Widget","isShown","hoverIcon","hover","isCloseTo","what","who","cushion","relatedTarget","whatRect","y","bottom","ResponseCache","maxSize","_data","store","previousIndex","editor_range","shift","clean","to_markup","HoverCM","last_hover_character","hover_marker","_previousHoverRequest","onKeyDown","response_data","restore_from_cache","handleResponse","onMouseLeave","remove_range_highlight","maybeHideTooltip","on_hover","serverCapabilities","hoverProvider","clientRequests","show_tooltip","last_hover_response","get_markup_for_hover","root_position_to_editor","updateUnderlineAndTooltip","_updateUnderlineAndTooltip","matching_items","cache","cache_item","cacheSize","keep_tooltip","instance","debounced_get_hover","create_throttler","mouseEvent","Throttler","limit","throttlerDelay","edge","markups","is_token_empty","is_event_inside_visible","closest","is_useful_response","getTokenAt","get_editor_range","add_range_if_needed","cm_to_lsp","HoverLabIntegration","HOVER_PLUGIN","contentFormat","renameIcon","rename","rename_feature","setTrans","handle_failure","RenameCM","ux_workaround_for_rope_limitation","setStatus","dialog_value","InputDialog","okLabel","cancelLabel","handleRename","outcome","apply_edit","change_text","has_index_error","dire_python_errors","dire_errors","editor_id","RENAME_PLUGIN","TOOLTIP_ID","getMarkdown","extractLead","leadLines","splitOnParagraph","isEmpty","leadCandidate","search","lead","remainder","signatureToMarkdown","codeHighlighter","activeParameterFallback","maxLinesBeforeCollapse","activeParameter","markdown","parameter","details","plainTextDocumentation","SignatureCM","closeCharacters","virtualEditor","isSignatureShown","_hideTooltip","newRootPosition","previousPosition","newEditorPosition","requestSignature","get_markup_for_signature_help","signatures","activeSignature","highlightCode","variable","pre","codeMirror","CodeMirror","runMode","createTextNode","mark","outerHTML","maxLines","handleSignature","position_at_request","display_position","signatureCharacter","find_ce_editor","_signatureCharacters","getLanguageSignatureCharacters","_closeCharacters","signatureCharacters","signatureHelpProvider","help","SignatureLabIntegration","SIGNATURE_PLUGIN","ICodeMirror","signatureHelp","signatureInformation","syntaxHighlightingIcon","CMSyntaxHighlighting","update_mode","editors_with_active_highlight","get_mode","mimeTypeService","getMimeTypeByLanguage","findModeByMIME","editors_with_current_highlight","foreign_document_maps","total_area","covered_area","coverage","foreignCodeThreshold","old_mode","getOption","mime","setOption","SyntaxLabIntegration","SYNTAX_HIGHLIGHTING_PLUGIN","IEditorServices","editorServices","LanguageServerManager","_sessionsChanged","_sessions","_specs","_warningsEmitted","_settings","ServerConnection","_baseUrl","baseUrl","_retries","retries","_retriesInterval","retriesInterval","_statusCode","_configuration","fetchSessions","configuration","warnOnce","_comparePriorities","DEFAULT_PRIORITY","a_priority","b_priority","isMatchingSpec","lowerCaseLanguage","matchingSessionsKeys","statusUrl","method","ok","json","oldKeys","oldKey","oldId","CodeOverridesManager","_overrides","CODE_OVERRIDES_MANAGER","python","empty_or_escaped","LINE_MAGIC_PREFIX","PYTHON_IDENTIFIER","marks","line_break","entire","IPYTHON_TRANSCLUSIONS","extractors_manager","overrides_manager","SQL_URL_PATTERN","single_argument_options","zero_argument_options","COMMAND_PATTERN","IPYTHON_BIGQUERY_TRANSCLUSIONS","RPY2_MAX_ARGS","extract_r_args","content_position","inputs","outputs","others","rest","parse_r_args","input_variables","output_variables","rpy2_reverse_pattern","quote","multi_line","magic","rpy2_reverse_replacement","other_args","input","output","rpy2_args_pattern","max_n","create_rpy_code_extractor","strip_leading_space","rpy2_code_extractor","r","rpy2_code_extractor_non_stripping","rpy2_args","IPYTHON_RPY2_TRANSCLUSIONS","IPYTHON_SQL_TRANSCLUSIONS","DEFAULT_TRANSCLUSIONS","DocDispatcher","to","notebook_map","transform_from_root_to_editor","active_editor","CodeMirrorVirtualEditor","_event_wrappers","block_added_handlers","block_removed_handlers","editor_to_source_line","cm_editor_to_ce_editor","_proxy","Proxy","prop","receiver","Reflect","onEditorsUpdated","save_block_position","editor_to_source_line_new","set_event_handlers","emit_change","eventName","wrapped_handler","forEveryBlockEditor","disconnectBlockMonitoring","code_extractors","block_data","coordinates","get_editor_at_root_line","root_as_source","addKeyMap","addLineClass","where","_class","addLineWidget","addOverlay","addPanel","charCoords","object","bestGuess","outside","cursorCoords","defaultCharWidth","any_editor","defaultTextHeight","endOperation","execCommand","dummy_doc","precise","getTokenTypeAt","codemirror_editor","heightAtLine","includeWidgets","isReadOnly","lineAtHeight","height","monitor_for_new_blocks","on_editor_removed_callback","editors_with_handlers","on_block_added","on_block_removed","CODEMIRROR_VIRTUAL_EDITOR","editorManager","registerEditorType","supports","VirtualEditorManager","editorTypes","VIRTUAL_EDITOR_MANAGER","IPaths","JupyterFrontEnd","FeatureManager","command_managers","command_manager_registered","_register","supersedes","option","command_manager","registerCommandManager","LSPExtension","paths","code_extractors_manager","code_overrides_manager","status_bar","statusButtonExtension","registerStatusItem","isActive","addWidgetExtension","initial_configuration","language_servers","updateOptions","reason","command_manger","languageServerSettings","ICommandPalette","ILoggerRegistry","IStatusBar","default_features","COMPLETION_THEME_MANAGER","RE_PATH_ANCHOR","sleep","until_ready","max_retrials","interval_modifier","getModifierState","shiftKey","altKey","ctrlKey","metaKey","DefaultMap","default_factory","v","server_root_uri","uris_equal","win_paths","is_win_path","normalize_win_path","decodeURI","it","uri_to_contents_path","child","expandPath","obj","curr","expandDottedPaths","parsed","escapeMarkdown","span","COMPLETER_THEME_PREFIX","KernelKind","ILSPCompletionThemeManager","___CSS_LOADER_EXPORT___","module"],"mappings":"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","file":"1597.19f6e75c5b973b73cfe7.js?v=19f6e75c5b973b73cfe7","sourcesContent":["import { Token } from '@lumino/coreutils';\nexport var ILanguageServerManager;\n(function (ILanguageServerManager) {\n    ILanguageServerManager.URL_NS = 'lsp';\n})(ILanguageServerManager || (ILanguageServerManager = {}));\nexport const PLUGIN_ID = '@krassowski/jupyterlab-lsp';\nexport const ILSPFeatureManager = new Token(PLUGIN_ID + ':ILSPFeatureManager');\nexport const ILSPAdapterManager = new Token(PLUGIN_ID + ':ILSPAdapterManager');\nexport const ILSPVirtualEditorManager = new Token(PLUGIN_ID + ':ILSPVirtualEditorManager');\nexport const ILSPCodeExtractorsManager = new Token(PLUGIN_ID + ':ILSPCodeExtractorsManager');\nexport const ILSPLogConsole = new Token(PLUGIN_ID + ':ILSPLogConsole');\n//# sourceMappingURL=tokens.js.map","export function is_equal(self, other) {\n    return other && self.line === other.line && self.ch === other.ch;\n}\n// TODO: needs heavy unit testing\nexport function position_at_offset(offset, lines) {\n    let line = 0;\n    let column = 0;\n    for (let text_line of lines) {\n        // each line has a new line symbol which is accounted for in offset!\n        if (text_line.length + 1 <= offset) {\n            offset -= text_line.length + 1;\n            line += 1;\n        }\n        else {\n            column = offset;\n            break;\n        }\n    }\n    return { line, column };\n}\nexport function offset_at_position(position, lines, lines_include_breaks = false) {\n    let break_increment = lines_include_breaks ? 0 : 1;\n    let offset = 0;\n    for (let i = 0; i < lines.length; i++) {\n        let text_line = lines[i];\n        if (position.line > i) {\n            offset += text_line.length + break_increment;\n        }\n        else {\n            offset += position.column;\n            break;\n        }\n    }\n    return offset;\n}\nexport class PositionError extends Error {\n}\n//# sourceMappingURL=positioning.js.map","import { position_at_offset } from '../positioning';\nexport function getIndexOfCaptureGroup(expression, matched_string, value_of_captured_group) {\n    // TODO: use https://github.com/tc39/proposal-regexp-match-indices once supported in >95% of browsers\n    //  (probably around 2025)\n    // get index of the part that is being extracted to foreign document\n    let captured_groups = expression.exec(matched_string);\n    if (captured_groups == null) {\n        console.warn(`No capture group found for ${expression} in ${matched_string}`);\n        return -1;\n    }\n    let offset_in_match = 0;\n    // first element is a full match\n    let full_matched = captured_groups[0];\n    for (let group of captured_groups.slice(1)) {\n        if (typeof group === 'undefined') {\n            continue;\n        }\n        if (group === value_of_captured_group) {\n            offset_in_match += full_matched.indexOf(group);\n            break;\n        }\n        let group_end_offset = full_matched.indexOf(group) + group.length;\n        full_matched = full_matched.slice(group_end_offset);\n        offset_in_match += group_end_offset;\n    }\n    return offset_in_match;\n}\nexport class RegExpForeignCodeExtractor {\n    constructor(options) {\n        this.language = options.language;\n        this.options = options;\n        this.global_expression = new RegExp(options.pattern, 'g');\n        this.test_expression = new RegExp(options.pattern, 'g');\n        this.expression = new RegExp(options.pattern);\n        this.standalone = this.options.is_standalone;\n        this.file_extension = this.options.file_extension;\n    }\n    has_foreign_code(code) {\n        let result = this.test_expression.test(code);\n        this.test_expression.lastIndex = 0;\n        return result;\n    }\n    extract_foreign_code(code) {\n        let lines = code.split('\\n');\n        let extracts = new Array();\n        let started_from = this.global_expression.lastIndex;\n        let match = this.global_expression.exec(code);\n        let host_code_fragment;\n        let chosen_replacer;\n        let is_new_api_replacer = false;\n        if (typeof this.options.foreign_replacer !== 'undefined') {\n            chosen_replacer = this.options.foreign_replacer;\n            is_new_api_replacer = true;\n        }\n        else if (typeof this.options.foreign_capture_groups !== 'undefined') {\n            chosen_replacer = '$' + this.options.foreign_capture_groups.join('$');\n            is_new_api_replacer = true;\n        }\n        else if (this.options.extract_to_foreign) {\n            chosen_replacer = this.options.extract_to_foreign;\n        }\n        else {\n            console.warn(`Foreign replacer not defined for extractor: {this.expression} - this is deprecated; use 'foreign_replacer' to define it`);\n            return [];\n        }\n        while (match != null) {\n            let matched_string = match[0];\n            let position_shift = null;\n            let foreign_code_fragment = matched_string.replace(this.expression, \n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            chosen_replacer);\n            let prefix = '';\n            if (typeof this.options.extract_arguments !== 'undefined') {\n                prefix = matched_string.replace(this.expression, \n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                this.options.extract_arguments);\n                position_shift = position_at_offset(prefix.length, prefix.split('\\n'));\n            }\n            // NOTE:\n            // match.index + matched_string.length === this.sticky_expression.lastIndex\n            let end_index = this.global_expression.lastIndex;\n            if (this.options.keep_in_host || this.options.keep_in_host == null) {\n                host_code_fragment = code.substring(started_from, end_index);\n            }\n            else {\n                if (started_from === match.index) {\n                    host_code_fragment = '';\n                }\n                else {\n                    host_code_fragment = code.substring(started_from, match.index) + '\\n';\n                }\n            }\n            let foreign_code_group_value = foreign_code_fragment;\n            if (is_new_api_replacer) {\n                foreign_code_group_value = matched_string.replace(this.expression, '$' + Math.min(...this.options.foreign_capture_groups));\n            }\n            const foreign_group_index_in_match = getIndexOfCaptureGroup(this.expression, matched_string, foreign_code_group_value);\n            let start_offset = match.index + foreign_group_index_in_match;\n            let start = position_at_offset(start_offset, lines);\n            let end = position_at_offset(start_offset + foreign_code_fragment.length, lines);\n            extracts.push({\n                host_code: host_code_fragment,\n                foreign_code: prefix + foreign_code_fragment,\n                range: { start, end },\n                virtual_shift: position_shift\n            });\n            started_from = this.global_expression.lastIndex;\n            match = this.global_expression.exec(code);\n        }\n        if (started_from !== code.length) {\n            let final_host_code_fragment = code.substring(started_from, code.length);\n            extracts.push({\n                host_code: final_host_code_fragment,\n                foreign_code: null,\n                range: null,\n                virtual_shift: null\n            });\n        }\n        return extracts;\n    }\n}\n//# sourceMappingURL=regexp.js.map","import { Token } from '@lumino/coreutils';\nimport { PLUGIN_ID } from '../tokens';\nexport const ILSPCodeOverridesManager = new Token(PLUGIN_ID + ':ILSPCodeOverridesManager');\n//# sourceMappingURL=tokens.js.map","import api from \"!../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../css-loader/dist/cjs.js!./index.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import { Signal } from '@lumino/signaling';\nimport { ILSPAdapterManager, PLUGIN_ID } from './tokens';\nexport class WidgetAdapterManager {\n    constructor(shell) {\n        this.shell = shell;\n        this.adapters = new Map();\n        this.adapterChanged = new Signal(this);\n        this.adapterDisposed = new Signal(this);\n        this.adapterTypeAdded = new Signal(this);\n        this.adapterTypes = [];\n        shell.currentChanged.connect(this.refreshAdapterFromCurrentWidget, this);\n    }\n    get types() {\n        return this.adapterTypes;\n    }\n    registerAdapterType(options) {\n        this.adapterTypes.push(options);\n        this.adapterTypeAdded.emit(options);\n    }\n    connect(extension, type) {\n        type.tracker.widgetAdded.connect((tracker, widget) => {\n            this.connectWidget(extension, widget, type);\n        });\n        extension.registerAdapterType(this, type);\n    }\n    registerExtension(extension) {\n        for (let type of this.adapterTypes) {\n            this.connect(extension, type);\n        }\n        this.adapterTypeAdded.connect((manager, type) => {\n            this.connect(extension, type);\n        });\n    }\n    connectWidget(extension, widget, type) {\n        let adapter = new type.adapter(extension, widget);\n        this.registerAdapter({\n            adapter: adapter,\n            id: type.get_id(widget),\n            re_connector: () => {\n                this.connectWidget(extension, widget, type);\n            }\n        });\n        // possibly update the value of currentAdapter using the current widget\n        this.refreshAdapterFromCurrentWidget();\n    }\n    refreshAdapterFromCurrentWidget() {\n        const current = this.shell.currentWidget;\n        if (!current) {\n            return;\n        }\n        let adapter = null;\n        for (let type of this.adapterTypes) {\n            if (type.tracker.has(current)) {\n                let id = type.get_id(current);\n                adapter = this.adapters.get(id);\n            }\n        }\n        if (adapter != null) {\n            this.currentAdapter = adapter;\n            this.adapterChanged.emit(adapter);\n        }\n    }\n    registerAdapter(options) {\n        let { id, adapter, re_connector } = options;\n        let widget = options.adapter.widget;\n        if (this.adapters.has(id)) {\n            let old = this.adapters.get(id);\n            console.warn(`Adapter with id ${id} was already registered (${adapter} vs ${old}) `);\n        }\n        this.adapters.set(id, adapter);\n        const disconnect = () => {\n            this.adapters.delete(id);\n            widget.disposed.disconnect(disconnect);\n            widget.context.pathChanged.disconnect(reconnect);\n            adapter.dispose();\n        };\n        const reconnect = () => {\n            disconnect();\n            re_connector();\n        };\n        widget.disposed.connect(() => {\n            disconnect();\n            this.adapterDisposed.emit(adapter);\n        });\n        widget.context.pathChanged.connect(reconnect);\n        // TODO: maybe emit adapterCreated. Should it be handled by statusbar?\n        this.refreshAdapterFromCurrentWidget();\n    }\n    isAnyActive() {\n        return (this.shell.currentWidget !== null &&\n            this.adapterTypes.some(type => type.tracker.currentWidget) &&\n            this.adapterTypes.some(type => type.tracker.currentWidget == this.shell.currentWidget));\n    }\n}\nexport const WIDGET_ADAPTER_MANAGER = {\n    id: PLUGIN_ID + ':ILSPAdapterManager',\n    activate: app => {\n        let shell = app.shell;\n        return new WidgetAdapterManager(shell);\n    },\n    provides: ILSPAdapterManager,\n    autoStart: true\n};\n//# sourceMappingURL=adapter_manager.js.map","export class PositionConverter {\n    static lsp_to_cm(position) {\n        return { line: position.line, ch: position.character };\n    }\n    static cm_to_lsp(position) {\n        return { line: position.line, character: position.ch };\n    }\n    static lsp_to_ce(position) {\n        return { line: position.line, column: position.character };\n    }\n    static cm_to_ce(position) {\n        return { line: position.line, column: position.ch };\n    }\n    static ce_to_cm(position) {\n        return { line: position.line, ch: position.column };\n    }\n}\n//# sourceMappingURL=converter.js.map","import { PageConfig, URLExt } from '@jupyterlab/coreutils';\nimport { Signal } from '@lumino/signaling';\nimport { ILanguageServerManager } from './tokens';\nimport { expandDottedPaths, sleep, until_ready } from './utils';\n/**\n * Each Widget with a document (whether file or a notebook) has the same DocumentConnectionManager\n * (see JupyterLabWidgetAdapter). Using id_path instead of uri led to documents being overwritten\n * as two identical id_paths could be created for two different notebooks.\n */\nexport class DocumentConnectionManager {\n    constructor(options) {\n        /**\n         * Fired the first time a connection is opened. These _should_ be the only\n         * invocation of `.on` (once remaining LSPFeature.connection_handlers are made\n         * singletons).\n         */\n        this.on_new_connection = (connection) => {\n            connection.on('error', e => {\n                this.console.warn(e);\n                // TODO invalid now\n                let error = e.length && e.length >= 1 ? e[0] : new Error();\n                // TODO: those codes may be specific to my proxy client, need to investigate\n                if (error.message.indexOf('code = 1005') !== -1) {\n                    this.console.warn(`Connection failed for ${connection}`);\n                    this.forEachDocumentOfConnection(connection, virtual_document => {\n                        this.console.warn('disconnecting ' + virtual_document.uri);\n                        this.closed.emit({ connection, virtual_document });\n                        this.ignored_languages.add(virtual_document.language);\n                        this.console.warn(`Cancelling further attempts to connect ${virtual_document.uri} and other documents for this language (no support from the server)`);\n                    });\n                }\n                else if (error.message.indexOf('code = 1006') !== -1) {\n                    this.console.warn('Connection closed by the server');\n                }\n                else {\n                    this.console.error('Connection error:', e);\n                }\n            });\n            connection.on('serverInitialized', capabilities => {\n                this.forEachDocumentOfConnection(connection, virtual_document => {\n                    // TODO: is this still necessary, e.g. for status bar to update responsively?\n                    this.initialized.emit({ connection, virtual_document });\n                });\n                // Initialize using settings stored in the SettingRegistry\n                this.updateServerConfigurations(this.initial_configurations);\n            });\n            connection.on('close', closed_manually => {\n                if (!closed_manually) {\n                    this.console.warn('Connection unexpectedly disconnected');\n                }\n                else {\n                    this.console.warn('Connection closed');\n                    this.forEachDocumentOfConnection(connection, virtual_document => {\n                        this.closed.emit({ connection, virtual_document });\n                    });\n                }\n            });\n        };\n        this.connections = new Map();\n        this.documents = new Map();\n        this.ignored_languages = new Set();\n        this.connected = new Signal(this);\n        this.initialized = new Signal(this);\n        this.disconnected = new Signal(this);\n        this.closed = new Signal(this);\n        this.documents_changed = new Signal(this);\n        this.language_server_manager = options.language_server_manager;\n        this.console = options.console;\n        Private.setLanguageServerManager(options.language_server_manager);\n    }\n    connect_document_signals(virtual_document) {\n        virtual_document.foreign_document_opened.connect(this.on_foreign_document_opened, this);\n        virtual_document.foreign_document_closed.connect(this.on_foreign_document_closed, this);\n        this.documents.set(virtual_document.uri, virtual_document);\n        this.documents_changed.emit(this.documents);\n    }\n    disconnect_document_signals(virtual_document, emit = true) {\n        virtual_document.foreign_document_opened.disconnect(this.on_foreign_document_opened, this);\n        virtual_document.foreign_document_closed.disconnect(this.on_foreign_document_closed, this);\n        this.documents.delete(virtual_document.uri);\n        for (const foreign of virtual_document.foreign_documents.values()) {\n            this.disconnect_document_signals(foreign, false);\n        }\n        if (emit) {\n            this.documents_changed.emit(this.documents);\n        }\n    }\n    on_foreign_document_opened(_host, context) {\n        this.console.log('ConnectionManager received foreign document: ', context.foreign_document.uri);\n    }\n    on_foreign_document_closed(_host, context) {\n        const { foreign_document } = context;\n        this.disconnect_document_signals(foreign_document);\n    }\n    async connect_socket(options) {\n        this.console.log('Connection Socket', options);\n        let { virtual_document, language, capabilities } = options;\n        this.connect_document_signals(virtual_document);\n        const uris = DocumentConnectionManager.solve_uris(virtual_document, language);\n        const matchingServers = this.language_server_manager.getMatchingServers({\n            language\n        });\n        this.console.debug('Matching servers: ', matchingServers);\n        // for now use only the server with the highest priority.\n        const language_server_id = matchingServers.length === 0 ? null : matchingServers[0];\n        // lazily load 1) the underlying library (1.5mb) and/or 2) a live WebSocket-\n        // like connection: either already connected or potentially in the process\n        // of connecting.\n        const connection = await Private.connection(language, language_server_id, uris, this.on_new_connection, this.console, capabilities);\n        // if connecting for the first time, all documents subsequent documents will\n        // be re-opened and synced\n        this.connections.set(virtual_document.uri, connection);\n        return connection;\n    }\n    /**\n     * Handles the settings that do not require an existing connection\n     * with a language server (or can influence to which server the\n     * connection will be created, e.g. `priority`).\n     *\n     * This function should be called **before** initialization of servers.\n     */\n    updateConfiguration(allServerSettings) {\n        this.language_server_manager.setConfiguration(allServerSettings);\n    }\n    /**\n     * Handles the settings that the language servers accept using\n     * `onDidChangeConfiguration` messages, which should be passed under\n     * the \"serverSettings\" keyword in the setting registry.\n     * Other configuration options are handled by `updateConfiguration` instead.\n     *\n     * This function should be called **after** initialization of servers.\n     */\n    updateServerConfigurations(allServerSettings) {\n        let language_server_id;\n        for (language_server_id in allServerSettings) {\n            if (!allServerSettings.hasOwnProperty(language_server_id)) {\n                continue;\n            }\n            const rawSettings = allServerSettings[language_server_id];\n            const parsedSettings = expandDottedPaths(rawSettings.serverSettings || {});\n            const serverSettings = {\n                settings: parsedSettings\n            };\n            this.console.log('Server Update: ', language_server_id);\n            this.console.log('Sending settings: ', serverSettings);\n            Private.updateServerConfiguration(language_server_id, serverSettings);\n        }\n    }\n    forEachDocumentOfConnection(connection, callback) {\n        for (const [virtual_document_uri, a_connection] of this.connections.entries()) {\n            if (connection !== a_connection) {\n                continue;\n            }\n            callback(this.documents.get(virtual_document_uri));\n        }\n    }\n    /**\n     * TODO: presently no longer referenced. A failing connection would close\n     * the socket, triggering the language server on the other end to exit\n     */\n    async retry_to_connect(options, reconnect_delay, retrials_left = -1) {\n        let { virtual_document } = options;\n        if (this.ignored_languages.has(virtual_document.language)) {\n            return;\n        }\n        let interval = reconnect_delay * 1000;\n        let success = false;\n        while (retrials_left !== 0 && !success) {\n            await this.connect(options)\n                .then(() => {\n                success = true;\n            })\n                .catch(e => {\n                this.console.warn(e);\n            });\n            this.console.log('will attempt to re-connect in ' + interval / 1000 + ' seconds');\n            await sleep(interval);\n            // gradually increase the time delay, up to 5 sec\n            interval = interval < 5 * 1000 ? interval + 500 : interval;\n        }\n    }\n    async connect(options, firstTimeoutSeconds = 30, secondTimeoutMinutes = 5) {\n        this.console.log('connection requested', options);\n        let connection = await this.connect_socket(options);\n        let { virtual_document, document_path } = options;\n        if (!connection.isReady) {\n            try {\n                // user feedback hinted that 40 seconds was too short and some users are willing to wait more;\n                // to make the best of both worlds we first check frequently (6.6 times a second) for the first\n                // 30 seconds, and show the warning early in case if something is wrong; we then continue retrying\n                // for another 5 minutes, but only once per second.\n                await until_ready(() => connection.isReady, Math.round((firstTimeoutSeconds * 1000) / 150), 150);\n            }\n            catch (_a) {\n                this.console.warn(`Connection to ${virtual_document.uri} timed out after ${firstTimeoutSeconds} seconds, will continue retrying for another ${secondTimeoutMinutes} minutes`);\n                try {\n                    await until_ready(() => connection.isReady, 60 * secondTimeoutMinutes, 1000);\n                }\n                catch (_b) {\n                    this.console.warn(`Connection to ${virtual_document.uri} timed out again after ${secondTimeoutMinutes} minutes, giving up`);\n                    return;\n                }\n            }\n        }\n        this.console.log(document_path, virtual_document.uri, 'connected.');\n        this.connected.emit({ connection, virtual_document });\n        return connection;\n    }\n    unregister_document(virtual_document) {\n        this.connections.delete(virtual_document.uri);\n        this.documents_changed.emit(this.documents);\n    }\n    updateLogging(logAllCommunication, setTrace) {\n        for (const connection of this.connections.values()) {\n            connection.logAllCommunication = logAllCommunication;\n            if (setTrace !== null) {\n                connection.clientNotifications['$/setTrace'].emit({ value: setTrace });\n            }\n        }\n    }\n}\n(function (DocumentConnectionManager) {\n    function solve_uris(virtual_document, language) {\n        const wsBase = PageConfig.getBaseUrl().replace(/^http/, 'ws');\n        const rootUri = PageConfig.getOption('rootUri');\n        const virtualDocumentsUri = PageConfig.getOption('virtualDocumentsUri');\n        const baseUri = virtual_document.has_lsp_supported_file\n            ? rootUri\n            : virtualDocumentsUri;\n        // for now take the best match only\n        const matchingServers = Private.getLanguageServerManager().getMatchingServers({\n            language\n        });\n        const language_server_id = matchingServers.length === 0 ? null : matchingServers[0];\n        if (language_server_id === null) {\n            throw `No language server installed for language ${language}`;\n        }\n        // workaround url-parse bug(s) (see https://github.com/jupyter-lsp/jupyterlab-lsp/issues/595)\n        let documentUri = URLExt.join(baseUri, virtual_document.uri);\n        if (!documentUri.startsWith('file:///') &&\n            documentUri.startsWith('file://')) {\n            documentUri = documentUri.replace('file://', 'file:///');\n            if (documentUri.startsWith('file:///users/') &&\n                baseUri.startsWith('file:///Users/')) {\n                documentUri = documentUri.replace('file:///users/', 'file:///Users/');\n            }\n        }\n        return {\n            base: baseUri,\n            document: documentUri,\n            server: URLExt.join('ws://jupyter-lsp', language),\n            socket: URLExt.join(wsBase, ILanguageServerManager.URL_NS, 'ws', language_server_id)\n        };\n    }\n    DocumentConnectionManager.solve_uris = solve_uris;\n})(DocumentConnectionManager || (DocumentConnectionManager = {}));\n/**\n * Namespace primarily for language-keyed cache of ConnectionModuleType.LSPConnections\n */\nvar Private;\n(function (Private) {\n    const _connections = new Map();\n    let _promise;\n    let _language_server_manager;\n    function getLanguageServerManager() {\n        return _language_server_manager;\n    }\n    Private.getLanguageServerManager = getLanguageServerManager;\n    function setLanguageServerManager(language_server_manager) {\n        _language_server_manager = language_server_manager;\n    }\n    Private.setLanguageServerManager = setLanguageServerManager;\n    /**\n     * Return (or create and initialize) the WebSocket associated with the language\n     */\n    async function connection(language, language_server_id, uris, onCreate, console, capabilities) {\n        if (_promise == null) {\n            // TODO: consider lazy-loading _only_ the modules that _must_ be webpacked\n            // with custom shims, e.g. `fs`\n            _promise = import(\n            /* webpackChunkName: \"jupyter-lsp-connection\" */ './connection');\n        }\n        const { LSPConnection } = await _promise;\n        let connection = _connections.get(language_server_id);\n        if (connection == null) {\n            const socket = new WebSocket(uris.socket);\n            const connection = new LSPConnection({\n                languageId: language,\n                serverUri: uris.server,\n                rootUri: uris.base,\n                serverIdentifier: language_server_id,\n                console: console,\n                capabilities: capabilities\n            });\n            // TODO: remove remaining unbounded users of connection.on\n            connection.setMaxListeners(999);\n            _connections.set(language_server_id, connection);\n            connection.connect(socket);\n            onCreate(connection);\n        }\n        connection = _connections.get(language_server_id);\n        return connection;\n    }\n    Private.connection = connection;\n    function updateServerConfiguration(language_server_id, settings) {\n        const connection = _connections.get(language_server_id);\n        if (connection) {\n            connection.sendConfigurationChange(settings);\n        }\n    }\n    Private.updateServerConfiguration = updateServerConfiguration;\n})(Private || (Private = {}));\n//# sourceMappingURL=connection_manager.js.map","class OverridesMap extends Map {\n    constructor(magic_overrides) {\n        super(magic_overrides.map(m => [new RegExp(m.pattern), m.replacement]));\n    }\n    _override_for(code) {\n        for (let [key, value] of this) {\n            if (code.match(key)) {\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                return code.replace(key, value);\n            }\n        }\n        return null;\n    }\n}\nexport class ReversibleOverridesMap extends OverridesMap {\n    constructor(magic_overrides) {\n        super(magic_overrides);\n        this.overrides = magic_overrides;\n    }\n    get reverse() {\n        return this.type(this.overrides\n            .filter(override => override.reverse != null)\n            .map(override => override.reverse));\n    }\n    type(overrides) {\n        return new ReversibleOverridesMap(overrides);\n    }\n    override_for(cell) {\n        return super._override_for(cell);\n    }\n    replace_all(raw_lines, map = this) {\n        let substituted_lines = new Array();\n        let skip_inspect = new Array();\n        for (let i = 0; i < raw_lines.length; i++) {\n            let line = raw_lines[i];\n            let override = map.override_for(line);\n            substituted_lines.push(override == null ? line : override);\n            skip_inspect.push(override != null);\n        }\n        return {\n            lines: substituted_lines,\n            skip_inspect: skip_inspect\n        };\n    }\n    reverse_replace_all(raw_lines) {\n        return this.replace_all(raw_lines, this.reverse).lines;\n    }\n}\n//# sourceMappingURL=maps.js.map","import api from \"!../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../css-loader/dist/cjs.js!./console.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import '../../style/console.css';\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { Signal } from '@lumino/signaling';\nimport { ILSPLogConsole, PLUGIN_ID } from '../tokens';\nfunction to_string(args) {\n    return args\n        .map(arg => {\n        let textual;\n        if (typeof arg === 'string') {\n            return arg;\n        }\n        try {\n            textual = JSON.stringify({ k: arg }).slice(5, -1);\n        }\n        catch (_a) {\n            textual = '' + arg;\n        }\n        return '<span class=\"lsp-code\">' + textual + '</span>';\n    })\n        .join(' ');\n}\nclass FloatingConsole {\n    constructor(scope = ['LSP'], element = null) {\n        if (element) {\n            this.element = element;\n        }\n        else {\n            this.element = document.createElement('ul');\n            this.element.className = 'lsp-floating-console';\n            document.body.appendChild(this.element);\n        }\n    }\n    bindThis() {\n        return this;\n    }\n    dispose() {\n        this.element.remove();\n    }\n    append(text, kind = 'log') {\n        let entry = document.createElement('li');\n        entry.innerHTML = '<span class=\"lsp-kind\">' + kind + '</span>' + text;\n        this.element.appendChild(entry);\n        this.element.scrollTop = this.element.scrollHeight;\n    }\n    debug(...args) {\n        this.append(to_string(args), 'debug');\n    }\n    log(...args) {\n        this.append(to_string(args), 'log');\n    }\n    warn(...args) {\n        this.append(to_string(args), 'warn');\n    }\n    error(...args) {\n        this.append(to_string(args), 'error');\n    }\n}\n/**\n * Used both as a console implementation, and as a dummy ILSPLogConsole\n */\nexport class BrowserConsole {\n    constructor() {\n        this.debug = window.console.debug.bind(window.console);\n        this.log = window.console.log.bind(window.console);\n        this.warn = window.console.warn.bind(window.console);\n        this.error = window.console.error.bind(window.console);\n    }\n    dispose() {\n        return;\n    }\n    scope(scope) {\n        return this;\n    }\n    bindThis() {\n        return window.console;\n    }\n}\nclass ConsoleWrapper {\n    constructor(scope = ['LSP'], singleton) {\n        this.breadcrumbs = scope;\n        this._scope = this.breadcrumbs.join('.') + ':';\n        this.singleton = singleton;\n        this.singleton.changed.connect(this._rebind_functions.bind(this));\n        this._rebind_functions();\n    }\n    /**\n     * Re-binding directly to the underlying functions allows to get nice\n     * location (file:line) of the actual call rather than of this wrapper\n     * when using with the browser implementation.\n     */\n    _rebind_functions() {\n        const no_op = () => {\n            // do nothing\n        };\n        const bind_arg = this.implementation.bindThis();\n        if (this.verbosity === 'debug') {\n            this.debug = this.implementation.debug.bind(bind_arg, this._scope);\n        }\n        else {\n            this.debug = no_op;\n        }\n        if (this.verbosity === 'debug' || this.verbosity === 'log') {\n            this.log = this.implementation.log.bind(bind_arg, this._scope);\n        }\n        else {\n            this.log = no_op;\n        }\n        if (this.verbosity === 'debug' ||\n            this.verbosity === 'log' ||\n            this.verbosity === 'warn') {\n            this.warn = this.implementation.warn.bind(bind_arg, this._scope);\n        }\n        else {\n            this.warn = no_op;\n        }\n        this.error = this.implementation.error.bind(bind_arg, this._scope);\n    }\n    get verbosity() {\n        return this.singleton.verbosity;\n    }\n    get implementation() {\n        return this.singleton.implementation;\n    }\n    debug(...args) {\n        return this.implementation.debug(this._scope, ...args);\n    }\n    log(...args) {\n        return this.implementation.log(this._scope, ...args);\n    }\n    warn(...args) {\n        return this.implementation.warn(this._scope, ...args);\n    }\n    error(...args) {\n        return this.implementation.error(this._scope, ...args);\n    }\n    scope(scope) {\n        return new ConsoleWrapper([...this.breadcrumbs, scope], this.singleton);\n    }\n}\nclass ConsoleSingleton {\n    constructor(setting_registry) {\n        // until loaded log everything, to browser console\n        this.verbosity = 'debug';\n        this.implementation = new BrowserConsole();\n        this.changed = new Signal(this);\n        setting_registry\n            .load(PLUGIN_ID + ':plugin')\n            .then(settings => {\n            this.updateSettings(settings);\n            settings.changed.connect(() => {\n                this.updateSettings(settings);\n            });\n        })\n            .catch(console.warn);\n    }\n    updateSettings(settings) {\n        const composite = settings.composite;\n        const kind = composite.loggingConsole;\n        if (this.implementation) {\n            this.implementation.dispose();\n        }\n        if (kind === 'browser') {\n            this.implementation = new BrowserConsole();\n        }\n        else if (kind === 'floating') {\n            this.implementation = new FloatingConsole();\n        }\n        else {\n            console.warn('Unknown console type', kind, 'falling back to browser console');\n            this.implementation = new BrowserConsole();\n        }\n        this.verbosity = composite.loggingLevel;\n        this.changed.emit();\n    }\n}\nexport const LOG_CONSOLE = {\n    id: PLUGIN_ID + ':ILSPLogConsole',\n    requires: [ISettingRegistry],\n    activate: (app, setting_registry) => {\n        const singleton = new ConsoleSingleton(setting_registry);\n        return new ConsoleWrapper(['LSP'], singleton);\n    },\n    provides: ILSPLogConsole,\n    autoStart: true\n};\n//# sourceMappingURL=console.js.map","import { Signal } from '@lumino/signaling';\nimport { DocumentConnectionManager } from '../connection_manager';\nimport { ReversibleOverridesMap } from '../overrides/maps';\nimport { PositionError } from '../positioning';\nimport { DefaultMap, until_ready } from '../utils';\nimport { BrowserConsole } from './console';\n/**\n * Check if given position is within range.\n * Both start and end are inclusive.\n * @param position\n * @param range\n */\nexport function is_within_range(position, range) {\n    if (range.start.line === range.end.line) {\n        return (position.line === range.start.line &&\n            position.column >= range.start.column &&\n            position.column <= range.end.column);\n    }\n    return ((position.line === range.start.line &&\n        position.column >= range.start.column &&\n        position.line < range.end.line) ||\n        (position.line > range.start.line &&\n            position.column <= range.end.column &&\n            position.line === range.end.line) ||\n        (position.line > range.start.line && position.line < range.end.line));\n}\n/**\n * a virtual implementation of IDocumentInfo\n */\nexport class VirtualDocumentInfo {\n    constructor(document) {\n        this.version = 0;\n        this._document = document;\n    }\n    get text() {\n        return this._document.value;\n    }\n    get uri() {\n        const uris = DocumentConnectionManager.solve_uris(this._document, this.languageId);\n        return uris.document;\n    }\n    get languageId() {\n        return this._document.language;\n    }\n}\n/**\n * A notebook can hold one or more virtual documents; there is always one,\n * \"root\" document, corresponding to the language of the kernel. All other\n * virtual documents are extracted out of the notebook, based on magics,\n * or other syntax constructs, depending on the kernel language.\n *\n * Virtual documents represent the underlying code in a single language,\n * which has been parsed excluding interactive kernel commands (magics)\n * which could be misunderstood by the specific LSP server.\n *\n * VirtualDocument has no awareness of the notebook or editor it lives in,\n * however it is able to transform its content back to the notebook space,\n * as it keeps editor coordinates for each virtual line.\n *\n * The notebook/editor aware transformations are preferred to be placed in\n * VirtualEditor descendants rather than here.\n *\n * No dependency on editor implementation (such as CodeMirrorEditor)\n * is allowed for VirtualEditor.\n */\nexport class VirtualDocument {\n    constructor(options) {\n        this.isDisposed = false;\n        // TODO: make this configurable, depending on the language used\n        this.blank_lines_between_cells = 2;\n        this.options = options;\n        this.path = options.path;\n        this.console = options.console;\n        this.file_extension = options.file_extension;\n        this.has_lsp_supported_file = options.has_lsp_supported_file;\n        this.parent = options.parent;\n        this.language = options.language;\n        let overrides = this.language in options.overrides_registry\n            ? options.overrides_registry[this.language]\n            : null;\n        this.cell_magics_overrides = new ReversibleOverridesMap(overrides ? overrides.cell : []);\n        this.line_magics_overrides = new ReversibleOverridesMap(overrides ? overrides.line : []);\n        this.foreign_extractors_registry = options.foreign_code_extractors;\n        this.foreign_extractors =\n            this.language in this.foreign_extractors_registry\n                ? this.foreign_extractors_registry[this.language]\n                : [];\n        this.virtual_lines = new Map();\n        this.source_lines = new Map();\n        this.foreign_documents = new Map();\n        this.overrides_registry = options.overrides_registry;\n        this.standalone = options.standalone || false;\n        this.instance_id = VirtualDocument.instances_count;\n        VirtualDocument.instances_count += 1;\n        this.unused_standalone_documents = new DefaultMap(() => new Array());\n        this._remaining_lifetime = 6;\n        this.foreign_document_closed = new Signal(this);\n        this.foreign_document_opened = new Signal(this);\n        this.changed = new Signal(this);\n        this.unused_documents = new Set();\n        this.document_info = new VirtualDocumentInfo(this);\n        this.update_manager = new UpdateManager(this, options.console);\n        this.clear();\n    }\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this.isDisposed = true;\n        this.parent = null;\n        for (const doc of this.foreign_documents.values()) {\n            doc.dispose();\n        }\n        this.close_all_foreign_documents();\n        this.update_manager.dispose();\n        // clear all the maps\n        this.foreign_documents.clear();\n        this.source_lines.clear();\n        this.unused_documents.clear();\n        this.unused_standalone_documents.clear();\n        this.virtual_lines.clear();\n        // just to be sure - if anything is accessed after disposal (it should not) we\n        // will get alterted by errors in the console AND this will limit memory leaks\n        this.cell_magics_overrides = null;\n        this.document_info = null;\n        this.foreign_extractors = null;\n        this.foreign_extractors_registry = null;\n        this.line_magics_overrides = null;\n        this.line_blocks = null;\n        this.overrides_registry = null;\n    }\n    /**\n     * When this counter goes down to 0, the document will be destroyed and the associated connection will be closed;\n     * This is meant to reduce the number of open connections when a a foreign code snippet was removed from the document.\n     *\n     * Note: top level virtual documents are currently immortal (unless killed by other means); it might be worth\n     * implementing culling of unused documents, but if and only if JupyterLab will also implement culling of\n     * idle kernels - otherwise the user experience could be a bit inconsistent, and we would need to invent our own rules.\n     */\n    get remaining_lifetime() {\n        if (!this.parent) {\n            return Infinity;\n        }\n        return this._remaining_lifetime;\n    }\n    set remaining_lifetime(value) {\n        if (this.parent) {\n            this._remaining_lifetime = value;\n        }\n    }\n    clear() {\n        // TODO - deep clear (assure that there is no memory leak)\n        this.unused_standalone_documents.clear();\n        for (let document of this.foreign_documents.values()) {\n            document.clear();\n            if (document.standalone) {\n                // once the standalone document was cleared, we may want to remove it and close connection;\n                // but wait, this is a waste of resources (opening a connection takes 1-3 seconds) and,\n                // since this is cleaned anyway, we could use it for another standalone document of the same language.\n                let set = this.unused_standalone_documents.get(document.language);\n                set.push(document);\n            }\n        }\n        this.unused_documents = new Set(this.foreign_documents.values());\n        this.virtual_lines.clear();\n        this.source_lines.clear();\n        this.last_virtual_line = 0;\n        this.last_source_line = 0;\n        this.line_blocks = [];\n    }\n    forward_closed_signal(host, context) {\n        this.foreign_document_closed.emit(context);\n    }\n    forward_opened_signal(host, context) {\n        this.foreign_document_opened.emit(context);\n    }\n    // TODO: what could be refactored into \"ForeignDocumentsManager\" has started to emerge;\n    //   we should consider refactoring later on.\n    open_foreign(language, standalone, file_extension) {\n        let document = new VirtualDocument(Object.assign(Object.assign({}, this.options), { parent: this, standalone: standalone, file_extension: file_extension, language: language }));\n        const context = {\n            foreign_document: document,\n            parent_host: this\n        };\n        this.foreign_document_opened.emit(context);\n        // pass through any future signals\n        document.foreign_document_closed.connect(this.forward_closed_signal, this);\n        document.foreign_document_opened.connect(this.forward_opened_signal, this);\n        this.foreign_documents.set(document.virtual_id, document);\n        return document;\n    }\n    document_at_source_position(position) {\n        let source_line = this.source_lines.get(position.line);\n        if (source_line == null) {\n            return this;\n        }\n        let source_position_ce = {\n            line: source_line.editor_line,\n            column: position.ch\n        };\n        for (let [range, { virtual_document: document }] of source_line.foreign_documents_map) {\n            if (is_within_range(source_position_ce, range)) {\n                let source_position_cm = {\n                    line: source_position_ce.line - range.start.line,\n                    ch: source_position_ce.column - range.start.column\n                };\n                return document.document_at_source_position(source_position_cm);\n            }\n        }\n        return this;\n    }\n    is_within_foreign(source_position) {\n        let source_line = this.source_lines.get(source_position.line);\n        let source_position_ce = {\n            line: source_line.editor_line,\n            column: source_position.ch\n        };\n        for (let [range] of source_line.foreign_documents_map) {\n            if (is_within_range(source_position_ce, range)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    virtual_position_at_document(source_position) {\n        let source_line = this.source_lines.get(source_position.line);\n        if (source_line == null) {\n            throw new PositionError('Source line not mapped to virtual position');\n        }\n        let virtual_line = source_line.virtual_line;\n        // position inside the cell (block)\n        let source_position_ce = {\n            line: source_line.editor_line,\n            column: source_position.ch\n        };\n        for (let [range, { virtual_line, virtual_document: document }] of source_line.foreign_documents_map) {\n            if (is_within_range(source_position_ce, range)) {\n                // position inside the foreign document block\n                let source_position_cm = {\n                    line: source_position_ce.line - range.start.line,\n                    ch: source_position_ce.column - range.start.column\n                };\n                if (document.is_within_foreign(source_position_cm)) {\n                    return this.virtual_position_at_document(source_position_cm);\n                }\n                else {\n                    // where in this block in the entire foreign document?\n                    source_position_cm.line += virtual_line;\n                    return source_position_cm;\n                }\n            }\n        }\n        return {\n            ch: source_position.ch,\n            line: virtual_line\n        };\n    }\n    choose_foreign_document(extractor) {\n        let foreign_document;\n        // if not standalone, try to append to existing document\n        let foreign_exists = this.foreign_documents.has(extractor.language);\n        if (!extractor.standalone && foreign_exists) {\n            foreign_document = this.foreign_documents.get(extractor.language);\n            this.unused_documents.delete(foreign_document);\n        }\n        else {\n            // if standalone, try to re-use existing connection to the server\n            let unused_standalone = this.unused_standalone_documents.get(extractor.language);\n            if (extractor.standalone && unused_standalone.length > 0) {\n                foreign_document = unused_standalone.pop();\n                this.unused_documents.delete(foreign_document);\n            }\n            else {\n                // if (previous document does not exists) or (extractor produces standalone documents\n                // and no old standalone document could be reused): create a new document\n                foreign_document = this.open_foreign(extractor.language, extractor.standalone, extractor.file_extension);\n            }\n        }\n        return foreign_document;\n    }\n    extract_foreign_code(block, editor_shift) {\n        let foreign_document_map = new Map();\n        let cell_code = block.value;\n        for (let extractor of this.foreign_extractors) {\n            // first, check if there is any foreign code:\n            if (!extractor.has_foreign_code(cell_code)) {\n                continue;\n            }\n            let results = extractor.extract_foreign_code(cell_code);\n            let kept_cell_code = '';\n            for (let result of results) {\n                if (result.foreign_code !== null) {\n                    // result.range should only be null if result.foregin_code is null\n                    if (result.range === null) {\n                        this.console.warn('Failure in foreign code extraction: `range` is null but `foreign_code` is not!');\n                        continue;\n                    }\n                    let foreign_document = this.choose_foreign_document(extractor);\n                    foreign_document_map.set(result.range, {\n                        virtual_line: foreign_document.last_virtual_line,\n                        virtual_document: foreign_document,\n                        editor: block.ce_editor\n                    });\n                    let foreign_shift = {\n                        line: editor_shift.line + result.range.start.line,\n                        column: editor_shift.column + result.range.start.column\n                    };\n                    foreign_document.append_code_block({\n                        value: result.foreign_code,\n                        ce_editor: block.ce_editor\n                    }, foreign_shift, result.virtual_shift);\n                }\n                if (result.host_code != null) {\n                    kept_cell_code += result.host_code;\n                }\n            }\n            // not breaking - many extractors are allowed to process the code, one after each other\n            // (think JS and CSS in HTML, or %R inside of %%timeit).\n            cell_code = kept_cell_code;\n        }\n        return { cell_code_kept: cell_code, foreign_document_map };\n    }\n    decode_code_block(raw_code) {\n        // TODO: add back previously extracted foreign code\n        let cell_override = this.cell_magics_overrides.reverse.override_for(raw_code);\n        if (cell_override != null) {\n            return cell_override;\n        }\n        else {\n            let lines = this.line_magics_overrides.reverse_replace_all(raw_code.split('\\n'));\n            return lines.join('\\n');\n        }\n    }\n    prepare_code_block(block, editor_shift = { line: 0, column: 0 }) {\n        let lines;\n        let skip_inspect;\n        let { cell_code_kept, foreign_document_map } = this.extract_foreign_code(block, editor_shift);\n        let cell_code = cell_code_kept;\n        // cell magics are replaced if requested and matched\n        let cell_override = this.cell_magics_overrides.override_for(cell_code);\n        if (cell_override != null) {\n            lines = cell_override.split('\\n');\n            skip_inspect = lines.map(l => [this.id_path]);\n        }\n        else {\n            // otherwise, we replace line magics - if any\n            let result = this.line_magics_overrides.replace_all(cell_code.split('\\n'));\n            lines = result.lines;\n            skip_inspect = result.skip_inspect.map(skip => skip ? [this.id_path] : []);\n        }\n        return { lines, foreign_document_map, skip_inspect };\n    }\n    get foreign_document_maps() {\n        let maps = new Set();\n        for (let line of this.source_lines.values()) {\n            maps.add(line.foreign_documents_map);\n        }\n        return [...maps.values()];\n    }\n    append_code_block(block, editor_shift = { line: 0, column: 0 }, virtual_shift) {\n        let cell_code = block.value;\n        let ce_editor = block.ce_editor;\n        if (this.isDisposed) {\n            console.warn('Cannot append code block: document disposed');\n            return;\n        }\n        let source_cell_lines = cell_code.split('\\n');\n        let { lines, foreign_document_map, skip_inspect } = this.prepare_code_block(block, editor_shift);\n        for (let i = 0; i < lines.length; i++) {\n            this.virtual_lines.set(this.last_virtual_line + i, {\n                skip_inspect: skip_inspect[i],\n                editor: ce_editor,\n                // TODO this is incorrect, wont work if something was extracted\n                source_line: this.last_source_line + i\n            });\n        }\n        for (let i = 0; i < source_cell_lines.length; i++) {\n            this.source_lines.set(this.last_source_line + i, {\n                editor_line: i,\n                editor_shift: {\n                    line: editor_shift.line - ((virtual_shift === null || virtual_shift === void 0 ? void 0 : virtual_shift.line) || 0),\n                    column: i === 0 ? editor_shift.column - ((virtual_shift === null || virtual_shift === void 0 ? void 0 : virtual_shift.column) || 0) : 0\n                },\n                // TODO: move those to a new abstraction layer (DocumentBlock class)\n                editor: ce_editor,\n                foreign_documents_map: foreign_document_map,\n                // TODO this is incorrect, wont work if something was extracted\n                virtual_line: this.last_virtual_line + i\n            });\n        }\n        this.last_virtual_line += lines.length;\n        // one empty line is necessary to separate code blocks, next 'n' lines are to silence linters;\n        // the final cell does not get the additional lines (thanks to the use of join, see below)\n        this.line_blocks.push(lines.join('\\n') + '\\n');\n        // adding the virtual lines for the blank lines\n        for (let i = 0; i < this.blank_lines_between_cells; i++) {\n            this.virtual_lines.set(this.last_virtual_line + i, {\n                skip_inspect: [this.id_path],\n                editor: ce_editor,\n                source_line: null\n            });\n        }\n        this.last_virtual_line += this.blank_lines_between_cells;\n        this.last_source_line += source_cell_lines.length;\n    }\n    get value() {\n        let lines_padding = '\\n'.repeat(this.blank_lines_between_cells);\n        return this.line_blocks.join(lines_padding);\n    }\n    get last_line() {\n        const lines_in_last_block = this.line_blocks[this.line_blocks.length - 1].split('\\n');\n        return lines_in_last_block[lines_in_last_block.length - 1];\n    }\n    close_expired_documents() {\n        for (let document of this.unused_documents.values()) {\n            document.remaining_lifetime -= 1;\n            if (document.remaining_lifetime <= 0) {\n                this.close_foreign(document);\n            }\n        }\n    }\n    close_foreign(document) {\n        console.log('LSP: closing document', document);\n        this.foreign_document_closed.emit({\n            foreign_document: document,\n            parent_host: this\n        });\n        // remove it from foreign documents list\n        this.foreign_documents.delete(document.virtual_id);\n        // and delete the documents within it\n        document.close_all_foreign_documents();\n        document.foreign_document_closed.disconnect(this.forward_closed_signal, this);\n        document.foreign_document_opened.disconnect(this.forward_opened_signal, this);\n    }\n    close_all_foreign_documents() {\n        for (let document of this.foreign_documents.values()) {\n            this.close_foreign(document);\n        }\n    }\n    get virtual_id() {\n        // for easier debugging, the language information is included in the ID:\n        return this.standalone\n            ? this.instance_id + '(' + this.language + ')'\n            : this.language;\n    }\n    get ancestry() {\n        if (!this.parent) {\n            return [this];\n        }\n        return this.parent.ancestry.concat([this]);\n    }\n    get id_path() {\n        if (!this.parent) {\n            return this.virtual_id;\n        }\n        return this.parent.id_path + '-' + this.virtual_id;\n    }\n    get uri() {\n        const encodedPath = encodeURI(this.path);\n        if (!this.parent) {\n            return encodedPath;\n        }\n        return encodedPath + '.' + this.id_path + '.' + this.file_extension;\n    }\n    transform_source_to_editor(pos) {\n        let source_line = this.source_lines.get(pos.line);\n        let editor_line = source_line.editor_line;\n        let editor_shift = source_line.editor_shift;\n        return {\n            // only shift column in the line beginning the virtual document (first list of the editor in cell magics, but might be any line of editor in line magics!)\n            ch: pos.ch + (editor_line === 0 ? editor_shift.column : 0),\n            line: editor_line + editor_shift.line\n            // TODO or:\n            //  line: pos.line + editor_shift.line - this.first_line_of_the_block(editor)\n        };\n    }\n    /**\n    Can be null because some lines are added as padding/anchors\n    to the virtual document and those do not exist in the source document\n    and thus they are absent in the editor.\n    */\n    transform_virtual_to_editor(virtual_position) {\n        let source_position = this.transform_virtual_to_source(virtual_position);\n        if (source_position == null) {\n            return null;\n        }\n        return this.transform_source_to_editor(source_position);\n    }\n    /**\n    Can be null because some lines are added as padding/anchors\n    to the virtual document and those do not exist in the source document.\n    */\n    transform_virtual_to_source(position) {\n        const line = this.virtual_lines.get(position.line).source_line;\n        if (line == null) {\n            return null;\n        }\n        return {\n            ch: position.ch,\n            line: line\n        };\n    }\n    get root() {\n        if (this.parent == null) {\n            return this;\n        }\n        return this.parent.root;\n    }\n    get_editor_at_virtual_line(pos) {\n        let line = pos.line;\n        // tolerate overshot by one (the hanging blank line at the end)\n        if (!this.virtual_lines.has(line)) {\n            line -= 1;\n        }\n        return this.virtual_lines.get(line).editor;\n    }\n    get_editor_at_source_line(pos) {\n        return this.source_lines.get(pos.line).editor;\n    }\n    /**\n     * Recursively emits changed signal from the document or any descendant foreign document.\n     */\n    maybe_emit_changed() {\n        if (this.value !== this.previous_value) {\n            this.changed.emit(this);\n        }\n        this.previous_value = this.value;\n        for (let document of this.foreign_documents.values()) {\n            document.maybe_emit_changed();\n        }\n    }\n}\nVirtualDocument.instances_count = 0;\nexport function collect_documents(virtual_document) {\n    let collected = new Set();\n    collected.add(virtual_document);\n    for (let foreign of virtual_document.foreign_documents.values()) {\n        let foreign_languages = collect_documents(foreign);\n        foreign_languages.forEach(collected.add, collected);\n    }\n    return collected;\n}\nexport class UpdateManager {\n    constructor(virtual_document, console) {\n        this.virtual_document = virtual_document;\n        /**\n         * Virtual documents update guard.\n         */\n        this.is_update_in_progress = false;\n        this.update_lock = false;\n        this.isDisposed = false;\n        this.update_done = new Promise(resolve => {\n            resolve();\n        });\n        this.document_updated = new Signal(this);\n        this.block_added = new Signal(this);\n        this.update_began = new Signal(this);\n        this.update_finished = new Signal(this);\n        this.document_updated.connect(this.on_updated, this);\n        this.console = console || new BrowserConsole();\n    }\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this.document_updated.disconnect(this.on_updated, this);\n    }\n    /**\n     * Once all the foreign documents were refreshed, the unused documents (and their connections)\n     * should be terminated if their lifetime has expired.\n     */\n    on_updated(manager, root_document) {\n        try {\n            root_document.close_expired_documents();\n        }\n        catch (e) {\n            this.console.warn('Failed to close expired documents');\n        }\n    }\n    can_update() {\n        return !this.isDisposed && !this.is_update_in_progress && !this.update_lock;\n    }\n    /**\n     * Execute provided callback within an update-locked context, which guarantees that:\n     *  - the previous updates must have finished before the callback call, and\n     *  - no update will happen when executing the callback\n     * @param fn - the callback to execute in update lock\n     */\n    async with_update_lock(fn) {\n        await until_ready(() => this.can_update(), 12, 10).then(() => {\n            try {\n                this.update_lock = true;\n                fn();\n            }\n            finally {\n                this.update_lock = false;\n            }\n        });\n    }\n    /**\n     * Update all the virtual documents, emit documents updated with root document if succeeded,\n     * and resolve a void promise. The promise does not contain the text value of the root document,\n     * as to avoid an easy trap of ignoring the changes in the virtual documents.\n     */\n    async update_documents(blocks) {\n        let update = new Promise(async (resolve, reject) => {\n            // defer the update by up to 50 ms (10 retrials * 5 ms break),\n            // awaiting for the previous update to complete.\n            await until_ready(() => this.can_update(), 10, 5).then(() => {\n                if (this.isDisposed || !this.virtual_document) {\n                    resolve();\n                }\n                try {\n                    this.is_update_in_progress = true;\n                    this.update_began.emit(blocks);\n                    this.virtual_document.clear();\n                    for (let code_block of blocks) {\n                        this.block_added.emit({\n                            block: code_block,\n                            virtual_document: this.virtual_document\n                        });\n                        this.virtual_document.append_code_block(code_block);\n                    }\n                    this.update_finished.emit(blocks);\n                    if (this.virtual_document) {\n                        this.document_updated.emit(this.virtual_document);\n                        this.virtual_document.maybe_emit_changed();\n                    }\n                    resolve();\n                }\n                catch (e) {\n                    this.console.warn('Documents update failed:', e);\n                    reject(e);\n                }\n                finally {\n                    this.is_update_in_progress = false;\n                }\n            });\n        });\n        this.update_done = update;\n        return update;\n    }\n}\n//# sourceMappingURL=document.js.map","import { until_ready } from '../utils';\nexport class EditorAdapter {\n    constructor(editor, virtual_document, features = new Array(), console) {\n        this.editor = editor;\n        this.virtual_document = virtual_document;\n        this.isDisposed = false;\n        this.editor.change.connect(this.saveChange, this);\n        this.console = console.scope('EditorAdapter');\n        this.features = new Map();\n        for (let feature of features) {\n            feature.register();\n            if (!feature.is_registered) {\n                this.console.warn('The feature ', feature, 'was not registered properly');\n            }\n            this.features.set(feature.feature.id, feature);\n        }\n    }\n    async updateAfterChange() {\n        try {\n            await until_ready(() => this.last_change != null, 30, 22);\n        }\n        catch (err) {\n            this.console.log('No change obtained from CodeMirror editor within the expected time of 0.66s');\n            return;\n        }\n        let change = this.last_change;\n        let root_position;\n        try {\n            root_position = this.editor.get_cursor_position();\n        }\n        catch (err) {\n            this.console.log('Root position not found');\n            return;\n        }\n        try {\n            let document = this.editor.document_at_root_position(root_position);\n            if (this.virtual_document !== document) {\n                return true;\n            }\n            if (!change || !change.text.length || !change.text[0].length) {\n                // deletion - ignore\n                return true;\n            }\n            for (let feature of this.features.values()) {\n                try {\n                    if (feature.afterChange) {\n                        feature.afterChange(change, root_position);\n                    }\n                }\n                catch (err) {\n                    console.warn('afterChange of feature', feature, 'failed with', err);\n                }\n            }\n            return true;\n        }\n        catch (e) {\n            this.console.log('updateAfterChange failure');\n            this.console.error(e);\n        }\n        this.invalidateLastChange();\n        return undefined;\n    }\n    invalidateLastChange() {\n        this.last_change = null;\n    }\n    saveChange(sender, change) {\n        this.last_change = change;\n    }\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        for (let feature of this.features.values()) {\n            feature.remove();\n        }\n        this.features.clear();\n        this.editor.change.disconnect(this.saveChange);\n        // just to be sure\n        this.editor = null;\n        // actually disposed\n        this.isDisposed = true;\n    }\n}\n//# sourceMappingURL=editor_adapter.js.map","import { Dialog, showDialog } from '@jupyterlab/apputils';\nimport { nullTranslator } from '@jupyterlab/translation';\nimport { Signal } from '@lumino/signaling';\nimport mergeWith from 'lodash.mergewith';\nimport { EditorAdapter } from '../editor_integration/editor_adapter';\nvar createButton = Dialog.createButton;\nexport class StatusMessage {\n    constructor() {\n        this.message = '';\n        this.changed = new Signal(this);\n        this.timer = null;\n    }\n    /**\n     * Set the text message and (optionally) the timeout to remove it.\n     * @param message\n     * @param timeout - number of ms to until the message is cleaned;\n     *        -1 if the message should stay up indefinitely;\n     *        defaults to 3000ms (3 seconds)\n     */\n    set(message, timeout = 1000 * 3) {\n        this.expire_timer();\n        this.message = message;\n        this.changed.emit();\n        if (timeout !== -1) {\n            this.timer = window.setTimeout(this.clear.bind(this), timeout);\n        }\n    }\n    clear() {\n        this.message = '';\n        this.changed.emit();\n    }\n    expire_timer() {\n        if (this.timer !== null) {\n            window.clearTimeout(this.timer);\n            this.timer = 0;\n        }\n    }\n}\n/**\n * The values should follow the https://microsoft.github.io/language-server-protocol/specification guidelines\n */\nconst mime_type_language_map = {\n    'text/x-rsrc': 'r',\n    'text/x-r-source': 'r',\n    // currently there are no LSP servers for IPython we are aware of\n    'text/x-ipython': 'python'\n};\n/**\n * Foreign code: low level adapter is not aware of the presence of foreign languages;\n * it operates on the virtual document and must not attempt to infer the language dependencies\n * as this would make the logic of inspections caching impossible to maintain, thus the WidgetAdapter\n * has to handle that, keeping multiple connections and multiple virtual documents.\n */\nexport class WidgetAdapter {\n    // note: it could be using namespace/IOptions pattern,\n    // but I do not know how to make it work with the generic type T\n    // (other than using 'any' in the IOptions interface)\n    constructor(extension, widget) {\n        this.extension = extension;\n        this.widget = widget;\n        this.isDisposed = false;\n        this.app = extension.app;\n        this.connection_manager = extension.connection_manager;\n        this.adapterConnected = new Signal(this);\n        this.activeEditorChanged = new Signal(this);\n        this.editorRemoved = new Signal(this);\n        this.editorAdded = new Signal(this);\n        this.adapters = new Map();\n        this.status_message = new StatusMessage();\n        this.isConnected = false;\n        this.console = extension.console.scope('WidgetAdapter');\n        this.trans = (extension.translator || nullTranslator).load('jupyterlab-lsp');\n        // set up signal connections\n        this.widget.context.saveState.connect(this.on_save_state, this);\n        this.connection_manager.closed.connect(this.on_connection_closed, this);\n        this.widget.disposed.connect(this.dispose, this);\n    }\n    get foreign_code_extractors() {\n        return this.extension.foreign_code_extractors;\n    }\n    get code_overrides() {\n        return this.extension.code_overrides;\n    }\n    on_connection_closed(manager, { virtual_document }) {\n        var _a;\n        this.console.log('connection closed, disconnecting adapter', virtual_document.id_path);\n        if (virtual_document !== ((_a = this.virtual_editor) === null || _a === void 0 ? void 0 : _a.virtual_document)) {\n            return;\n        }\n        this.dispose();\n    }\n    dispose() {\n        var _a, _b;\n        if (this.isDisposed) {\n            return;\n        }\n        if ((_a = this.virtual_editor) === null || _a === void 0 ? void 0 : _a.virtual_document) {\n            this.disconnect_adapter((_b = this.virtual_editor) === null || _b === void 0 ? void 0 : _b.virtual_document);\n        }\n        this.widget.context.saveState.disconnect(this.on_save_state, this);\n        this.connection_manager.closed.disconnect(this.on_connection_closed, this);\n        this.widget.disposed.disconnect(this.dispose, this);\n        this.disconnect();\n        // just to be sure\n        this.virtual_editor = null;\n        this.app = null;\n        this.widget = null;\n        this.connection_manager = null;\n        this.widget = null;\n        this.isDisposed = true;\n    }\n    get widget_id() {\n        return this.widget.id;\n    }\n    get language() {\n        // the values should follow https://microsoft.github.io/language-server-protocol/specification guidelines,\n        // see the table in https://microsoft.github.io/language-server-protocol/specification#textDocumentItem\n        if (mime_type_language_map.hasOwnProperty(this.mime_type)) {\n            return mime_type_language_map[this.mime_type];\n        }\n        else {\n            let without_parameters = this.mime_type.split(';')[0];\n            let [type, subtype] = without_parameters.split('/');\n            if (type === 'application' || type === 'text') {\n                if (subtype.startsWith('x-')) {\n                    return subtype.substr(2);\n                }\n                else {\n                    return subtype;\n                }\n            }\n            else {\n                return this.mime_type;\n            }\n        }\n    }\n    disconnect() {\n        this.connection_manager.unregister_document(this.virtual_editor.virtual_document);\n        this.widget.context.model.contentChanged.disconnect(this.onContentChanged, this);\n        // pretend that all editors were removed to trigger the disconnection of even handlers\n        // they will be connected again on new connection\n        for (let editor of this.editors) {\n            this.editorRemoved.emit({\n                editor: editor\n            });\n        }\n        for (let adapter of this.adapters.values()) {\n            adapter.dispose();\n        }\n        this.adapters.clear();\n        this.virtual_editor.dispose();\n    }\n    // equivalent to triggering didClose and didOpen, as per syncing specification,\n    // but also reloads the connection; used during file rename (or when it was moved)\n    reload_connection() {\n        // ignore premature calls (before the editor was initialized)\n        if (this.virtual_editor == null) {\n            return;\n        }\n        // disconnect all existing connections (and dispose adapters)\n        this.disconnect();\n        // recreate virtual document using current path and language\n        // as virtual editor assumes it gets the virtual document at init,\n        // just dispose virtual editor (which disposes virtual document too)\n        // and re-initialize both virtual editor and document\n        this.init_virtual();\n        // reconnect\n        this.connect_document(this.virtual_editor.virtual_document, true).catch(this.console.warn);\n    }\n    on_save_state(context, state) {\n        // ignore premature calls (before the editor was initialized)\n        if (this.virtual_editor == null) {\n            return;\n        }\n        // TODO: remove workaround no later than with 3.2 release of JupyterLab\n        // workaround for https://github.com/jupyterlab/jupyterlab/issues/10721\n        // while already reverted in https://github.com/jupyterlab/jupyterlab/pull/10741,\n        // it was not released yet and many users will continue to run 3.1.0 and 3.1.1\n        // so lets workaround it for now\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        const completedManually = state === 'completed manually';\n        if (state === 'completed' || completedManually) {\n            // note: must only be send to the appropriate connections as\n            // some servers (Julia) break if they receive save notification\n            // for a document that was not opened before, see:\n            // https://github.com/jupyter-lsp/jupyterlab-lsp/issues/490\n            const documents_to_save = [this.virtual_editor.virtual_document];\n            for (let virtual_document of documents_to_save) {\n                let connection = this.connection_manager.connections.get(virtual_document.uri);\n                this.console.log('Sending save notification for', virtual_document.uri, 'to', connection);\n                connection.sendSaved(virtual_document.document_info);\n                for (let foreign of virtual_document.foreign_documents.values()) {\n                    documents_to_save.push(foreign);\n                }\n            }\n        }\n    }\n    /**\n     * public for use in tests (but otherwise could be private)\n     */\n    update_documents() {\n        if (this.isDisposed) {\n            this.console.warn('Cannot update documents: adapter disposed');\n            return;\n        }\n        return this.virtual_editor.virtual_document.update_manager.update_documents(this.editors.map(ce_editor => {\n            return {\n                ce_editor: ce_editor,\n                value: this.virtual_editor.get_editor_value(ce_editor)\n            };\n        }));\n    }\n    get has_multiple_editors() {\n        return this.editors.length > 1;\n    }\n    async on_connected(data) {\n        let { virtual_document } = data;\n        this.connect_adapter(data.virtual_document, data.connection);\n        this.adapterConnected.emit(data);\n        this.isConnected = true;\n        const promise = this.update_documents();\n        if (!promise) {\n            this.console.warn('Could not update documents');\n            return;\n        }\n        await promise.then(() => {\n            // refresh the document on the LSP server\n            this.document_changed(virtual_document, virtual_document, true);\n            this.console.log('virtual document(s) for', this.document_path, 'have been initialized');\n        });\n        // Note: the logger extension behaves badly with non-default names\n        // as it changes the source to the active file afterwards anyways\n        const loggerSourceName = virtual_document.uri;\n        let log;\n        if (this.extension.user_console) {\n            const logger = this.extension.user_console.getLogger(loggerSourceName);\n            log = (text) => {\n                logger.log({\n                    type: 'text',\n                    data: text\n                });\n            };\n        }\n        else {\n            log = (text) => console.log(text);\n        }\n        data.connection.serverNotifications['$/logTrace'].connect((connection, message) => {\n            this.console.log(data.connection.serverIdentifier, 'trace', virtual_document.uri, message);\n        });\n        data.connection.serverNotifications['window/logMessage'].connect((connection, message) => {\n            this.console.log(data.connection.serverIdentifier, virtual_document.uri, message);\n            log(connection.serverIdentifier + ': ' + message.message);\n        });\n        data.connection.serverNotifications['window/showMessage'].connect((connection, message) => {\n            this.console.log(data.connection.serverIdentifier, virtual_document.uri, message.message);\n            void showDialog({\n                title: this.trans.__('Message from ') + connection.serverIdentifier,\n                body: message.message\n            });\n        });\n        data.connection.serverRequests['window/showMessageRequest'].setHandler(async (params) => {\n            this.console.log(data.connection.serverIdentifier, virtual_document.uri, params);\n            const actionItems = params.actions;\n            const buttons = actionItems\n                ? actionItems.map(action => {\n                    return createButton({\n                        label: action.title\n                    });\n                })\n                : [createButton({ label: this.trans.__('Dismiss') })];\n            const result = await showDialog({\n                title: this.trans.__('Message from ') + data.connection.serverIdentifier,\n                body: params.message,\n                buttons: buttons\n            });\n            const choice = buttons.indexOf(result.button);\n            if (choice === -1) {\n                return null;\n            }\n            if (actionItems) {\n                return actionItems[choice];\n            }\n            return null;\n        });\n    }\n    /**\n     * Opens a connection for the document. The connection may or may\n     * not be initialized, yet, and depending on when this is called, the client\n     * may not be fully connected.\n     *\n     * @param virtual_document a VirtualDocument\n     * @param send_open whether to open the document immediately\n     */\n    async connect_document(virtual_document, send_open = false) {\n        virtual_document.changed.connect(this.document_changed, this);\n        virtual_document.foreign_document_opened.connect(this.on_foreign_document_opened, this);\n        const connection_context = await this.connect(virtual_document).catch(this.console.warn);\n        if (!send_open) {\n            return;\n        }\n        if (connection_context && connection_context.connection) {\n            connection_context.connection.sendOpenWhenReady(virtual_document.document_info);\n        }\n        else {\n            this.console.warn(`Connection for ${virtual_document.path} was not opened`);\n        }\n    }\n    create_virtual_editor(options) {\n        let editorType = this.extension.editor_type_manager.findBestImplementation(this.editors);\n        if (editorType == null) {\n            return null;\n        }\n        let virtualEditorConstructor = editorType.implementation;\n        return new virtualEditorConstructor(options);\n    }\n    init_virtual() {\n        let virtual_editor = this.create_virtual_editor({\n            adapter: this,\n            virtual_document: this.create_virtual_document()\n        });\n        if (virtual_editor == null) {\n            this.console.error('Could not initialize a VirtualEditor for adapter: ', this);\n            return;\n        }\n        this.virtual_editor = virtual_editor;\n        this.connect_contentChanged_signal();\n    }\n    /**\n     * Handler for opening a document contained in a parent document. The assumption\n     * is that the editor already exists for this, and as such the document\n     * should be queued for immediate opening.\n     *\n     * @param host the VirtualDocument that contains the VirtualDocument in another language\n     * @param context information about the foreign VirtualDocument\n     */\n    async on_foreign_document_opened(host, context) {\n        const { foreign_document } = context;\n        await this.connect_document(foreign_document, true);\n        foreign_document.foreign_document_closed.connect(this.on_foreign_document_closed, this);\n    }\n    on_foreign_document_closed(host, context) {\n        const { foreign_document } = context;\n        foreign_document.foreign_document_closed.disconnect(this.on_foreign_document_closed, this);\n        foreign_document.foreign_document_opened.disconnect(this.on_foreign_document_opened, this);\n        foreign_document.changed.disconnect(this.document_changed, this);\n    }\n    document_changed(virtual_document, document, is_init = false) {\n        if (this.isDisposed) {\n            this.console.warn('Cannot swap document: adapter disposed');\n            return;\n        }\n        // TODO only send the difference, using connection.sendSelectiveChange()\n        let connection = this.connection_manager.connections.get(virtual_document.uri);\n        let adapter = this.adapters.get(virtual_document.id_path);\n        if (!(connection === null || connection === void 0 ? void 0 : connection.isReady)) {\n            this.console.log('Skipping document update signal: connection not ready');\n            return;\n        }\n        if (adapter == null) {\n            this.console.log('Skipping document update signal: adapter not ready');\n            return;\n        }\n        // this.virtual_editor.console.log(\n        //   'LSP: virtual document',\n        //   virtual_document.id_path,\n        //   'has changed sending update'\n        // );\n        connection.sendFullTextChange(virtual_document.value, virtual_document.document_info);\n        // the first change (initial) is not propagated to features,\n        // as it has no associated CodeMirrorChange object\n        if (!is_init) {\n            // guarantee that the virtual editor won't perform an update of the virtual documents while\n            // the changes are recorded...\n            // TODO this is not ideal - why it solves the problem of some errors,\n            //  it introduces an unnecessary delay. A better way could be to invalidate some of the updates when a new one comes in.\n            //  but maybe not every one (then the outdated state could be kept for too long fo a user who writes very quickly)\n            //  also we would not want to invalidate the updates for the purpose of autocompletion (the trigger characters)\n            this.virtual_editor.virtual_document.update_manager\n                .with_update_lock(async () => {\n                await adapter.updateAfterChange();\n            })\n                .then()\n                .catch(this.console.warn);\n        }\n    }\n    connect_adapter(virtual_document, connection, features = null) {\n        let adapter = this.create_adapter(virtual_document, connection, features);\n        this.adapters.set(virtual_document.id_path, adapter);\n        return adapter;\n    }\n    disconnect_adapter(virtual_document) {\n        let adapter = this.adapters.get(virtual_document.id_path);\n        this.adapters.delete(virtual_document.id_path);\n        if (adapter != null) {\n            adapter.dispose();\n        }\n    }\n    get_features(virtual_document) {\n        let adapter = this.adapters.get(virtual_document.id_path);\n        return adapter === null || adapter === void 0 ? void 0 : adapter.features;\n    }\n    async connect(virtual_document) {\n        let language = virtual_document.language;\n        this.console.log(`will connect using language: ${language}`);\n        let capabilities = {\n            textDocument: {\n                synchronization: {\n                    dynamicRegistration: true,\n                    willSave: false,\n                    didSave: true,\n                    willSaveWaitUntil: false\n                }\n            },\n            workspace: {\n                didChangeConfiguration: {\n                    dynamicRegistration: true\n                }\n            }\n        };\n        for (const feature of this.extension.feature_manager.features) {\n            if (!feature.capabilities) {\n                continue;\n            }\n            capabilities = mergeWith(capabilities, feature.capabilities);\n        }\n        let options = {\n            capabilities,\n            virtual_document,\n            language,\n            document_path: this.document_path\n        };\n        let connection = await this.connection_manager.connect(options);\n        if (connection) {\n            await this.on_connected({ virtual_document, connection });\n            return {\n                connection,\n                virtual_document\n            };\n        }\n        else {\n            return undefined;\n        }\n    }\n    /**\n     * Connect the change signal in order to update all virtual documents after a change.\n     *\n     * Update to the state of a notebook may be done without a notice on the CodeMirror level,\n     * e.g. when a cell is deleted. Therefore a JupyterLab-specific signals are watched instead.\n     *\n     * While by not using the change event of CodeMirror editors we loose an easy way to send selective,\n     * (range) updates this can be still implemented by comparison of before/after states of the\n     * virtual documents, which is even more resilient and -obviously - editor-independent.\n     */\n    connect_contentChanged_signal() {\n        this.widget.context.model.contentChanged.connect(this.onContentChanged, this);\n    }\n    create_adapter(virtual_document, connection, features = null) {\n        let adapter_features = new Array();\n        if (features === null) {\n            features = this.extension.feature_manager.features;\n        }\n        for (let feature of features) {\n            let featureEditorIntegrationConstructor = feature.editorIntegrationFactory.get(this.virtual_editor.editor_name);\n            let integration = new featureEditorIntegrationConstructor({\n                feature: feature,\n                virtual_editor: this.virtual_editor,\n                virtual_document: virtual_document,\n                connection: connection,\n                status_message: this.status_message,\n                settings: feature.settings,\n                adapter: this,\n                trans: this.trans\n            });\n            adapter_features.push(integration);\n        }\n        let adapter = new EditorAdapter(this.virtual_editor, virtual_document, adapter_features, this.console);\n        this.console.log('Adapter for', this.document_path, 'is ready.');\n        // the client is now fully ready: signal to the server that the document is \"open\"\n        connection.sendOpenWhenReady(virtual_document.document_info);\n        return adapter;\n    }\n    async onContentChanged(_slot) {\n        // update the virtual documents (sending the updates to LSP is out of scope here)\n        const promise = this.update_documents();\n        if (!promise) {\n            this.console.warn('Could not update documents');\n            return;\n        }\n        this.update_finished = promise.catch(this.console.warn);\n        await this.update_finished;\n    }\n    get_position_from_context_menu() {\n        // Note: could also try using this.app.contextMenu.menu.contentNode position.\n        // Note: could add a guard on this.app.contextMenu.menu.isAttached\n        // get the first node as it gives the most accurate approximation\n        let leaf_node = this.app.contextMenuHitTest(() => true);\n        if (!leaf_node) {\n            return null;\n        }\n        let { left, top } = leaf_node.getBoundingClientRect();\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        let event = this.app._contextMenuEvent;\n        // if possible, use more accurate position from the actual event\n        // (but this relies on an undocumented and unstable feature)\n        if (event !== undefined) {\n            left = event.clientX;\n            top = event.clientY;\n            event.stopPropagation();\n        }\n        return this.virtual_editor.window_coords_to_root_position({\n            left: left,\n            top: top\n        });\n    }\n    get_context(root_position) {\n        // ignore premature calls and calls after disposal\n        if (!this.virtual_editor) {\n            return null;\n        }\n        let document = this.virtual_editor.document_at_root_position(root_position);\n        let virtual_position = this.virtual_editor.root_position_to_virtual_position(root_position);\n        return {\n            document,\n            connection: this.connection_manager.connections.get(document.uri),\n            virtual_position,\n            root_position,\n            features: this.get_features(document),\n            editor: this.virtual_editor,\n            app: this.app,\n            adapter: this\n        };\n    }\n    get_context_from_context_menu() {\n        let root_position = this.get_position_from_context_menu();\n        if (!root_position) {\n            return null;\n        }\n        return this.get_context(root_position);\n    }\n}\n//# sourceMappingURL=adapter.js.map","import { PositionConverter } from '../../converter';\nimport { VirtualDocument } from '../../virtual/document';\nimport { WidgetAdapter } from '../adapter';\nexport class FileEditorAdapter extends WidgetAdapter {\n    constructor(extension, editor_widget) {\n        super(extension, editor_widget);\n        this.editor = editor_widget.content;\n        this.initialized = new Promise((resolve, reject) => {\n            this.init_once_ready().then(resolve).catch(reject);\n        });\n    }\n    get document_path() {\n        return this.widget.context.path;\n    }\n    get mime_type() {\n        const codeMirrorMimeType = this.editor.model.mimeType;\n        const contentsModel = this.editor.context.contentsModel;\n        // when MIME type is not known it defaults to 'text/plain',\n        // so if it is different we can accept it as it is\n        if (codeMirrorMimeType != 'text/plain') {\n            return codeMirrorMimeType;\n        }\n        else if (contentsModel) {\n            // a script that does not have a MIME type known by the editor\n            // (no syntax highlight mode), can still be known by the document\n            // registry (and this is arguably easier to extend), so let's check it\n            // just in case; this is also how the \"Klingon\" language for testing\n            // gets registered, so we need it for tests too.\n            let fileType = this.extension.app.docRegistry.getFileTypeForModel(contentsModel);\n            return fileType.mimeTypes[0];\n        }\n        else {\n            // \"text/plain\" this is\n            return codeMirrorMimeType;\n        }\n    }\n    get language_file_extension() {\n        let parts = this.document_path.split('.');\n        return parts[parts.length - 1];\n    }\n    get ce_editor() {\n        return this.editor.editor;\n    }\n    get activeEditor() {\n        return this.editor.editor;\n    }\n    async init_once_ready() {\n        if (!this.editor.context.isReady) {\n            await this.editor.context.ready;\n        }\n        this.init_virtual();\n        this.console.log('file ready for connection:', this.path);\n        // connect the document, but do not open it as the adapter will handle this\n        // after registering all features\n        this.connect_document(this.virtual_editor.virtual_document, false).catch(this.console.warn);\n        this.editor.model.mimeTypeChanged.connect(this.reload_connection, this);\n    }\n    get_editor_index(ce_editor) {\n        return 0;\n    }\n    get_editor_wrapper(ce_editor) {\n        return this.wrapper_element;\n    }\n    get wrapper_element() {\n        return this.widget.node;\n    }\n    get path() {\n        return this.widget.context.path;\n    }\n    context_from_active_document() {\n        // short circuit if disposed\n        if (!this.virtual_editor || !this.get_context) {\n            return null;\n        }\n        let editor = this.widget.content.editor;\n        let ce_cursor = editor.getCursorPosition();\n        let root_position = PositionConverter.ce_to_cm(ce_cursor);\n        return this.get_context(root_position);\n    }\n    get_editor_index_at(position) {\n        return 0;\n    }\n    get editors() {\n        return [this.editor.editor];\n    }\n    create_virtual_document() {\n        // TODO: for now the magics and extractors are not used in FileEditor,\n        //  although it would make sense to pass extractors (e.g. for CSS in HTML,\n        //  or SQL in Python files) in the future. However, these would need to be\n        //  a different registry (as we would not want to extract kernel-specific\n        //  constructs like magics)\n        return new VirtualDocument({\n            language: this.language,\n            file_extension: this.language_file_extension,\n            path: this.document_path,\n            overrides_registry: {},\n            foreign_code_extractors: {},\n            standalone: true,\n            has_lsp_supported_file: true,\n            console: this.console\n        });\n    }\n}\n//# sourceMappingURL=file_editor.js.map","import { IEditorTracker } from '@jupyterlab/fileeditor';\nimport { ILSPAdapterManager, PLUGIN_ID } from '../../tokens';\nimport { FileEditorAdapter } from './file_editor';\nexport const FileEditorContextMenuEntryPoint = 'file-editor-context-menu';\nexport const FILE_EDITOR_ADAPTER = {\n    id: PLUGIN_ID + ':FileEditorAdapter',\n    requires: [ILSPAdapterManager],\n    optional: [IEditorTracker],\n    activate(app, adapterManager, fileEditorTracker) {\n        if (fileEditorTracker === null) {\n            console.warn('LSP: no fileEditorTracker - not registering file editor capabilities');\n        }\n        else {\n            adapterManager.registerAdapterType({\n                name: 'file_editor',\n                tracker: fileEditorTracker,\n                adapter: FileEditorAdapter,\n                entrypoint: FileEditorContextMenuEntryPoint,\n                get_id(widget) {\n                    return widget.id;\n                },\n                context_menu: {\n                    selector: '.jp-FileEditor',\n                    rank_group: 0,\n                    rank_group_size: 4\n                }\n            });\n        }\n    },\n    autoStart: true\n};\n//# sourceMappingURL=index.js.map","import { PositionConverter } from '../../converter';\nimport { until_ready } from '../../utils';\nimport { VirtualDocument } from '../../virtual/document';\nimport { WidgetAdapter } from '../adapter';\nexport class NotebookAdapter extends WidgetAdapter {\n    constructor(extension, editor_widget) {\n        super(extension, editor_widget);\n        this.type = 'code';\n        this.is_ready = () => {\n            var _a;\n            return (!this.widget.isDisposed &&\n                this.widget.context.isReady &&\n                this.widget.content.isVisible &&\n                this.widget.content.widgets.length > 0 &&\n                ((_a = this.widget.context.sessionContext.session) === null || _a === void 0 ? void 0 : _a.kernel) != null);\n        };\n        this.ce_editor_to_cell = new Map();\n        this.editor = editor_widget.content;\n        this.known_editors_ids = new Set();\n        this.initialized = new Promise((resolve, reject) => {\n            this.init_once_ready().then(resolve).catch(reject);\n        });\n    }\n    async update_language_info() {\n        var _a, _b, _c, _d;\n        const language_info = (_d = (await ((_c = (_b = (_a = this.widget.context.sessionContext) === null || _a === void 0 ? void 0 : _a.session) === null || _b === void 0 ? void 0 : _b.kernel) === null || _c === void 0 ? void 0 : _c.info))) === null || _d === void 0 ? void 0 : _d.language_info;\n        if (language_info) {\n            this._language_info = language_info;\n        }\n        else {\n            throw new Error('Language info update failed (no session, kernel, or info available)');\n        }\n    }\n    async on_kernel_changed(_session, change) {\n        if (!change.newValue) {\n            this.console.log('Kernel was shut down');\n            return;\n        }\n        try {\n            // note: we need to wait until ready before updating language info\n            this.console.log('Changed kernel, will try to reconnect');\n            const old_language_info = this._language_info;\n            await until_ready(this.is_ready, -1);\n            await this.update_language_info();\n            const new_language_info = this._language_info;\n            if ((old_language_info === null || old_language_info === void 0 ? void 0 : old_language_info.name) != new_language_info.name ||\n                (old_language_info === null || old_language_info === void 0 ? void 0 : old_language_info.mimetype) != (new_language_info === null || new_language_info === void 0 ? void 0 : new_language_info.mimetype) ||\n                (old_language_info === null || old_language_info === void 0 ? void 0 : old_language_info.file_extension) != (new_language_info === null || new_language_info === void 0 ? void 0 : new_language_info.file_extension)) {\n                this.console.log(`Changed to ${this._language_info.name} kernel, reconnecting`);\n                this.reload_connection();\n            }\n            else {\n                this.console.log('Keeping old LSP connection as the new kernel uses the same langauge');\n            }\n        }\n        catch (err) {\n            this.console.warn(err);\n            // try to reconnect anyway\n            this.reload_connection();\n        }\n    }\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this.widget.context.sessionContext.kernelChanged.disconnect(this.on_kernel_changed, this);\n        this.widget.content.activeCellChanged.disconnect(this.activeCellChanged, this);\n        super.dispose();\n        // editors are needed for the parent dispose() to unbind signals, so they are the last to go\n        this.ce_editor_to_cell.clear();\n    }\n    get document_path() {\n        return this.widget.context.path;\n    }\n    language_info() {\n        return this._language_info;\n    }\n    get mime_type() {\n        let language_metadata = this.language_info();\n        if (!language_metadata || !language_metadata.mimetype) {\n            // fallback to the code cell mime type if no kernel in use\n            return this.widget.content.codeMimetype;\n        }\n        return language_metadata.mimetype;\n    }\n    get language_file_extension() {\n        let language_metadata = this.language_info();\n        if (!language_metadata || !language_metadata.file_extension) {\n            return;\n        }\n        return language_metadata.file_extension.replace('.', '');\n    }\n    get wrapper_element() {\n        return this.widget.node;\n    }\n    async init_once_ready() {\n        this.console.log('waiting for', this.document_path, 'to fully load');\n        await this.widget.context.sessionContext.ready;\n        await until_ready(this.is_ready, -1);\n        await this.update_language_info();\n        this.console.log(this.document_path, 'ready for connection');\n        this.init_virtual();\n        // connect the document, but do not open it as the adapter will handle this\n        // after registering all features\n        this.connect_document(this.virtual_editor.virtual_document, false).catch(this.console.warn);\n        this.widget.context.sessionContext.kernelChanged.connect(this.on_kernel_changed, this);\n        this.widget.content.activeCellChanged.connect(this.activeCellChanged, this);\n        this._connectModelSignals(this.widget);\n        this.editor.modelChanged.connect(notebook => {\n            // note: this should not usually happen;\n            // there is no default action that would trigger this,\n            // its just a failsafe in case if another extension decides\n            // to swap the notebook model\n            this.console.warn('Model changed, connecting cell change handler; this is not something we were expecting');\n            this._connectModelSignals(notebook);\n        });\n    }\n    _connectModelSignals(notebook) {\n        if (notebook.model === null) {\n            this.console.warn(`Model is missing for notebook ${notebook}, cannot connet cell changed signal!`);\n        }\n        else {\n            notebook.model.cells.changed.connect(this.handle_cell_change, this);\n        }\n    }\n    async handle_cell_change(cells, change) {\n        let cellsAdded = [];\n        let cellsRemoved = [];\n        const type = this.type;\n        if (change.type === 'set') {\n            // handling of conversions is important, because the editors get re-used and their handlers inherited,\n            // so we need to clear our handlers from editors of e.g. markdown cells which previously were code cells.\n            let convertedToMarkdownOrRaw = [];\n            let convertedToCode = [];\n            if (change.newValues.length === change.oldValues.length) {\n                // during conversion the cells should not get deleted nor added\n                for (let i = 0; i < change.newValues.length; i++) {\n                    if (change.oldValues[i].type === type &&\n                        change.newValues[i].type !== type) {\n                        convertedToMarkdownOrRaw.push(change.newValues[i]);\n                    }\n                    else if (change.oldValues[i].type !== type &&\n                        change.newValues[i].type === type) {\n                        convertedToCode.push(change.newValues[i]);\n                    }\n                }\n                cellsAdded = convertedToCode;\n                cellsRemoved = convertedToMarkdownOrRaw;\n            }\n        }\n        else if (change.type == 'add') {\n            cellsAdded = change.newValues.filter(cellModel => cellModel.type === type);\n        }\n        // note: editorRemoved is not emitted for removal of cells by change of type 'remove' (but only during cell type conversion)\n        // because there is no easy way to get the widget associated with the removed cell(s) - because it is no\n        // longer in the notebook widget list! It would need to be tracked on our side, but it is not necessary\n        // as (except for a tiny memory leak) it should not impact the functionality in any way\n        if (cellsRemoved.length ||\n            cellsAdded.length ||\n            change.type === 'move' ||\n            change.type === 'remove') {\n            // in contrast to the file editor document which can be only changed by the modification of the editor content,\n            // the notebook document cna also get modified by a change in the number or arrangement of editors themselves;\n            // for this reason each change has to trigger documents update (so that LSP mirror is in sync).\n            await this.update_documents();\n        }\n        for (let cellModel of cellsRemoved) {\n            let cellWidget = this.widget.content.widgets.find(cell => cell.model.id === cellModel.id);\n            if (!cellWidget) {\n                this.console.warn(`Widget for removed cell with ID: ${cellModel.id} not found!`);\n                continue;\n            }\n            this.known_editors_ids.delete(cellWidget.editor.uuid);\n            // for practical purposes this editor got removed from our consideration;\n            // it might seem that we should instead look for the editor indicated by\n            // the oldValues[i] cellModel, but this one got already transferred to the\n            // markdown cell in newValues[i]\n            this.editorRemoved.emit({\n                editor: cellWidget.editor\n            });\n        }\n        for (let cellModel of cellsAdded) {\n            let cellWidget = this.widget.content.widgets.find(cell => cell.model.id === cellModel.id);\n            if (!cellWidget) {\n                this.console.warn(`Widget for added cell with ID: ${cellModel.id} not found!`);\n                continue;\n            }\n            this.known_editors_ids.add(cellWidget.editor.uuid);\n            this.editorAdded.emit({\n                editor: cellWidget.editor\n            });\n        }\n    }\n    get editors() {\n        if (this.isDisposed) {\n            return [];\n        }\n        let notebook = this.widget.content;\n        this.ce_editor_to_cell.clear();\n        if (notebook.isDisposed) {\n            return [];\n        }\n        return notebook.widgets\n            .filter(cell => cell.model.type === 'code')\n            .map(cell => {\n            this.ce_editor_to_cell.set(cell.editor, cell);\n            return cell.editor;\n        });\n    }\n    create_virtual_document() {\n        return new VirtualDocument({\n            language: this.language,\n            path: this.document_path,\n            overrides_registry: this.code_overrides,\n            foreign_code_extractors: this.foreign_code_extractors,\n            file_extension: this.language_file_extension,\n            // notebooks are continuous, each cell is dependent on the previous one\n            standalone: false,\n            // notebooks are not supported by LSP servers\n            has_lsp_supported_file: false,\n            console: this.console\n        });\n    }\n    get activeEditor() {\n        var _a;\n        return (_a = this.widget.content.activeCell) === null || _a === void 0 ? void 0 : _a.editor;\n    }\n    activeCellChanged(notebook, cell) {\n        if (cell.model.type !== this.type) {\n            return;\n        }\n        if (!this.known_editors_ids.has(cell.editor.uuid)) {\n            this.known_editors_ids.add(cell.editor.uuid);\n            this.editorAdded.emit({\n                editor: cell.editor\n            });\n        }\n        this.activeEditorChanged.emit({\n            editor: cell.editor\n        });\n    }\n    context_from_active_document() {\n        let cell = this.widget.content.activeCell;\n        if (cell === null) {\n            return null;\n        }\n        // short circuit if disposed\n        if (!this.virtual_editor || !this.get_context) {\n            return null;\n        }\n        if (cell.model.type !== this.type) {\n            // context will be sought on all cells to verify if the context menu should be visible,\n            // thus it is ok to just return null; it seems to stem from the implementation detail\n            // upstream, i.e. the markdown cells appear to be created by transforming the code cells\n            // but do not quote me on that.\n            return null;\n        }\n        let editor = cell.editor;\n        let ce_cursor = editor.getCursorPosition();\n        let cm_cursor = PositionConverter.ce_to_cm(ce_cursor);\n        let virtual_editor = this.virtual_editor;\n        if (virtual_editor == null) {\n            return null;\n        }\n        let root_position = virtual_editor.transform_from_editor_to_root(editor, cm_cursor);\n        if (root_position == null) {\n            this.console.warn('Could not retrieve current context', virtual_editor);\n            return null;\n        }\n        return this.get_context(root_position);\n    }\n    get_editor_index_at(position) {\n        let cell = this.get_cell_at(position);\n        let notebook = this.widget.content;\n        return notebook.widgets.findIndex(other_cell => {\n            return cell === other_cell;\n        });\n    }\n    get_editor_index(ce_editor) {\n        let cell = this.ce_editor_to_cell.get(ce_editor);\n        let notebook = this.widget.content;\n        return notebook.widgets.findIndex(other_cell => {\n            return cell === other_cell;\n        });\n    }\n    get_editor_wrapper(ce_editor) {\n        let cell = this.ce_editor_to_cell.get(ce_editor);\n        return cell.node;\n    }\n    get_cell_at(pos) {\n        let ce_editor = this.virtual_editor.virtual_document.get_editor_at_virtual_line(pos);\n        return this.ce_editor_to_cell.get(ce_editor);\n    }\n}\n//# sourceMappingURL=notebook.js.map","import { INotebookTracker } from '@jupyterlab/notebook';\nimport { ILSPAdapterManager, PLUGIN_ID } from '../../tokens';\nimport { NotebookAdapter } from './notebook';\nexport const CellContextMenuEntryPoint = 'notebook-cell-context-menu';\nexport const NOTEBOOK_ADAPTER = {\n    id: PLUGIN_ID + ':NotebookAdapter',\n    requires: [ILSPAdapterManager, INotebookTracker],\n    activate(app, adapterManager, notebookTracker) {\n        adapterManager.registerAdapterType({\n            name: 'notebook',\n            tracker: notebookTracker,\n            adapter: NotebookAdapter,\n            entrypoint: CellContextMenuEntryPoint,\n            get_id(widget) {\n                // TODO can we use id instead of content.id?\n                return widget.content.id;\n            },\n            context_menu: {\n                selector: '.jp-Notebook .jp-CodeCell .jp-Editor',\n                // position context menu entries after 10th but before 11th default entry\n                // this lets it be before \"Clear outputs\" which is the last entry of the\n                // CodeCell contextmenu and plays nicely with the first notebook entry\n                // ('Clear all outputs') thus should stay as the last one.\n                // see https://github.com/blink1073/jupyterlab/blob/3592afd328116a588e3307b4cdd9bcabc7fe92bb/packages/notebook-extension/src/index.ts#L802\n                // TODO: PR bumping rank of clear all outputs instead?\n                // adding a very small number (epsilon) places the group just after 10th entry\n                rank_group: 10 + Number.EPSILON,\n                // the group size is increased by one to account for separator,\n                // and by another one to prevent exceeding 11th rank by epsilon.\n                // TODO hardcoded space for 2 commands only!\n                rank_group_size: 2 + 2,\n                callback(manager) {\n                    manager.add_context_separator(0);\n                }\n            }\n        });\n    },\n    autoStart: true\n};\n//# sourceMappingURL=index.js.map","import { PositionError } from './positioning';\nfunction is_context_menu_over_token(adapter) {\n    let position = adapter.get_position_from_context_menu();\n    if (!position) {\n        return false;\n    }\n    let token = adapter.virtual_editor.get_token_at(position);\n    return token.value !== '';\n}\nclass LSPCommandManager {\n    constructor(options) {\n        this.add_to_palette = true;\n        this.category = 'Language Server Protocol';\n        this.adapter_manager = options.adapter_manager;\n        this.app = options.app;\n        this.palette = options.palette;\n        this.tracker = options.tracker;\n        this.suffix = options.suffix;\n        this.entry_point = options.entry_point;\n    }\n    get current_adapter() {\n        return this.adapter_manager.currentAdapter;\n    }\n    add(commands) {\n        for (let cmd of commands) {\n            let id = this.create_id(cmd);\n            this.app.commands.addCommand(id, {\n                execute: () => this.execute(cmd),\n                isEnabled: () => this.is_enabled(cmd),\n                isVisible: () => this.is_visible(cmd),\n                label: cmd.label,\n                icon: cmd.icon\n            });\n            if (this.should_attach(cmd)) {\n                this.attach_command(cmd);\n            }\n            if (this.add_to_palette) {\n                this.palette.addItem({ command: id, category: this.category });\n            }\n        }\n    }\n    should_attach(command) {\n        if (command.attach_to == null) {\n            return true;\n        }\n        return command.attach_to.has(this.entry_point);\n    }\n    create_id(command) {\n        return 'lsp:' + command.id + '-' + this.suffix;\n    }\n}\n/**\n * Contextual commands, with the context retrieved from the ContextMenu\n * position (if open) or from the cursor in the current widget.\n */\nexport class ContextCommandManager extends LSPCommandManager {\n    constructor(options) {\n        super(options);\n        this.selector = options.selector;\n        this.entry_point = options.entry_point;\n        this.rank_group = options.rank_group;\n        this.rank_group_size = options.rank_group_size;\n        this.console = options.console;\n        if (options.callback) {\n            options.callback(this);\n        }\n    }\n    attach_command(command) {\n        this.app.contextMenu.addItem({\n            selector: this.selector,\n            command: this.create_id(command),\n            rank: this.get_rank(command)\n        });\n    }\n    add_context_separator(position_in_group) {\n        var _a;\n        this.app.contextMenu.addItem({\n            type: 'separator',\n            selector: this.selector,\n            rank: ((_a = this.rank_group) !== null && _a !== void 0 ? _a : 0) + position_in_group\n        });\n    }\n    execute(command) {\n        let context = this.get_context();\n        if (context) {\n            command.execute(context);\n        }\n    }\n    get is_context_menu_open() {\n        return this.app.contextMenu.menu.isAttached;\n    }\n    get is_widget_current() {\n        // is the current widget of given type (notebook/editor)\n        // also the currently used widget in the entire app?\n        return (this.tracker.currentWidget != null &&\n            this.tracker.currentWidget === this.app.shell.currentWidget);\n    }\n    is_enabled() {\n        if (this.is_context_menu_open) {\n            return is_context_menu_over_token(this.current_adapter);\n        }\n        else {\n            return this.is_widget_current;\n        }\n    }\n    get_context() {\n        var _a;\n        let context = null;\n        if (this.is_context_menu_open) {\n            try {\n                context = this.current_adapter.get_context_from_context_menu();\n            }\n            catch (e) {\n                this.console.warn('contextMenu is attached, but could not get the context', e);\n                context = null;\n            }\n        }\n        if (context == null) {\n            try {\n                context = (_a = this.current_adapter) === null || _a === void 0 ? void 0 : _a.context_from_active_document();\n            }\n            catch (e) {\n                if (e instanceof PositionError) {\n                    this.console.log('Could not get context from active document: it is expected when restoring workspace with open files');\n                }\n                else {\n                    throw e;\n                }\n            }\n        }\n        return context;\n    }\n    is_visible(command) {\n        try {\n            let context = this.get_context();\n            return (context != null &&\n                this.current_adapter &&\n                context.connection != null &&\n                context.connection.isReady &&\n                command.is_enabled(context));\n        }\n        catch (e) {\n            this.console.warn('is_visible failed', e);\n            return false;\n        }\n    }\n    get_rank(command) {\n        let is_relative = typeof command.is_rank_relative === 'undefined'\n            ? true\n            : command.is_rank_relative;\n        if (is_relative &&\n            typeof this.rank_group !== 'undefined' &&\n            this.rank_group_size) {\n            let relative = typeof command.rank !== 'undefined' ? command.rank : 0;\n            return this.rank_group + relative / this.rank_group_size;\n        }\n        else {\n            return command.rank != null ? command.rank : Infinity;\n        }\n    }\n}\n//# sourceMappingURL=command_manager.js.map","import api from \"!../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../css-loader/dist/cjs.js!./statusbar.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import React from 'react';\nfunction external_link(url, label) {\n    return (React.createElement(\"a\", { href: url, target: \"_blank\", rel: \"noopener noreferrer\", className: \"lsp-external-link\" }, label));\n}\nconst migration_guide_url = 'https://jupyter-server.readthedocs.io/en/latest/operators/migrate-from-nbserver.html';\nconst jupyter_hub_migration_url = 'https://github.com/jupyterhub/jupyterhub/pull/3329/files';\nexport const SERVER_EXTENSION_404 = (React.createElement(\"div\", null,\n    React.createElement(\"p\", null,\n        \"It appears that the required Jupyter server extension (\",\n        React.createElement(\"code\", null, \"jupyter-lsp\"),\n        \") is not installed (or not enabled) in this environment.\"),\n    React.createElement(\"h3\", null, \"What are the likely reasons?\"),\n    React.createElement(\"ul\", null,\n        React.createElement(\"li\", null, \"It might be that you just installed it and need to restart JupyterLab to make it available on startup.\"),\n        React.createElement(\"li\", null,\n            \"Alternatively, you may be using an older \",\n            React.createElement(\"code\", null, \"notebook\"),\n            \" server instead of the new \",\n            React.createElement(\"code\", null, \"jupyter_server\"),\n            \"; please refer to the\",\n            ' ',\n            external_link(migration_guide_url, 'migration guide'),\n            \" or if you are a JupyterHub user please ensure that you start the JupyterLab using\",\n            ' ',\n            React.createElement(\"code\", null, \"jupyter_server\"),\n            \" and not the old \",\n            React.createElement(\"code\", null, \"notebook\"),\n            \", as documented in\",\n            ' ',\n            external_link(jupyter_hub_migration_url, 'this pull request'),\n            \".\"),\n        React.createElement(\"li\", null,\n            \"There may be schema errors or language server errors preventing the extension from loading - please check the logs of JupyterLab (in the console where you execute \",\n            React.createElement(\"code\", null, \"jupyter lab\"))),\n    React.createElement(\"h3\", null, \"How do I check if the extension is installed?\"),\n    React.createElement(\"p\", null,\n        \"Please ensure that \",\n        React.createElement(\"code\", null, \"jupyter server extension list\"),\n        \" includes jupyter-lsp and that it is enabled. If it is enabled please try to restart JupyterLab. If the server extension is installed but not enabled and all other suggestions listed above failed try the following:\",\n        React.createElement(\"code\", null, \"jupyter server extension enable --user --py jupyter_lsp\"))));\n//# sourceMappingURL=errors.js.map","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n    <path d=\\\"M6.59,3.41L2,8L6.59,12.6L8,11.18L4.82,8L8,4.82L6.59,3.41M12.41,3.41L11,4.82L14.18,8L11,11.18L12.41,12.6L17,8L12.41,3.41M21.59,11.59L13.5,19.68L9.83,16L8.42,17.41L13.5,22.5L23,13L21.59,11.59Z\\\" />\\n  </g>\\n</svg>\\n\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n    <path d=\\\"M6.59 3.41L2 8l4.59 4.6L8 11.18 4.82 8 8 4.82 6.59 3.41m5.82 0L11 4.82 14.18 8 11 11.18l1.41 1.42L17 8l-4.59-4.59M18.093 21.608a3.998 3.998 0 004.015-4.015 3.998 3.998 0 00-4.015-4.016 3.998 3.998 0 00-4.016 4.016 3.998 3.998 0 004.016 4.015m0-8.923c2.676 0 4.907 2.23 4.907 4.908 0 2.676-2.23 4.907-4.907 4.907s-4.908-2.23-4.908-4.907 2.23-4.908 4.908-4.908m2.498 5.89l-.348.624-2.588-1.428v-2.632h.75v2.141z\\\" />\\n  </g>\\n</svg>\\n\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n    <path d=\\\"M6.59 3.41L2 8l4.59 4.6L8 11.18 4.82 8 8 4.82 6.59 3.41m5.82 0L11 4.82 14.18 8 11 11.18l1.41 1.42L17 8l-4.59-4.59M16.95 12.05L10.9 22.5H23m-6.05-8.25l4.141 7.15h-8.283m3.592-4.95v2.2h1.1v-2.2m-1.1 3.3v1.1h1.1v-1.1\\\"/>\\n  </g>\\n</svg>\\n\";","import { LabIcon } from '@jupyterlab/ui-components';\nimport codeCheckSvg from '../../style/icons/code-check.svg';\nimport codeClock from '../../style/icons/code-clock.svg';\nimport codeWarning from '../../style/icons/code-warning.svg';\nexport const codeWarningIcon = new LabIcon({\n    name: 'lsp:codeWarning',\n    svgstr: codeWarning\n});\nexport const codeClockIcon = new LabIcon({\n    name: 'lsp:codeClock',\n    svgstr: codeClock\n});\nexport const codeCheckIcon = new LabIcon({\n    name: 'lsp:codeCheck',\n    svgstr: codeCheckSvg\n});\n//# sourceMappingURL=icons.js.map","import { nullTranslator } from '@jupyterlab/translation';\nimport React from 'react';\nexport function getBreadcrumbs(document, adapter, trans, collapse = true) {\n    if (!trans) {\n        trans = nullTranslator.load('');\n    }\n    return document.ancestry.map((document) => {\n        if (!document.parent) {\n            let path = document.path;\n            if (!document.has_lsp_supported_file &&\n                document.file_extension &&\n                path.endsWith(document.file_extension)) {\n                path = path.slice(0, -document.file_extension.length - 1);\n            }\n            const full_path = path;\n            if (collapse) {\n                let parts = path.split('/');\n                if (parts.length > 2) {\n                    path = parts[0] + '/.../' + parts[parts.length - 1];\n                }\n            }\n            return (React.createElement(\"span\", { key: document.uri, title: full_path }, path));\n        }\n        if (!document.virtual_lines.size) {\n            return React.createElement(\"span\", { key: document.uri }, \"Empty document\");\n        }\n        try {\n            if (adapter.has_multiple_editors) {\n                let first_line = document.virtual_lines.get(0);\n                let last_line = document.virtual_lines.get(document.last_virtual_line - 1);\n                let first_cell = adapter.get_editor_index(first_line.editor);\n                let last_cell = adapter.get_editor_index(last_line.editor);\n                let cell_locator = first_cell === last_cell\n                    ? trans.__('cell %1', first_cell + 1)\n                    : trans.__('cells: %1-%2', first_cell + 1, last_cell + 1);\n                return (React.createElement(\"span\", { key: document.uri },\n                    document.language,\n                    \" (\",\n                    cell_locator,\n                    \")\"));\n            }\n        }\n        catch (e) {\n            console.warn('LSP: could not display document cell location', e);\n        }\n        return React.createElement(\"span\", { key: document.uri }, document.language);\n    });\n}\n/**\n * @deprecated please use getBreadcrumbs instead; `get_breadcrumbs` will be removed in 4.0\n */\nexport function get_breadcrumbs(document, adapter, collapse = true) {\n    return getBreadcrumbs(document, adapter, undefined, collapse);\n}\nexport function focus_on(node) {\n    if (!node) {\n        return;\n    }\n    node.scrollIntoView();\n    node.focus();\n}\nexport function DocumentLocator(props) {\n    let { document, adapter } = props;\n    let target = null;\n    if (adapter.has_multiple_editors) {\n        let first_line = document.virtual_lines.get(0);\n        if (first_line) {\n            target = adapter.get_editor_wrapper(first_line.editor);\n        }\n        else {\n            console.warn('Could not get first line of ', document);\n        }\n    }\n    let breadcrumbs = getBreadcrumbs(document, adapter, props.trans);\n    return (React.createElement(\"div\", { className: 'lsp-document-locator', onClick: () => (target ? focus_on(target) : null) }, breadcrumbs));\n}\n//# sourceMappingURL=utils.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n// Based on the @jupyterlab/codemirror-extension statusbar\nimport { VDomModel, VDomRenderer, Dialog, showDialog } from '@jupyterlab/apputils';\nimport { GroupItem, TextItem, interactiveItem, showPopup } from '@jupyterlab/statusbar';\nimport { caretDownIcon, caretUpIcon, circleEmptyIcon, circleIcon, stopIcon } from '@jupyterlab/ui-components';\nimport React from 'react';\nimport '../../style/statusbar.css';\nimport { SERVER_EXTENSION_404 } from '../errors';\nimport { collect_documents } from '../virtual/document';\nimport { codeCheckIcon, codeClockIcon, codeWarningIcon } from './icons';\nimport { DocumentLocator } from './utils';\nvar okButton = Dialog.okButton;\nfunction ServerStatus(props) {\n    let list = props.server.spec.languages.map((language, i) => (React.createElement(\"li\", { key: i }, language)));\n    return (React.createElement(\"div\", { className: 'lsp-server-status' },\n        React.createElement(\"h5\", null, props.server.spec.display_name),\n        React.createElement(\"ul\", null, list)));\n}\nclass CollapsibleList extends React.Component {\n    constructor(props) {\n        super(props);\n        this.handleClick = () => {\n            this.setState(state => ({\n                isCollapsed: !state.isCollapsed\n            }));\n        };\n        this.state = { isCollapsed: props.startCollapsed || false };\n    }\n    render() {\n        const collapseExpandIcon = !this.state.isCollapsed\n            ? caretUpIcon\n            : caretDownIcon;\n        return (React.createElement(\"div\", { className: 'lsp-collapsible-list ' +\n                (this.state.isCollapsed ? 'lsp-collapsed' : '') },\n            React.createElement(\"h4\", { onClick: this.handleClick },\n                React.createElement(collapseExpandIcon.react, { tag: \"span\", className: \"lsp-caret-icon\" }),\n                this.props.title,\n                \": \",\n                this.props.list.length),\n            React.createElement(\"div\", null, this.props.list)));\n    }\n}\nclass LanguageServerInfo extends React.Component {\n    render() {\n        const specification = this.props.specs;\n        const trans = this.props.trans;\n        return (React.createElement(\"div\", null,\n            React.createElement(\"h3\", null, specification.display_name),\n            React.createElement(\"div\", null,\n                React.createElement(\"ul\", { className: 'lsp-server-links-list' }, Object.entries((specification === null || specification === void 0 ? void 0 : specification.urls) || {}).map(([name, url]) => (React.createElement(\"li\", { key: this.props.serverId + '-url-' + name },\n                    name,\n                    \":\",\n                    ' ',\n                    React.createElement(\"a\", { href: url, target: \"_blank\", rel: \"noreferrer\" }, url))))),\n                React.createElement(\"h4\", null, trans.__('Troubleshooting')),\n                React.createElement(\"p\", { className: 'lsp-troubleshoot-section' }, specification.troubleshoot\n                    ? specification.troubleshoot\n                    : trans.__('In case of issues with installation feel welcome to ask a question on GitHub.')),\n                React.createElement(\"h4\", null, trans.__('Installation')),\n                React.createElement(\"ul\", null, (specification === null || specification === void 0 ? void 0 : specification.install) ? Object.entries((specification === null || specification === void 0 ? void 0 : specification.install) || {}).map(([name, command]) => (React.createElement(\"li\", { key: this.props.serverId + '-install-' + name },\n                    name,\n                    \": \",\n                    React.createElement(\"code\", null, command))))\n                    : trans.__('No installation instructions were provided with this specification.')))));\n    }\n}\nclass HelpButton extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.handleClick = () => {\n            const trans = this.props.trans;\n            showDialog({\n                title: trans.__('No language server for %1 detected', this.props.language),\n                body: (React.createElement(\"div\", null, this.props.servers.size ? (React.createElement(\"div\", null,\n                    React.createElement(\"p\", null, trans._n('There is %1 language server you can easily install that supports %2.', 'There are %1 language servers you can easily install that supports %2.', this.props.servers.size, this.props.language)),\n                    [...this.props.servers.entries()].map(([key, specification]) => (React.createElement(LanguageServerInfo, { specs: specification, serverId: key, key: key, trans: trans }))))) : (React.createElement(\"div\", null,\n                    React.createElement(\"p\", null, trans.__('We do not have an auto-detection ready for a language servers supporting %1 yet.', this.props.language)),\n                    React.createElement(\"p\", null,\n                        trans.__('You may contribute a specification for auto-detection as described in our '),\n                        ' ',\n                        React.createElement(\"a\", { href: 'https://jupyterlab-lsp.readthedocs.io/en/latest/Contributing.html#specs' }, trans.__('documentation'))))))),\n                buttons: [okButton()]\n            }).catch(console.warn);\n        };\n    }\n    render() {\n        return (React.createElement(\"button\", { type: 'button', className: 'jp-Button lsp-help-button', onClick: this.handleClick }, \"?\"));\n    }\n}\nclass LSPPopup extends VDomRenderer {\n    constructor(model) {\n        super(model);\n        this.addClass('lsp-popover');\n    }\n    render() {\n        var _a;\n        if (!((_a = this.model) === null || _a === void 0 ? void 0 : _a.connection_manager)) {\n            return null;\n        }\n        const servers_available = this.model.servers_available_not_in_use.map((session, i) => React.createElement(ServerStatus, { key: i, server: session }));\n        let running_servers = new Array();\n        let key = -1;\n        for (let [session, documents_by_language] of this.model.documents_by_server.entries()) {\n            key += 1;\n            let documents_html = new Array();\n            for (let [language, documents] of documents_by_language) {\n                // TODO: stop button\n                // TODO: add a config buttons next to the language header\n                let list = documents.map((document, i) => {\n                    let connection = this.model.connection_manager.connections.get(document.uri);\n                    let status = '';\n                    if (connection === null || connection === void 0 ? void 0 : connection.isInitialized) {\n                        status = 'initialized';\n                    }\n                    else if (connection === null || connection === void 0 ? void 0 : connection.isConnected) {\n                        status = 'connected';\n                    }\n                    else {\n                        status = 'not connected';\n                    }\n                    const icon = status === 'initialized' ? circleIcon : circleEmptyIcon;\n                    return (React.createElement(\"li\", { key: i },\n                        React.createElement(DocumentLocator, { document: document, adapter: this.model.adapter }),\n                        React.createElement(\"span\", { className: 'lsp-document-status' },\n                            this.model.trans.__(status),\n                            React.createElement(icon.react, { tag: \"span\", className: \"lsp-document-status-icon\", elementSize: 'small' }))));\n                });\n                documents_html.push(React.createElement(\"div\", { key: key, className: 'lsp-documents-by-language' },\n                    React.createElement(\"h5\", null,\n                        language,\n                        ' ',\n                        React.createElement(\"span\", { className: 'lsp-language-server-name' },\n                            \"(\",\n                            session.spec.display_name,\n                            \")\")),\n                    React.createElement(\"ul\", null, list)));\n            }\n            running_servers.push(React.createElement(\"div\", { key: key }, documents_html));\n        }\n        const missing_languages = this.model.missing_languages.map((language, i) => {\n            const specs_for_missing = this.model.language_server_manager.getMatchingSpecs({ language });\n            return (React.createElement(\"div\", { key: i, className: 'lsp-missing-server' },\n                language,\n                specs_for_missing.size ? (React.createElement(HelpButton, { language: language, servers: specs_for_missing, trans: this.model.trans })) : ('')));\n        });\n        const trans = this.model.trans;\n        return (React.createElement(\"div\", { className: 'lsp-popover-content' },\n            React.createElement(\"div\", { className: 'lsp-servers-menu' },\n                React.createElement(\"h3\", { className: 'lsp-servers-title' }, trans.__('LSP servers')),\n                React.createElement(\"div\", { className: 'lsp-servers-lists' },\n                    servers_available.length ? (React.createElement(CollapsibleList, { key: 'available', title: trans.__('Available'), list: servers_available, startCollapsed: true })) : (''),\n                    running_servers.length ? (React.createElement(CollapsibleList, { key: 'running', title: trans.__('Running'), list: running_servers })) : (''),\n                    missing_languages.length ? (React.createElement(CollapsibleList, { key: 'missing', title: trans.__('Missing'), list: missing_languages })) : (''))),\n            React.createElement(\"div\", { className: 'lsp-popover-status' },\n                trans.__('Documentation:'),\n                ' ',\n                React.createElement(\"a\", { href: 'https://jupyterlab-lsp.readthedocs.io/en/latest/Language%20Servers.html', target: \"_blank\", rel: \"noreferrer\" }, trans.__('Language Servers')))));\n    }\n}\nconst SELECTED_CLASS = 'jp-mod-selected';\n/**\n * StatusBar item.\n */\nexport class LSPStatus extends VDomRenderer {\n    /**\n     * Construct a new VDomRenderer for the status item.\n     */\n    constructor(widget_manager, displayText = true, trans) {\n        super(new LSPStatus.Model(widget_manager, trans));\n        this.displayText = displayText;\n        this._popup = null;\n        this.handleClick = () => {\n            if (this._popup) {\n                this._popup.dispose();\n            }\n            if (this.model.status.status == 'no_server_extension') {\n                showDialog({\n                    title: this.trans.__('LSP server extension not found'),\n                    body: SERVER_EXTENSION_404,\n                    buttons: [okButton()]\n                }).catch(console.warn);\n            }\n            else {\n                this._popup = showPopup({\n                    body: new LSPPopup(this.model),\n                    anchor: this,\n                    align: 'left'\n                });\n            }\n        };\n        this.addClass(interactiveItem);\n        this.addClass('lsp-statusbar-item');\n        this.trans = trans;\n        this.title.caption = this.trans.__('LSP status');\n        // add human-readable (and stable) class name reflecting otherwise obfuscated typestyle interactiveItem\n        this.interactiveStateObserver = new MutationObserver(() => {\n            const has_selected = this.node.classList.contains(SELECTED_CLASS);\n            if (!this.node.classList.contains(interactiveItem)) {\n                if (!has_selected) {\n                    this.addClass(SELECTED_CLASS);\n                }\n            }\n            else {\n                if (has_selected) {\n                    this.removeClass(SELECTED_CLASS);\n                }\n            }\n        });\n    }\n    onAfterAttach(msg) {\n        super.onAfterAttach(msg);\n        this.interactiveStateObserver.observe(this.node, {\n            attributes: true,\n            attributeFilter: ['class']\n        });\n    }\n    onBeforeDetach(msg) {\n        super.onBeforeDetach(msg);\n        this.interactiveStateObserver.disconnect();\n    }\n    /**\n     * Render the status item.\n     */\n    render() {\n        const { model } = this;\n        if (model == null) {\n            return null;\n        }\n        return (React.createElement(GroupItem, { spacing: this.displayText ? 2 : 0, title: model.long_message, onClick: this.handleClick, className: 'lsp-status-group' },\n            React.createElement(model.status_icon.react, { top: '2px', kind: 'statusBar', title: this.trans.__('LSP Code Intelligence') }),\n            this.displayText ? (React.createElement(TextItem, { className: 'lsp-status-message', source: model.short_message })) : (React.createElement(React.Fragment, null)),\n            React.createElement(TextItem, { source: model.feature_message })));\n    }\n}\nexport class StatusButtonExtension {\n    constructor(options) {\n        this.options = options;\n    }\n    /**\n     * For statusbar registration and for internal use.\n     */\n    createItem(displayText = true) {\n        const status_bar_item = new LSPStatus(this.options.adapter_manager, displayText, this.options.translator_bundle);\n        status_bar_item.model.language_server_manager =\n            this.options.language_server_manager;\n        status_bar_item.model.connection_manager = this.options.connection_manager;\n        return status_bar_item;\n    }\n    /**\n     * For registration on notebook panels.\n     */\n    createNew(panel, context) {\n        const item = this.createItem(false);\n        item.addClass('jp-ToolbarButton');\n        panel.toolbar.insertAfter('spacer', 'LSPStatus', item);\n        return item;\n    }\n}\nfunction collect_languages(virtual_document) {\n    let documents = collect_documents(virtual_document);\n    return new Set([...documents].map(document => document.language.toLocaleLowerCase()));\n}\nconst classByStatus = {\n    no_server_extension: 'error',\n    waiting: 'inactive',\n    initialized: 'ready',\n    initializing: 'preparing',\n    initialized_but_some_missing: 'ready',\n    connecting: 'preparing'\n};\nconst iconByStatus = {\n    no_server_extension: codeWarningIcon,\n    waiting: codeClockIcon,\n    initialized: codeCheckIcon,\n    initializing: codeClockIcon,\n    initialized_but_some_missing: codeWarningIcon,\n    connecting: codeClockIcon\n};\nconst shortMessageByStatus = {\n    no_server_extension: 'Server extension missing',\n    waiting: 'Waiting...',\n    initialized: 'Fully initialized',\n    initialized_but_some_missing: 'Initialized (additional servers needed)',\n    initializing: 'Initializing...',\n    connecting: 'Connecting...'\n};\n(function (LSPStatus) {\n    /**\n     * A VDomModel for the LSP of current file editor/notebook.\n     */\n    class Model extends VDomModel {\n        constructor(widget_adapter_manager, trans) {\n            super();\n            this.server_extension_status = null;\n            this._onChange = () => {\n                this.stateChanged.emit(void 0);\n            };\n            this._adapter = null;\n            this.trans = trans;\n            widget_adapter_manager.adapterChanged.connect((manager, adapter) => {\n                this.change_adapter(adapter);\n            }, this);\n            widget_adapter_manager.adapterDisposed.connect((manager, adapter) => {\n                if (this.adapter === adapter) {\n                    this.change_adapter(null);\n                }\n            }, this);\n        }\n        get available_servers() {\n            return this.language_server_manager.sessions;\n        }\n        get supported_languages() {\n            const languages = new Set();\n            for (let server of this.available_servers.values()) {\n                for (let language of server.spec.languages) {\n                    languages.add(language.toLocaleLowerCase());\n                }\n            }\n            return languages;\n        }\n        is_server_running(id, server) {\n            for (const language of this.detected_languages) {\n                const matchedServers = this.language_server_manager.getMatchingServers({\n                    language\n                });\n                // TODO server.status === \"started\" ?\n                // TODO update once multiple servers are allowed\n                if (matchedServers.length && matchedServers[0] === id) {\n                    return true;\n                }\n            }\n            return false;\n        }\n        get documents_by_server() {\n            var _a;\n            let data = new Map();\n            if (!((_a = this.adapter) === null || _a === void 0 ? void 0 : _a.virtual_editor)) {\n                return data;\n            }\n            let main_document = this.adapter.virtual_editor.virtual_document;\n            let documents = collect_documents(main_document);\n            for (let document of documents.values()) {\n                let language = document.language.toLocaleLowerCase();\n                let server_ids = this._connection_manager.language_server_manager.getMatchingServers({\n                    language: document.language\n                });\n                if (server_ids.length === 0) {\n                    continue;\n                }\n                // For now only use the server with the highest priority\n                let server = this.language_server_manager.sessions.get(server_ids[0]);\n                if (!data.has(server)) {\n                    data.set(server, new Map());\n                }\n                let documents_map = data.get(server);\n                if (!documents_map.has(language)) {\n                    documents_map.set(language, new Array());\n                }\n                let documents = documents_map.get(language);\n                documents.push(document);\n            }\n            return data;\n        }\n        get servers_available_not_in_use() {\n            return [...this.available_servers.entries()]\n                .filter(([id, server]) => !this.is_server_running(id, server))\n                .map(([id, server]) => server);\n        }\n        get detected_languages() {\n            var _a;\n            if (!((_a = this.adapter) === null || _a === void 0 ? void 0 : _a.virtual_editor)) {\n                return new Set();\n            }\n            let document = this.adapter.virtual_editor.virtual_document;\n            return collect_languages(document);\n        }\n        get missing_languages() {\n            // TODO: false negative for r vs R?\n            return [...this.detected_languages].filter(language => !this.supported_languages.has(language.toLocaleLowerCase()));\n        }\n        get status() {\n            var _a;\n            let detected_documents;\n            if (!((_a = this.adapter) === null || _a === void 0 ? void 0 : _a.virtual_editor)) {\n                detected_documents = new Map();\n            }\n            else {\n                let main_document = this.adapter.virtual_editor.virtual_document;\n                const all_documents = this._connection_manager.documents;\n                // detected documents that are open in the current virtual editor\n                const detected_documents_set = collect_documents(main_document);\n                detected_documents = new Map([...all_documents].filter(([id, doc]) => detected_documents_set.has(doc)));\n            }\n            let connected_documents = new Set();\n            let initialized_documents = new Set();\n            let absent_documents = new Set();\n            // detected documents with LSP servers available\n            let documents_with_available_servers = new Set();\n            // detected documents with LSP servers known\n            let documents_with_known_servers = new Set();\n            detected_documents.forEach((document, uri) => {\n                let connection = this._connection_manager.connections.get(uri);\n                let server_ids = this._connection_manager.language_server_manager.getMatchingServers({\n                    language: document.language\n                });\n                if (server_ids.length !== 0) {\n                    documents_with_known_servers.add(document);\n                }\n                if (!connection) {\n                    absent_documents.add(document);\n                    return;\n                }\n                else {\n                    documents_with_available_servers.add(document);\n                }\n                if (connection.isConnected) {\n                    connected_documents.add(document);\n                }\n                if (connection.isInitialized) {\n                    initialized_documents.add(document);\n                }\n            });\n            // there may be more open connections than documents if a document was recently closed\n            // and the grace period has not passed yet\n            let open_connections = new Array();\n            this._connection_manager.connections.forEach((connection, path) => {\n                if (connection.isConnected) {\n                    open_connections.push(connection);\n                }\n            });\n            let status;\n            if (this.language_server_manager.statusCode === 404) {\n                status = 'no_server_extension';\n            }\n            else if (detected_documents.size === 0) {\n                status = 'waiting';\n            }\n            else if (initialized_documents.size === detected_documents.size) {\n                status = 'initialized';\n            }\n            else if (initialized_documents.size === documents_with_available_servers.size &&\n                detected_documents.size > documents_with_known_servers.size) {\n                status = 'initialized_but_some_missing';\n            }\n            else if (connected_documents.size === documents_with_available_servers.size) {\n                status = 'initializing';\n            }\n            else {\n                status = 'connecting';\n            }\n            return {\n                open_connections,\n                connected_documents,\n                initialized_documents,\n                detected_documents: new Set([...detected_documents.values()]),\n                status\n            };\n        }\n        get status_icon() {\n            if (!this.adapter) {\n                return stopIcon;\n            }\n            return iconByStatus[this.status.status].bindprops({\n                className: 'lsp-status-icon ' + classByStatus[this.status.status]\n            });\n        }\n        get short_message() {\n            if (!this.adapter) {\n                return this.trans.__('not initialized');\n            }\n            return this.trans.__(shortMessageByStatus[this.status.status]);\n        }\n        get feature_message() {\n            var _a, _b;\n            return ((_b = (_a = this.adapter) === null || _a === void 0 ? void 0 : _a.status_message) === null || _b === void 0 ? void 0 : _b.message) || '';\n        }\n        get long_message() {\n            if (!this.adapter) {\n                return this.trans.__('not initialized');\n            }\n            let status = this.status;\n            let msg = '';\n            if (status.status === 'waiting') {\n                msg = this.trans.__('Waiting for documents initialization...');\n            }\n            else if (status.status === 'initialized') {\n                msg = this.trans._n('Fully connected & initialized (%2 virtual document)', 'Fully connected & initialized (%2 virtual document)', status.detected_documents.size, status.detected_documents.size);\n            }\n            else if (status.status === 'initializing') {\n                const uninitialized = new Set(status.detected_documents);\n                for (let initialized of status.initialized_documents.values()) {\n                    uninitialized.delete(initialized);\n                }\n                // servers for n documents did not respond to the initialization request\n                msg = this.trans._np('pluralized', 'Fully connected, but %2/%3 virtual document stuck uninitialized: %4', 'Fully connected, but %2/%3 virtual documents stuck uninitialized: %4', status.detected_documents.size, uninitialized.size, status.detected_documents.size, [...uninitialized].map(document => document.id_path).join(', '));\n            }\n            else {\n                const unconnected = new Set(status.detected_documents);\n                for (let connected of status.connected_documents.values()) {\n                    unconnected.delete(connected);\n                }\n                msg = this.trans._np('pluralized', '%2/%3 virtual document connected (%4 connections; waiting for: %5)', '%2/%3 virtual documents connected (%4 connections; waiting for: %5)', status.detected_documents.size, status.connected_documents.size, status.detected_documents.size, status.open_connections.length, [...unconnected].map(document => document.id_path).join(', '));\n            }\n            return msg;\n        }\n        get adapter() {\n            return this._adapter;\n        }\n        change_adapter(adapter) {\n            if (this._adapter != null) {\n                this._adapter.status_message.changed.disconnect(this._onChange);\n            }\n            if (adapter != null) {\n                adapter.status_message.changed.connect(this._onChange);\n            }\n            this._adapter = adapter;\n        }\n        get connection_manager() {\n            return this._connection_manager;\n        }\n        /**\n         * Note: it is ever only set once, as connection_manager is a singleton.\n         */\n        set connection_manager(connection_manager) {\n            if (this._connection_manager != null) {\n                this._connection_manager.connected.disconnect(this._onChange);\n                this._connection_manager.initialized.connect(this._onChange);\n                this._connection_manager.disconnected.disconnect(this._onChange);\n                this._connection_manager.closed.disconnect(this._onChange);\n                this._connection_manager.documents_changed.disconnect(this._onChange);\n            }\n            if (connection_manager != null) {\n                connection_manager.connected.connect(this._onChange);\n                connection_manager.initialized.connect(this._onChange);\n                connection_manager.disconnected.connect(this._onChange);\n                connection_manager.closed.connect(this._onChange);\n                connection_manager.documents_changed.connect(this._onChange);\n            }\n            this._connection_manager = connection_manager;\n        }\n    }\n    LSPStatus.Model = Model;\n})(LSPStatus || (LSPStatus = {}));\n//# sourceMappingURL=statusbar.js.map","import { ILSPCodeExtractorsManager } from '../tokens';\nexport class CodeExtractorsManager {\n    constructor() {\n        this.registry = {};\n    }\n    /**\n     * Register an extractor to extract foreign code from host documents of specified language.\n     */\n    register(extractor, host_language) {\n        if (!this.registry.hasOwnProperty(host_language)) {\n            this.registry[host_language] = [];\n        }\n        this.registry[host_language].push(extractor);\n    }\n}\nexport const CODE_EXTRACTORS_MANAGER = {\n    id: ILSPCodeExtractorsManager.name,\n    requires: [],\n    activate: app => {\n        return new CodeExtractorsManager();\n    },\n    provides: ILSPCodeExtractorsManager,\n    autoStart: true\n};\n//# sourceMappingURL=manager.js.map","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n     <path d=\\\"M5,9.5L7.5,14H2.5L5,9.5M3,4H7V8H3V4M5,20A2,2 0 0,0 7,18A2,2 0 0,0 5,16A2,2 0 0,0 3,18A2,2 0 0,0 5,20M9,5V7H21V5H9M9,19H21V17H9V19M9,13H21V11H9V13Z\\\" />\\n  </g>\\n</svg>\\n\";","import { Signal } from '@lumino/signaling';\nexport class FeatureSettings {\n    constructor(settingRegistry, featureID) {\n        this.settingRegistry = settingRegistry;\n        this.changed = new Signal(this);\n        if (!(featureID in settingRegistry.plugins)) {\n            console.warn(`${featureID} settings schema could not be found and was not loaded`);\n        }\n        else {\n            this.ready = new Promise(accept => {\n                settingRegistry\n                    .load(featureID)\n                    .then(settings => {\n                    this.settings = settings;\n                    accept();\n                    this.changed.emit();\n                    settings.changed.connect(() => {\n                        this.settings = settings;\n                        this.changed.emit();\n                    });\n                })\n                    .catch(console.warn);\n            });\n        }\n    }\n    get composite() {\n        return this.settings.composite;\n    }\n    set(setting, value) {\n        this.settings.set(setting, value).catch(console.warn);\n    }\n}\n//# sourceMappingURL=feature.js.map","export var DiagnosticSeverity;\n(function (DiagnosticSeverity) {\n    DiagnosticSeverity[DiagnosticSeverity[\"Error\"] = 1] = \"Error\";\n    DiagnosticSeverity[DiagnosticSeverity[\"Warning\"] = 2] = \"Warning\";\n    DiagnosticSeverity[DiagnosticSeverity[\"Information\"] = 3] = \"Information\";\n    DiagnosticSeverity[DiagnosticSeverity[\"Hint\"] = 4] = \"Hint\";\n})(DiagnosticSeverity || (DiagnosticSeverity = {}));\nexport var DiagnosticTag;\n(function (DiagnosticTag) {\n    DiagnosticTag[DiagnosticTag[\"Unnecessary\"] = 1] = \"Unnecessary\";\n    DiagnosticTag[DiagnosticTag[\"Deprecated\"] = 2] = \"Deprecated\";\n})(DiagnosticTag || (DiagnosticTag = {}));\nexport var CompletionItemTag;\n(function (CompletionItemTag) {\n    CompletionItemTag[CompletionItemTag[\"Deprecated\"] = 1] = \"Deprecated\";\n})(CompletionItemTag || (CompletionItemTag = {}));\nexport var CompletionItemKind;\n(function (CompletionItemKind) {\n    CompletionItemKind[CompletionItemKind[\"Text\"] = 1] = \"Text\";\n    CompletionItemKind[CompletionItemKind[\"Method\"] = 2] = \"Method\";\n    CompletionItemKind[CompletionItemKind[\"Function\"] = 3] = \"Function\";\n    CompletionItemKind[CompletionItemKind[\"Constructor\"] = 4] = \"Constructor\";\n    CompletionItemKind[CompletionItemKind[\"Field\"] = 5] = \"Field\";\n    CompletionItemKind[CompletionItemKind[\"Variable\"] = 6] = \"Variable\";\n    CompletionItemKind[CompletionItemKind[\"Class\"] = 7] = \"Class\";\n    CompletionItemKind[CompletionItemKind[\"Interface\"] = 8] = \"Interface\";\n    CompletionItemKind[CompletionItemKind[\"Module\"] = 9] = \"Module\";\n    CompletionItemKind[CompletionItemKind[\"Property\"] = 10] = \"Property\";\n    CompletionItemKind[CompletionItemKind[\"Unit\"] = 11] = \"Unit\";\n    CompletionItemKind[CompletionItemKind[\"Value\"] = 12] = \"Value\";\n    CompletionItemKind[CompletionItemKind[\"Enum\"] = 13] = \"Enum\";\n    CompletionItemKind[CompletionItemKind[\"Keyword\"] = 14] = \"Keyword\";\n    CompletionItemKind[CompletionItemKind[\"Snippet\"] = 15] = \"Snippet\";\n    CompletionItemKind[CompletionItemKind[\"Color\"] = 16] = \"Color\";\n    CompletionItemKind[CompletionItemKind[\"File\"] = 17] = \"File\";\n    CompletionItemKind[CompletionItemKind[\"Reference\"] = 18] = \"Reference\";\n    CompletionItemKind[CompletionItemKind[\"Folder\"] = 19] = \"Folder\";\n    CompletionItemKind[CompletionItemKind[\"EnumMember\"] = 20] = \"EnumMember\";\n    CompletionItemKind[CompletionItemKind[\"Constant\"] = 21] = \"Constant\";\n    CompletionItemKind[CompletionItemKind[\"Struct\"] = 22] = \"Struct\";\n    CompletionItemKind[CompletionItemKind[\"Event\"] = 23] = \"Event\";\n    CompletionItemKind[CompletionItemKind[\"Operator\"] = 24] = \"Operator\";\n    CompletionItemKind[CompletionItemKind[\"TypeParameter\"] = 25] = \"TypeParameter\";\n})(CompletionItemKind || (CompletionItemKind = {}));\nexport var DocumentHighlightKind;\n(function (DocumentHighlightKind) {\n    DocumentHighlightKind[DocumentHighlightKind[\"Text\"] = 1] = \"Text\";\n    DocumentHighlightKind[DocumentHighlightKind[\"Read\"] = 2] = \"Read\";\n    DocumentHighlightKind[DocumentHighlightKind[\"Write\"] = 3] = \"Write\";\n})(DocumentHighlightKind || (DocumentHighlightKind = {}));\nexport var CompletionTriggerKind;\n(function (CompletionTriggerKind) {\n    CompletionTriggerKind[CompletionTriggerKind[\"Invoked\"] = 1] = \"Invoked\";\n    CompletionTriggerKind[CompletionTriggerKind[\"TriggerCharacter\"] = 2] = \"TriggerCharacter\";\n    CompletionTriggerKind[CompletionTriggerKind[\"TriggerForIncompleteCompletions\"] = 3] = \"TriggerForIncompleteCompletions\";\n})(CompletionTriggerKind || (CompletionTriggerKind = {}));\nexport var AdditionalCompletionTriggerKinds;\n(function (AdditionalCompletionTriggerKinds) {\n    AdditionalCompletionTriggerKinds[AdditionalCompletionTriggerKinds[\"AutoInvoked\"] = 9999] = \"AutoInvoked\";\n})(AdditionalCompletionTriggerKinds || (AdditionalCompletionTriggerKinds = {}));\n/**\n * The language identifier for LSP, with the preferred identifier as defined in the documentation\n * see the table in https://microsoft.github.io/language-server-protocol/specification#textDocumentItem\n */\nexport var Languages;\n(function (Languages) {\n    Languages[\"abap\"] = \"ABAP\";\n    Languages[\"bat\"] = \"Windows Bat\";\n    Languages[\"bibtex\"] = \"BibTeX\";\n    Languages[\"clojure\"] = \"Clojure\";\n    Languages[\"coffeescript\"] = \"Coffeescript\";\n    Languages[\"c\"] = \"C\";\n    Languages[\"cpp\"] = \"C++\";\n    Languages[\"csharp\"] = \"C#\";\n    Languages[\"css\"] = \"CSS\";\n    Languages[\"diff\"] = \"Diff\";\n    Languages[\"dart\"] = \"Dart\";\n    Languages[\"dockerfile\"] = \"Dockerfile\";\n    Languages[\"elixir\"] = \"Elixir\";\n    Languages[\"erlang\"] = \"Erlang\";\n    Languages[\"fsharp\"] = \"F#\";\n    Languages[\"git-commit\"] = \"Git (commit)\";\n    Languages[\"git-rebase\"] = \"Git (rebase)\";\n    Languages[\"go\"] = \"Go\";\n    Languages[\"groovy\"] = \"Groovy\";\n    Languages[\"handlebars\"] = \"Handlebars\";\n    Languages[\"html\"] = \"HTML\";\n    Languages[\"ini\"] = \"Ini\";\n    Languages[\"java\"] = \"Java\";\n    Languages[\"javascript\"] = \"JavaScript\";\n    Languages[\"javascriptreact\"] = \"JavaScript React\";\n    Languages[\"json\"] = \"JSON\";\n    Languages[\"latex\"] = \"LaTeX\";\n    Languages[\"less\"] = \"Less\";\n    Languages[\"lua\"] = \"Lua\";\n    Languages[\"makefile\"] = \"Makefile\";\n    Languages[\"markdown\"] = \"Markdown\";\n    Languages[\"objective-c\"] = \"Objective-C\";\n    Languages[\"objective-cpp\"] = \"Objective-C++\";\n    Languages[\"perl\"] = \"Perl\";\n    Languages[\"perl6\"] = \"Perl 6\";\n    Languages[\"php\"] = \"PHP\";\n    Languages[\"powershell\"] = \"Powershell\";\n    Languages[\"jade\"] = \"Pug\";\n    Languages[\"python\"] = \"Python\";\n    Languages[\"r\"] = \"R\";\n    Languages[\"razor\"] = \"Razor (cshtml)\";\n    Languages[\"ruby\"] = \"Ruby\";\n    Languages[\"rust\"] = \"Rust\";\n    Languages[\"scss\"] = \"SCSS (syntax using curly brackets)\";\n    Languages[\"sass\"] = \"SCSS (indented syntax)\";\n    Languages[\"scala\"] = \"Scala\";\n    Languages[\"shaderlab\"] = \"ShaderLab\";\n    Languages[\"shellscript\"] = \"Shell Script (Bash)\";\n    Languages[\"sql\"] = \"SQL\";\n    Languages[\"swift\"] = \"Swift\";\n    Languages[\"typescript\"] = \"TypeScript\";\n    Languages[\"typescriptreact\"] = \"TypeScript React\";\n    Languages[\"tex\"] = \"TeX\";\n    Languages[\"vb\"] = \"Visual Basic\";\n    Languages[\"xml\"] = \"XML\";\n    Languages[\"xsl\"] = \"XSL\";\n    Languages[\"yaml\"] = \"YAML\";\n})(Languages || (Languages = {}));\n//# sourceMappingURL=lsp.js.map","import { PositionConverter } from '../converter';\nimport { offset_at_position } from '../positioning';\nimport { DefaultMap, uris_equal } from '../utils';\nfunction toDocumentChanges(changes) {\n    let documentChanges = [];\n    for (let uri of Object.keys(changes)) {\n        documentChanges.push({\n            textDocument: { uri },\n            edits: changes[uri]\n        });\n    }\n    return documentChanges;\n}\nfunction offset_from_lsp(position, lines) {\n    return offset_at_position(PositionConverter.lsp_to_ce(position), lines);\n}\n/**\n * One feature of each type exists per VirtualDocument\n * (the initialization is performed by the adapter).\n */\nexport class CodeMirrorIntegration {\n    constructor(options) {\n        this.feature = options.feature;\n        this.virtual_editor = options.virtual_editor;\n        this.virtual_document = options.virtual_document;\n        this.connection = options.connection;\n        this.status_message = options.status_message;\n        this.adapter = options.adapter;\n        this.console = this.adapter.console.scope(options.feature.name);\n        this.trans = options.trans;\n        this.editor_handlers = new Map();\n        this.connection_handlers = new Map();\n        this.wrapper_handlers = new Map();\n        this.is_registered = false;\n    }\n    get settings() {\n        return this.feature.settings;\n    }\n    get lab_integration() {\n        return this.feature.labIntegration;\n    }\n    register() {\n        // register editor handlers\n        for (let [event_name, handler] of this.editor_handlers) {\n            this.virtual_editor.on(event_name, handler);\n        }\n        // register connection handlers\n        for (let [event_name, handler] of this.connection_handlers) {\n            this.connection.on(event_name, handler);\n        }\n        // register editor wrapper handlers\n        this.wrapper = this.virtual_editor.getWrapperElement();\n        for (let [event_name, handler] of this.wrapper_handlers) {\n            this.wrapper.addEventListener(event_name, handler);\n        }\n        this.is_registered = true;\n    }\n    remove() {\n        // unregister editor handlers\n        for (let [event_name, handler] of this.editor_handlers) {\n            this.virtual_editor.off(event_name, handler);\n        }\n        this.editor_handlers.clear();\n        // unregister connection handlers\n        for (let [event_name, handler] of this.connection_handlers) {\n            this.connection.off(event_name, handler);\n        }\n        this.connection_handlers.clear();\n        // unregister editor wrapper handlers\n        for (let [event_name, handler] of this.wrapper_handlers) {\n            this.wrapper.removeEventListener(event_name, handler);\n        }\n        this.wrapper_handlers.clear();\n    }\n    range_to_editor_range(range, cm_editor) {\n        let start = PositionConverter.lsp_to_cm(range.start);\n        let end = PositionConverter.lsp_to_cm(range.end);\n        if (cm_editor == null) {\n            let start_in_root = this.transform_virtual_position_to_root_position(start);\n            let ce_editor = this.virtual_editor.get_editor_at_root_position(start_in_root);\n            cm_editor = this.virtual_editor.ce_editor_to_cm_editor.get(ce_editor);\n        }\n        return {\n            start: this.virtual_document.transform_virtual_to_editor(start),\n            end: this.virtual_document.transform_virtual_to_editor(end),\n            editor: cm_editor\n        };\n    }\n    position_from_mouse(event) {\n        const position = this.virtual_editor.coordsChar({\n            left: event.clientX,\n            top: event.clientY\n        }, 'window');\n        if (position.line === -1 && position.ch === -1) {\n            return null;\n        }\n        else {\n            return position;\n        }\n    }\n    transform_virtual_position_to_root_position(start) {\n        let ce_editor = this.virtual_document.virtual_lines.get(start.line).editor;\n        let editor_position = this.virtual_document.transform_virtual_to_editor(start);\n        return this.virtual_editor.transform_from_editor_to_root(ce_editor, editor_position);\n    }\n    get_cm_editor(position) {\n        return this.virtual_editor.get_cm_editor(position);\n    }\n    get_language_at(position, editor) {\n        return editor.getModeAt(position).name;\n    }\n    extract_last_character(change) {\n        if (change.origin === 'paste') {\n            let last_line = change.text[change.text.length - 1];\n            return last_line[last_line.length - 1];\n        }\n        else {\n            return change.text[0][0];\n        }\n    }\n    highlight_range(range, class_name) {\n        return range.editor\n            .getDoc()\n            .markText(range.start, range.end, { className: class_name });\n    }\n    /**\n     * Does the edit cover the entire document?\n     */\n    is_whole_document_edit(edit) {\n        let value = this.virtual_document.value;\n        let lines = value.split('\\n');\n        let range = edit.range;\n        let lsp_to_ce = PositionConverter.lsp_to_ce;\n        return (offset_at_position(lsp_to_ce(range.start), lines) === 0 &&\n            offset_at_position(lsp_to_ce(range.end), lines) === value.length);\n    }\n    async apply_edit(workspaceEdit) {\n        let current_uri = this.virtual_document.document_info.uri;\n        // Specs: documentChanges are preferred over changes\n        let changes = workspaceEdit.documentChanges\n            ? workspaceEdit.documentChanges.map(change => change)\n            : toDocumentChanges(workspaceEdit.changes);\n        let applied_changes = 0;\n        let edited_cells = 0;\n        let is_whole_document_edit = false;\n        let errors = [];\n        for (let change of changes) {\n            let uri = change.textDocument.uri;\n            if (!uris_equal(uri, current_uri)) {\n                errors.push(`Workspace-wide edits not implemented: ${uri} != ${current_uri}`);\n            }\n            else {\n                is_whole_document_edit =\n                    change.edits.length === 1 &&\n                        this.is_whole_document_edit(change.edits[0]);\n                let edit;\n                if (!is_whole_document_edit) {\n                    applied_changes = 0;\n                    let value = this.virtual_document.value;\n                    // TODO: make sure that it was not changed since the request was sent (using the returned document version)\n                    let lines = value.split('\\n');\n                    let edits_by_offset = new Map();\n                    for (let e of change.edits) {\n                        let offset = offset_from_lsp(e.range.start, lines);\n                        if (edits_by_offset.has(offset)) {\n                            console.warn('Edits should not overlap, ignoring an overlapping edit');\n                        }\n                        else {\n                            edits_by_offset.set(offset, e);\n                            applied_changes += 1;\n                        }\n                    }\n                    // TODO make use of old_to_new_line for edits which add of remove lines:\n                    //  this is crucial to preserve cell boundaries in notebook in such cases\n                    let old_to_new_line = new DefaultMap(() => []);\n                    let new_text = '';\n                    let last_end = 0;\n                    let current_old_line = 0;\n                    let current_new_line = 0;\n                    // going over the edits in descending order of start points:\n                    let start_offsets = [...edits_by_offset.keys()].sort((a, b) => a - b);\n                    for (let start of start_offsets) {\n                        let edit = edits_by_offset.get(start);\n                        let prefix = value.slice(last_end, start);\n                        for (let i = 0; i < prefix.split('\\n').length; i++) {\n                            let new_lines = old_to_new_line.get_or_create(current_old_line);\n                            new_lines.push(current_new_line);\n                            current_old_line += 1;\n                            current_new_line += 1;\n                        }\n                        new_text += prefix + edit.newText;\n                        let end = offset_from_lsp(edit.range.end, lines);\n                        let replaced_fragment = value.slice(start, end);\n                        for (let i = 0; i < edit.newText.split('\\n').length; i++) {\n                            if (i < replaced_fragment.length) {\n                                current_old_line += 1;\n                            }\n                            current_new_line += 1;\n                            let new_lines = old_to_new_line.get_or_create(current_old_line);\n                            new_lines.push(current_new_line);\n                        }\n                        last_end = end;\n                    }\n                    new_text += value.slice(last_end, value.length);\n                    edit = {\n                        range: {\n                            start: { line: 0, character: 0 },\n                            end: {\n                                line: lines.length - 1,\n                                character: lines[lines.length - 1].length\n                            }\n                        },\n                        newText: new_text\n                    };\n                    console.assert(this.is_whole_document_edit(edit));\n                }\n                else {\n                    edit = change.edits[0];\n                    applied_changes += 1;\n                }\n                edited_cells = this.apply_single_edit(edit);\n            }\n        }\n        const all_empty = changes.every(change => change.edits.length === 0);\n        return {\n            appliedChanges: applied_changes,\n            modifiedCells: edited_cells,\n            wasGranular: !is_whole_document_edit && !all_empty,\n            errors: errors\n        };\n    }\n    replace_fragment(newText, editor, fragment_start, fragment_end, start, end, is_whole_document_edit = false) {\n        let document = this.virtual_document;\n        let newFragmentText = newText\n            .split('\\n')\n            .slice(fragment_start.line - start.line, fragment_end.line - start.line)\n            .join('\\n');\n        if (newFragmentText.endsWith('\\n')) {\n            newFragmentText = newFragmentText.slice(0, -1);\n        }\n        let doc = this.virtual_editor.ce_editor_to_cm_editor.get(editor).getDoc();\n        let raw_value = doc.getValue('\\n');\n        // extract foreign documents and substitute magics,\n        // as it was done when the shadow virtual document was being created\n        let { lines } = document.prepare_code_block({\n            value: raw_value,\n            ce_editor: editor\n        });\n        let old_value = lines.join('\\n');\n        if (is_whole_document_edit) {\n            // partial edit\n            let cm_to_ce = PositionConverter.cm_to_ce;\n            let up_to_offset = offset_at_position(cm_to_ce(start), lines);\n            let from_offset = offset_at_position(cm_to_ce(end), lines);\n            newFragmentText =\n                old_value.slice(0, up_to_offset) +\n                    newText +\n                    old_value.slice(from_offset);\n        }\n        if (old_value === newFragmentText) {\n            return 0;\n        }\n        let new_value = document.decode_code_block(newFragmentText);\n        let cursor = doc.getCursor();\n        doc.replaceRange(new_value, { line: 0, ch: 0 }, {\n            line: fragment_end.line - fragment_start.line + 1,\n            ch: 0\n        });\n        try {\n            // try to restore the cursor to the position prior to the edit\n            // (this might not be the best UX, but definitely better than\n            // the cursor jumping to the very end of the cell/file).\n            doc.setCursor(cursor, cursor.ch, { scroll: false });\n            // note: this does not matter for actions invoke from context menu\n            // as those loose focus anyways (this might be addressed elsewhere)\n        }\n        catch (e) {\n            console.log('Could not place the cursor back', e);\n        }\n        return 1;\n    }\n    afterChange(change, root_position) {\n        // nothing here\n    }\n    apply_single_edit(edit) {\n        let document = this.virtual_document;\n        let applied_changes = 0;\n        let start = PositionConverter.lsp_to_cm(edit.range.start);\n        let end = PositionConverter.lsp_to_cm(edit.range.end);\n        let start_editor = document.get_editor_at_virtual_line(start);\n        let end_editor = document.get_editor_at_virtual_line(end);\n        if (start_editor !== end_editor) {\n            let last_editor = start_editor;\n            let fragment_start = start;\n            let fragment_end = Object.assign({}, start);\n            let line = start.line;\n            let recently_replaced = false;\n            while (line <= end.line) {\n                line++;\n                let editor = document.get_editor_at_virtual_line({\n                    line: line,\n                    ch: 0\n                });\n                if (editor === last_editor) {\n                    fragment_end.line = line;\n                    fragment_end.ch = 0;\n                    recently_replaced = false;\n                }\n                else {\n                    applied_changes += this.replace_fragment(edit.newText, last_editor, fragment_start, fragment_end, start, end);\n                    recently_replaced = true;\n                    fragment_start = {\n                        line: line,\n                        ch: 0\n                    };\n                    fragment_end = {\n                        line: line,\n                        ch: 0\n                    };\n                    last_editor = editor;\n                }\n            }\n            if (!recently_replaced) {\n                applied_changes += this.replace_fragment(edit.newText, last_editor, fragment_start, fragment_end, start, end);\n            }\n        }\n        else {\n            applied_changes += this.replace_fragment(edit.newText, start_editor, start, end, start, end);\n        }\n        return applied_changes;\n    }\n}\n//# sourceMappingURL=codemirror.js.map","/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\n'use strict';\nexport var DocumentUri;\n(function (DocumentUri) {\n    function is(value) {\n        return typeof value === 'string';\n    }\n    DocumentUri.is = is;\n})(DocumentUri || (DocumentUri = {}));\nexport var URI;\n(function (URI) {\n    function is(value) {\n        return typeof value === 'string';\n    }\n    URI.is = is;\n})(URI || (URI = {}));\nexport var integer;\n(function (integer) {\n    integer.MIN_VALUE = -2147483648;\n    integer.MAX_VALUE = 2147483647;\n    function is(value) {\n        return typeof value === 'number' && integer.MIN_VALUE <= value && value <= integer.MAX_VALUE;\n    }\n    integer.is = is;\n})(integer || (integer = {}));\nexport var uinteger;\n(function (uinteger) {\n    uinteger.MIN_VALUE = 0;\n    uinteger.MAX_VALUE = 2147483647;\n    function is(value) {\n        return typeof value === 'number' && uinteger.MIN_VALUE <= value && value <= uinteger.MAX_VALUE;\n    }\n    uinteger.is = is;\n})(uinteger || (uinteger = {}));\n/**\n * The Position namespace provides helper functions to work with\n * {@link Position} literals.\n */\nexport var Position;\n(function (Position) {\n    /**\n     * Creates a new Position literal from the given line and character.\n     * @param line The position's line.\n     * @param character The position's character.\n     */\n    function create(line, character) {\n        if (line === Number.MAX_VALUE) {\n            line = uinteger.MAX_VALUE;\n        }\n        if (character === Number.MAX_VALUE) {\n            character = uinteger.MAX_VALUE;\n        }\n        return { line: line, character: character };\n    }\n    Position.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link Position} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Is.uinteger(candidate.line) && Is.uinteger(candidate.character);\n    }\n    Position.is = is;\n})(Position || (Position = {}));\n/**\n * The Range namespace provides helper functions to work with\n * {@link Range} literals.\n */\nexport var Range;\n(function (Range) {\n    function create(one, two, three, four) {\n        if (Is.uinteger(one) && Is.uinteger(two) && Is.uinteger(three) && Is.uinteger(four)) {\n            return { start: Position.create(one, two), end: Position.create(three, four) };\n        }\n        else if (Position.is(one) && Position.is(two)) {\n            return { start: one, end: two };\n        }\n        else {\n            throw new Error(\"Range#create called with invalid arguments[\".concat(one, \", \").concat(two, \", \").concat(three, \", \").concat(four, \"]\"));\n        }\n    }\n    Range.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link Range} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Position.is(candidate.start) && Position.is(candidate.end);\n    }\n    Range.is = is;\n})(Range || (Range = {}));\n/**\n * The Location namespace provides helper functions to work with\n * {@link Location} literals.\n */\nexport var Location;\n(function (Location) {\n    /**\n     * Creates a Location literal.\n     * @param uri The location's uri.\n     * @param range The location's range.\n     */\n    function create(uri, range) {\n        return { uri: uri, range: range };\n    }\n    Location.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link Location} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Range.is(candidate.range) && (Is.string(candidate.uri) || Is.undefined(candidate.uri));\n    }\n    Location.is = is;\n})(Location || (Location = {}));\n/**\n * The LocationLink namespace provides helper functions to work with\n * {@link LocationLink} literals.\n */\nexport var LocationLink;\n(function (LocationLink) {\n    /**\n     * Creates a LocationLink literal.\n     * @param targetUri The definition's uri.\n     * @param targetRange The full range of the definition.\n     * @param targetSelectionRange The span of the symbol definition at the target.\n     * @param originSelectionRange The span of the symbol being defined in the originating source file.\n     */\n    function create(targetUri, targetRange, targetSelectionRange, originSelectionRange) {\n        return { targetUri: targetUri, targetRange: targetRange, targetSelectionRange: targetSelectionRange, originSelectionRange: originSelectionRange };\n    }\n    LocationLink.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link LocationLink} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Range.is(candidate.targetRange) && Is.string(candidate.targetUri)\n            && Range.is(candidate.targetSelectionRange)\n            && (Range.is(candidate.originSelectionRange) || Is.undefined(candidate.originSelectionRange));\n    }\n    LocationLink.is = is;\n})(LocationLink || (LocationLink = {}));\n/**\n * The Color namespace provides helper functions to work with\n * {@link Color} literals.\n */\nexport var Color;\n(function (Color) {\n    /**\n     * Creates a new Color literal.\n     */\n    function create(red, green, blue, alpha) {\n        return {\n            red: red,\n            green: green,\n            blue: blue,\n            alpha: alpha,\n        };\n    }\n    Color.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link Color} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Is.numberRange(candidate.red, 0, 1)\n            && Is.numberRange(candidate.green, 0, 1)\n            && Is.numberRange(candidate.blue, 0, 1)\n            && Is.numberRange(candidate.alpha, 0, 1);\n    }\n    Color.is = is;\n})(Color || (Color = {}));\n/**\n * The ColorInformation namespace provides helper functions to work with\n * {@link ColorInformation} literals.\n */\nexport var ColorInformation;\n(function (ColorInformation) {\n    /**\n     * Creates a new ColorInformation literal.\n     */\n    function create(range, color) {\n        return {\n            range: range,\n            color: color,\n        };\n    }\n    ColorInformation.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link ColorInformation} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Range.is(candidate.range) && Color.is(candidate.color);\n    }\n    ColorInformation.is = is;\n})(ColorInformation || (ColorInformation = {}));\n/**\n * The Color namespace provides helper functions to work with\n * {@link ColorPresentation} literals.\n */\nexport var ColorPresentation;\n(function (ColorPresentation) {\n    /**\n     * Creates a new ColorInformation literal.\n     */\n    function create(label, textEdit, additionalTextEdits) {\n        return {\n            label: label,\n            textEdit: textEdit,\n            additionalTextEdits: additionalTextEdits,\n        };\n    }\n    ColorPresentation.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link ColorInformation} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Is.string(candidate.label)\n            && (Is.undefined(candidate.textEdit) || TextEdit.is(candidate))\n            && (Is.undefined(candidate.additionalTextEdits) || Is.typedArray(candidate.additionalTextEdits, TextEdit.is));\n    }\n    ColorPresentation.is = is;\n})(ColorPresentation || (ColorPresentation = {}));\n/**\n * A set of predefined range kinds.\n */\nexport var FoldingRangeKind;\n(function (FoldingRangeKind) {\n    /**\n     * Folding range for a comment\n     */\n    FoldingRangeKind.Comment = 'comment';\n    /**\n     * Folding range for an import or include\n     */\n    FoldingRangeKind.Imports = 'imports';\n    /**\n     * Folding range for a region (e.g. `#region`)\n     */\n    FoldingRangeKind.Region = 'region';\n})(FoldingRangeKind || (FoldingRangeKind = {}));\n/**\n * The folding range namespace provides helper functions to work with\n * {@link FoldingRange} literals.\n */\nexport var FoldingRange;\n(function (FoldingRange) {\n    /**\n     * Creates a new FoldingRange literal.\n     */\n    function create(startLine, endLine, startCharacter, endCharacter, kind, collapsedText) {\n        var result = {\n            startLine: startLine,\n            endLine: endLine\n        };\n        if (Is.defined(startCharacter)) {\n            result.startCharacter = startCharacter;\n        }\n        if (Is.defined(endCharacter)) {\n            result.endCharacter = endCharacter;\n        }\n        if (Is.defined(kind)) {\n            result.kind = kind;\n        }\n        if (Is.defined(collapsedText)) {\n            result.collapsedText = collapsedText;\n        }\n        return result;\n    }\n    FoldingRange.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link FoldingRange} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Is.uinteger(candidate.startLine) && Is.uinteger(candidate.startLine)\n            && (Is.undefined(candidate.startCharacter) || Is.uinteger(candidate.startCharacter))\n            && (Is.undefined(candidate.endCharacter) || Is.uinteger(candidate.endCharacter))\n            && (Is.undefined(candidate.kind) || Is.string(candidate.kind));\n    }\n    FoldingRange.is = is;\n})(FoldingRange || (FoldingRange = {}));\n/**\n * The DiagnosticRelatedInformation namespace provides helper functions to work with\n * {@link DiagnosticRelatedInformation} literals.\n */\nexport var DiagnosticRelatedInformation;\n(function (DiagnosticRelatedInformation) {\n    /**\n     * Creates a new DiagnosticRelatedInformation literal.\n     */\n    function create(location, message) {\n        return {\n            location: location,\n            message: message\n        };\n    }\n    DiagnosticRelatedInformation.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link DiagnosticRelatedInformation} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Location.is(candidate.location) && Is.string(candidate.message);\n    }\n    DiagnosticRelatedInformation.is = is;\n})(DiagnosticRelatedInformation || (DiagnosticRelatedInformation = {}));\n/**\n * The diagnostic's severity.\n */\nexport var DiagnosticSeverity;\n(function (DiagnosticSeverity) {\n    /**\n     * Reports an error.\n     */\n    DiagnosticSeverity.Error = 1;\n    /**\n     * Reports a warning.\n     */\n    DiagnosticSeverity.Warning = 2;\n    /**\n     * Reports an information.\n     */\n    DiagnosticSeverity.Information = 3;\n    /**\n     * Reports a hint.\n     */\n    DiagnosticSeverity.Hint = 4;\n})(DiagnosticSeverity || (DiagnosticSeverity = {}));\n/**\n * The diagnostic tags.\n *\n * @since 3.15.0\n */\nexport var DiagnosticTag;\n(function (DiagnosticTag) {\n    /**\n     * Unused or unnecessary code.\n     *\n     * Clients are allowed to render diagnostics with this tag faded out instead of having\n     * an error squiggle.\n     */\n    DiagnosticTag.Unnecessary = 1;\n    /**\n     * Deprecated or obsolete code.\n     *\n     * Clients are allowed to rendered diagnostics with this tag strike through.\n     */\n    DiagnosticTag.Deprecated = 2;\n})(DiagnosticTag || (DiagnosticTag = {}));\n/**\n * The CodeDescription namespace provides functions to deal with descriptions for diagnostic codes.\n *\n * @since 3.16.0\n */\nexport var CodeDescription;\n(function (CodeDescription) {\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Is.string(candidate.href);\n    }\n    CodeDescription.is = is;\n})(CodeDescription || (CodeDescription = {}));\n/**\n * The Diagnostic namespace provides helper functions to work with\n * {@link Diagnostic} literals.\n */\nexport var Diagnostic;\n(function (Diagnostic) {\n    /**\n     * Creates a new Diagnostic literal.\n     */\n    function create(range, message, severity, code, source, relatedInformation) {\n        var result = { range: range, message: message };\n        if (Is.defined(severity)) {\n            result.severity = severity;\n        }\n        if (Is.defined(code)) {\n            result.code = code;\n        }\n        if (Is.defined(source)) {\n            result.source = source;\n        }\n        if (Is.defined(relatedInformation)) {\n            result.relatedInformation = relatedInformation;\n        }\n        return result;\n    }\n    Diagnostic.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link Diagnostic} interface.\n     */\n    function is(value) {\n        var _a;\n        var candidate = value;\n        return Is.defined(candidate)\n            && Range.is(candidate.range)\n            && Is.string(candidate.message)\n            && (Is.number(candidate.severity) || Is.undefined(candidate.severity))\n            && (Is.integer(candidate.code) || Is.string(candidate.code) || Is.undefined(candidate.code))\n            && (Is.undefined(candidate.codeDescription) || (Is.string((_a = candidate.codeDescription) === null || _a === void 0 ? void 0 : _a.href)))\n            && (Is.string(candidate.source) || Is.undefined(candidate.source))\n            && (Is.undefined(candidate.relatedInformation) || Is.typedArray(candidate.relatedInformation, DiagnosticRelatedInformation.is));\n    }\n    Diagnostic.is = is;\n})(Diagnostic || (Diagnostic = {}));\n/**\n * The Command namespace provides helper functions to work with\n * {@link Command} literals.\n */\nexport var Command;\n(function (Command) {\n    /**\n     * Creates a new Command literal.\n     */\n    function create(title, command) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var result = { title: title, command: command };\n        if (Is.defined(args) && args.length > 0) {\n            result.arguments = args;\n        }\n        return result;\n    }\n    Command.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link Command} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Is.string(candidate.title) && Is.string(candidate.command);\n    }\n    Command.is = is;\n})(Command || (Command = {}));\n/**\n * The TextEdit namespace provides helper function to create replace,\n * insert and delete edits more easily.\n */\nexport var TextEdit;\n(function (TextEdit) {\n    /**\n     * Creates a replace text edit.\n     * @param range The range of text to be replaced.\n     * @param newText The new text.\n     */\n    function replace(range, newText) {\n        return { range: range, newText: newText };\n    }\n    TextEdit.replace = replace;\n    /**\n     * Creates an insert text edit.\n     * @param position The position to insert the text at.\n     * @param newText The text to be inserted.\n     */\n    function insert(position, newText) {\n        return { range: { start: position, end: position }, newText: newText };\n    }\n    TextEdit.insert = insert;\n    /**\n     * Creates a delete text edit.\n     * @param range The range of text to be deleted.\n     */\n    function del(range) {\n        return { range: range, newText: '' };\n    }\n    TextEdit.del = del;\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate)\n            && Is.string(candidate.newText)\n            && Range.is(candidate.range);\n    }\n    TextEdit.is = is;\n})(TextEdit || (TextEdit = {}));\nexport var ChangeAnnotation;\n(function (ChangeAnnotation) {\n    function create(label, needsConfirmation, description) {\n        var result = { label: label };\n        if (needsConfirmation !== undefined) {\n            result.needsConfirmation = needsConfirmation;\n        }\n        if (description !== undefined) {\n            result.description = description;\n        }\n        return result;\n    }\n    ChangeAnnotation.create = create;\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Is.string(candidate.label) &&\n            (Is.boolean(candidate.needsConfirmation) || candidate.needsConfirmation === undefined) &&\n            (Is.string(candidate.description) || candidate.description === undefined);\n    }\n    ChangeAnnotation.is = is;\n})(ChangeAnnotation || (ChangeAnnotation = {}));\nexport var ChangeAnnotationIdentifier;\n(function (ChangeAnnotationIdentifier) {\n    function is(value) {\n        var candidate = value;\n        return Is.string(candidate);\n    }\n    ChangeAnnotationIdentifier.is = is;\n})(ChangeAnnotationIdentifier || (ChangeAnnotationIdentifier = {}));\nexport var AnnotatedTextEdit;\n(function (AnnotatedTextEdit) {\n    /**\n     * Creates an annotated replace text edit.\n     *\n     * @param range The range of text to be replaced.\n     * @param newText The new text.\n     * @param annotation The annotation.\n     */\n    function replace(range, newText, annotation) {\n        return { range: range, newText: newText, annotationId: annotation };\n    }\n    AnnotatedTextEdit.replace = replace;\n    /**\n     * Creates an annotated insert text edit.\n     *\n     * @param position The position to insert the text at.\n     * @param newText The text to be inserted.\n     * @param annotation The annotation.\n     */\n    function insert(position, newText, annotation) {\n        return { range: { start: position, end: position }, newText: newText, annotationId: annotation };\n    }\n    AnnotatedTextEdit.insert = insert;\n    /**\n     * Creates an annotated delete text edit.\n     *\n     * @param range The range of text to be deleted.\n     * @param annotation The annotation.\n     */\n    function del(range, annotation) {\n        return { range: range, newText: '', annotationId: annotation };\n    }\n    AnnotatedTextEdit.del = del;\n    function is(value) {\n        var candidate = value;\n        return TextEdit.is(candidate) && (ChangeAnnotation.is(candidate.annotationId) || ChangeAnnotationIdentifier.is(candidate.annotationId));\n    }\n    AnnotatedTextEdit.is = is;\n})(AnnotatedTextEdit || (AnnotatedTextEdit = {}));\n/**\n * The TextDocumentEdit namespace provides helper function to create\n * an edit that manipulates a text document.\n */\nexport var TextDocumentEdit;\n(function (TextDocumentEdit) {\n    /**\n     * Creates a new `TextDocumentEdit`\n     */\n    function create(textDocument, edits) {\n        return { textDocument: textDocument, edits: edits };\n    }\n    TextDocumentEdit.create = create;\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate)\n            && OptionalVersionedTextDocumentIdentifier.is(candidate.textDocument)\n            && Array.isArray(candidate.edits);\n    }\n    TextDocumentEdit.is = is;\n})(TextDocumentEdit || (TextDocumentEdit = {}));\nexport var CreateFile;\n(function (CreateFile) {\n    function create(uri, options, annotation) {\n        var result = {\n            kind: 'create',\n            uri: uri\n        };\n        if (options !== undefined && (options.overwrite !== undefined || options.ignoreIfExists !== undefined)) {\n            result.options = options;\n        }\n        if (annotation !== undefined) {\n            result.annotationId = annotation;\n        }\n        return result;\n    }\n    CreateFile.create = create;\n    function is(value) {\n        var candidate = value;\n        return candidate && candidate.kind === 'create' && Is.string(candidate.uri) && (candidate.options === undefined ||\n            ((candidate.options.overwrite === undefined || Is.boolean(candidate.options.overwrite)) && (candidate.options.ignoreIfExists === undefined || Is.boolean(candidate.options.ignoreIfExists)))) && (candidate.annotationId === undefined || ChangeAnnotationIdentifier.is(candidate.annotationId));\n    }\n    CreateFile.is = is;\n})(CreateFile || (CreateFile = {}));\nexport var RenameFile;\n(function (RenameFile) {\n    function create(oldUri, newUri, options, annotation) {\n        var result = {\n            kind: 'rename',\n            oldUri: oldUri,\n            newUri: newUri\n        };\n        if (options !== undefined && (options.overwrite !== undefined || options.ignoreIfExists !== undefined)) {\n            result.options = options;\n        }\n        if (annotation !== undefined) {\n            result.annotationId = annotation;\n        }\n        return result;\n    }\n    RenameFile.create = create;\n    function is(value) {\n        var candidate = value;\n        return candidate && candidate.kind === 'rename' && Is.string(candidate.oldUri) && Is.string(candidate.newUri) && (candidate.options === undefined ||\n            ((candidate.options.overwrite === undefined || Is.boolean(candidate.options.overwrite)) && (candidate.options.ignoreIfExists === undefined || Is.boolean(candidate.options.ignoreIfExists)))) && (candidate.annotationId === undefined || ChangeAnnotationIdentifier.is(candidate.annotationId));\n    }\n    RenameFile.is = is;\n})(RenameFile || (RenameFile = {}));\nexport var DeleteFile;\n(function (DeleteFile) {\n    function create(uri, options, annotation) {\n        var result = {\n            kind: 'delete',\n            uri: uri\n        };\n        if (options !== undefined && (options.recursive !== undefined || options.ignoreIfNotExists !== undefined)) {\n            result.options = options;\n        }\n        if (annotation !== undefined) {\n            result.annotationId = annotation;\n        }\n        return result;\n    }\n    DeleteFile.create = create;\n    function is(value) {\n        var candidate = value;\n        return candidate && candidate.kind === 'delete' && Is.string(candidate.uri) && (candidate.options === undefined ||\n            ((candidate.options.recursive === undefined || Is.boolean(candidate.options.recursive)) && (candidate.options.ignoreIfNotExists === undefined || Is.boolean(candidate.options.ignoreIfNotExists)))) && (candidate.annotationId === undefined || ChangeAnnotationIdentifier.is(candidate.annotationId));\n    }\n    DeleteFile.is = is;\n})(DeleteFile || (DeleteFile = {}));\nexport var WorkspaceEdit;\n(function (WorkspaceEdit) {\n    function is(value) {\n        var candidate = value;\n        return candidate &&\n            (candidate.changes !== undefined || candidate.documentChanges !== undefined) &&\n            (candidate.documentChanges === undefined || candidate.documentChanges.every(function (change) {\n                if (Is.string(change.kind)) {\n                    return CreateFile.is(change) || RenameFile.is(change) || DeleteFile.is(change);\n                }\n                else {\n                    return TextDocumentEdit.is(change);\n                }\n            }));\n    }\n    WorkspaceEdit.is = is;\n})(WorkspaceEdit || (WorkspaceEdit = {}));\nvar TextEditChangeImpl = /** @class */ (function () {\n    function TextEditChangeImpl(edits, changeAnnotations) {\n        this.edits = edits;\n        this.changeAnnotations = changeAnnotations;\n    }\n    TextEditChangeImpl.prototype.insert = function (position, newText, annotation) {\n        var edit;\n        var id;\n        if (annotation === undefined) {\n            edit = TextEdit.insert(position, newText);\n        }\n        else if (ChangeAnnotationIdentifier.is(annotation)) {\n            id = annotation;\n            edit = AnnotatedTextEdit.insert(position, newText, annotation);\n        }\n        else {\n            this.assertChangeAnnotations(this.changeAnnotations);\n            id = this.changeAnnotations.manage(annotation);\n            edit = AnnotatedTextEdit.insert(position, newText, id);\n        }\n        this.edits.push(edit);\n        if (id !== undefined) {\n            return id;\n        }\n    };\n    TextEditChangeImpl.prototype.replace = function (range, newText, annotation) {\n        var edit;\n        var id;\n        if (annotation === undefined) {\n            edit = TextEdit.replace(range, newText);\n        }\n        else if (ChangeAnnotationIdentifier.is(annotation)) {\n            id = annotation;\n            edit = AnnotatedTextEdit.replace(range, newText, annotation);\n        }\n        else {\n            this.assertChangeAnnotations(this.changeAnnotations);\n            id = this.changeAnnotations.manage(annotation);\n            edit = AnnotatedTextEdit.replace(range, newText, id);\n        }\n        this.edits.push(edit);\n        if (id !== undefined) {\n            return id;\n        }\n    };\n    TextEditChangeImpl.prototype.delete = function (range, annotation) {\n        var edit;\n        var id;\n        if (annotation === undefined) {\n            edit = TextEdit.del(range);\n        }\n        else if (ChangeAnnotationIdentifier.is(annotation)) {\n            id = annotation;\n            edit = AnnotatedTextEdit.del(range, annotation);\n        }\n        else {\n            this.assertChangeAnnotations(this.changeAnnotations);\n            id = this.changeAnnotations.manage(annotation);\n            edit = AnnotatedTextEdit.del(range, id);\n        }\n        this.edits.push(edit);\n        if (id !== undefined) {\n            return id;\n        }\n    };\n    TextEditChangeImpl.prototype.add = function (edit) {\n        this.edits.push(edit);\n    };\n    TextEditChangeImpl.prototype.all = function () {\n        return this.edits;\n    };\n    TextEditChangeImpl.prototype.clear = function () {\n        this.edits.splice(0, this.edits.length);\n    };\n    TextEditChangeImpl.prototype.assertChangeAnnotations = function (value) {\n        if (value === undefined) {\n            throw new Error(\"Text edit change is not configured to manage change annotations.\");\n        }\n    };\n    return TextEditChangeImpl;\n}());\n/**\n * A helper class\n */\nvar ChangeAnnotations = /** @class */ (function () {\n    function ChangeAnnotations(annotations) {\n        this._annotations = annotations === undefined ? Object.create(null) : annotations;\n        this._counter = 0;\n        this._size = 0;\n    }\n    ChangeAnnotations.prototype.all = function () {\n        return this._annotations;\n    };\n    Object.defineProperty(ChangeAnnotations.prototype, \"size\", {\n        get: function () {\n            return this._size;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ChangeAnnotations.prototype.manage = function (idOrAnnotation, annotation) {\n        var id;\n        if (ChangeAnnotationIdentifier.is(idOrAnnotation)) {\n            id = idOrAnnotation;\n        }\n        else {\n            id = this.nextId();\n            annotation = idOrAnnotation;\n        }\n        if (this._annotations[id] !== undefined) {\n            throw new Error(\"Id \".concat(id, \" is already in use.\"));\n        }\n        if (annotation === undefined) {\n            throw new Error(\"No annotation provided for id \".concat(id));\n        }\n        this._annotations[id] = annotation;\n        this._size++;\n        return id;\n    };\n    ChangeAnnotations.prototype.nextId = function () {\n        this._counter++;\n        return this._counter.toString();\n    };\n    return ChangeAnnotations;\n}());\n/**\n * A workspace change helps constructing changes to a workspace.\n */\nvar WorkspaceChange = /** @class */ (function () {\n    function WorkspaceChange(workspaceEdit) {\n        var _this = this;\n        this._textEditChanges = Object.create(null);\n        if (workspaceEdit !== undefined) {\n            this._workspaceEdit = workspaceEdit;\n            if (workspaceEdit.documentChanges) {\n                this._changeAnnotations = new ChangeAnnotations(workspaceEdit.changeAnnotations);\n                workspaceEdit.changeAnnotations = this._changeAnnotations.all();\n                workspaceEdit.documentChanges.forEach(function (change) {\n                    if (TextDocumentEdit.is(change)) {\n                        var textEditChange = new TextEditChangeImpl(change.edits, _this._changeAnnotations);\n                        _this._textEditChanges[change.textDocument.uri] = textEditChange;\n                    }\n                });\n            }\n            else if (workspaceEdit.changes) {\n                Object.keys(workspaceEdit.changes).forEach(function (key) {\n                    var textEditChange = new TextEditChangeImpl(workspaceEdit.changes[key]);\n                    _this._textEditChanges[key] = textEditChange;\n                });\n            }\n        }\n        else {\n            this._workspaceEdit = {};\n        }\n    }\n    Object.defineProperty(WorkspaceChange.prototype, \"edit\", {\n        /**\n         * Returns the underlying {@link WorkspaceEdit} literal\n         * use to be returned from a workspace edit operation like rename.\n         */\n        get: function () {\n            this.initDocumentChanges();\n            if (this._changeAnnotations !== undefined) {\n                if (this._changeAnnotations.size === 0) {\n                    this._workspaceEdit.changeAnnotations = undefined;\n                }\n                else {\n                    this._workspaceEdit.changeAnnotations = this._changeAnnotations.all();\n                }\n            }\n            return this._workspaceEdit;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    WorkspaceChange.prototype.getTextEditChange = function (key) {\n        if (OptionalVersionedTextDocumentIdentifier.is(key)) {\n            this.initDocumentChanges();\n            if (this._workspaceEdit.documentChanges === undefined) {\n                throw new Error('Workspace edit is not configured for document changes.');\n            }\n            var textDocument = { uri: key.uri, version: key.version };\n            var result = this._textEditChanges[textDocument.uri];\n            if (!result) {\n                var edits = [];\n                var textDocumentEdit = {\n                    textDocument: textDocument,\n                    edits: edits\n                };\n                this._workspaceEdit.documentChanges.push(textDocumentEdit);\n                result = new TextEditChangeImpl(edits, this._changeAnnotations);\n                this._textEditChanges[textDocument.uri] = result;\n            }\n            return result;\n        }\n        else {\n            this.initChanges();\n            if (this._workspaceEdit.changes === undefined) {\n                throw new Error('Workspace edit is not configured for normal text edit changes.');\n            }\n            var result = this._textEditChanges[key];\n            if (!result) {\n                var edits = [];\n                this._workspaceEdit.changes[key] = edits;\n                result = new TextEditChangeImpl(edits);\n                this._textEditChanges[key] = result;\n            }\n            return result;\n        }\n    };\n    WorkspaceChange.prototype.initDocumentChanges = function () {\n        if (this._workspaceEdit.documentChanges === undefined && this._workspaceEdit.changes === undefined) {\n            this._changeAnnotations = new ChangeAnnotations();\n            this._workspaceEdit.documentChanges = [];\n            this._workspaceEdit.changeAnnotations = this._changeAnnotations.all();\n        }\n    };\n    WorkspaceChange.prototype.initChanges = function () {\n        if (this._workspaceEdit.documentChanges === undefined && this._workspaceEdit.changes === undefined) {\n            this._workspaceEdit.changes = Object.create(null);\n        }\n    };\n    WorkspaceChange.prototype.createFile = function (uri, optionsOrAnnotation, options) {\n        this.initDocumentChanges();\n        if (this._workspaceEdit.documentChanges === undefined) {\n            throw new Error('Workspace edit is not configured for document changes.');\n        }\n        var annotation;\n        if (ChangeAnnotation.is(optionsOrAnnotation) || ChangeAnnotationIdentifier.is(optionsOrAnnotation)) {\n            annotation = optionsOrAnnotation;\n        }\n        else {\n            options = optionsOrAnnotation;\n        }\n        var operation;\n        var id;\n        if (annotation === undefined) {\n            operation = CreateFile.create(uri, options);\n        }\n        else {\n            id = ChangeAnnotationIdentifier.is(annotation) ? annotation : this._changeAnnotations.manage(annotation);\n            operation = CreateFile.create(uri, options, id);\n        }\n        this._workspaceEdit.documentChanges.push(operation);\n        if (id !== undefined) {\n            return id;\n        }\n    };\n    WorkspaceChange.prototype.renameFile = function (oldUri, newUri, optionsOrAnnotation, options) {\n        this.initDocumentChanges();\n        if (this._workspaceEdit.documentChanges === undefined) {\n            throw new Error('Workspace edit is not configured for document changes.');\n        }\n        var annotation;\n        if (ChangeAnnotation.is(optionsOrAnnotation) || ChangeAnnotationIdentifier.is(optionsOrAnnotation)) {\n            annotation = optionsOrAnnotation;\n        }\n        else {\n            options = optionsOrAnnotation;\n        }\n        var operation;\n        var id;\n        if (annotation === undefined) {\n            operation = RenameFile.create(oldUri, newUri, options);\n        }\n        else {\n            id = ChangeAnnotationIdentifier.is(annotation) ? annotation : this._changeAnnotations.manage(annotation);\n            operation = RenameFile.create(oldUri, newUri, options, id);\n        }\n        this._workspaceEdit.documentChanges.push(operation);\n        if (id !== undefined) {\n            return id;\n        }\n    };\n    WorkspaceChange.prototype.deleteFile = function (uri, optionsOrAnnotation, options) {\n        this.initDocumentChanges();\n        if (this._workspaceEdit.documentChanges === undefined) {\n            throw new Error('Workspace edit is not configured for document changes.');\n        }\n        var annotation;\n        if (ChangeAnnotation.is(optionsOrAnnotation) || ChangeAnnotationIdentifier.is(optionsOrAnnotation)) {\n            annotation = optionsOrAnnotation;\n        }\n        else {\n            options = optionsOrAnnotation;\n        }\n        var operation;\n        var id;\n        if (annotation === undefined) {\n            operation = DeleteFile.create(uri, options);\n        }\n        else {\n            id = ChangeAnnotationIdentifier.is(annotation) ? annotation : this._changeAnnotations.manage(annotation);\n            operation = DeleteFile.create(uri, options, id);\n        }\n        this._workspaceEdit.documentChanges.push(operation);\n        if (id !== undefined) {\n            return id;\n        }\n    };\n    return WorkspaceChange;\n}());\nexport { WorkspaceChange };\n/**\n * The TextDocumentIdentifier namespace provides helper functions to work with\n * {@link TextDocumentIdentifier} literals.\n */\nexport var TextDocumentIdentifier;\n(function (TextDocumentIdentifier) {\n    /**\n     * Creates a new TextDocumentIdentifier literal.\n     * @param uri The document's uri.\n     */\n    function create(uri) {\n        return { uri: uri };\n    }\n    TextDocumentIdentifier.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link TextDocumentIdentifier} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Is.string(candidate.uri);\n    }\n    TextDocumentIdentifier.is = is;\n})(TextDocumentIdentifier || (TextDocumentIdentifier = {}));\n/**\n * The VersionedTextDocumentIdentifier namespace provides helper functions to work with\n * {@link VersionedTextDocumentIdentifier} literals.\n */\nexport var VersionedTextDocumentIdentifier;\n(function (VersionedTextDocumentIdentifier) {\n    /**\n     * Creates a new VersionedTextDocumentIdentifier literal.\n     * @param uri The document's uri.\n     * @param version The document's version.\n     */\n    function create(uri, version) {\n        return { uri: uri, version: version };\n    }\n    VersionedTextDocumentIdentifier.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link VersionedTextDocumentIdentifier} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Is.string(candidate.uri) && Is.integer(candidate.version);\n    }\n    VersionedTextDocumentIdentifier.is = is;\n})(VersionedTextDocumentIdentifier || (VersionedTextDocumentIdentifier = {}));\n/**\n * The OptionalVersionedTextDocumentIdentifier namespace provides helper functions to work with\n * {@link OptionalVersionedTextDocumentIdentifier} literals.\n */\nexport var OptionalVersionedTextDocumentIdentifier;\n(function (OptionalVersionedTextDocumentIdentifier) {\n    /**\n     * Creates a new OptionalVersionedTextDocumentIdentifier literal.\n     * @param uri The document's uri.\n     * @param version The document's version.\n     */\n    function create(uri, version) {\n        return { uri: uri, version: version };\n    }\n    OptionalVersionedTextDocumentIdentifier.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link OptionalVersionedTextDocumentIdentifier} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Is.string(candidate.uri) && (candidate.version === null || Is.integer(candidate.version));\n    }\n    OptionalVersionedTextDocumentIdentifier.is = is;\n})(OptionalVersionedTextDocumentIdentifier || (OptionalVersionedTextDocumentIdentifier = {}));\n/**\n * The TextDocumentItem namespace provides helper functions to work with\n * {@link TextDocumentItem} literals.\n */\nexport var TextDocumentItem;\n(function (TextDocumentItem) {\n    /**\n     * Creates a new TextDocumentItem literal.\n     * @param uri The document's uri.\n     * @param languageId The document's language identifier.\n     * @param version The document's version number.\n     * @param text The document's text.\n     */\n    function create(uri, languageId, version, text) {\n        return { uri: uri, languageId: languageId, version: version, text: text };\n    }\n    TextDocumentItem.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link TextDocumentItem} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Is.string(candidate.uri) && Is.string(candidate.languageId) && Is.integer(candidate.version) && Is.string(candidate.text);\n    }\n    TextDocumentItem.is = is;\n})(TextDocumentItem || (TextDocumentItem = {}));\n/**\n * Describes the content type that a client supports in various\n * result literals like `Hover`, `ParameterInfo` or `CompletionItem`.\n *\n * Please note that `MarkupKinds` must not start with a `$`. This kinds\n * are reserved for internal usage.\n */\nexport var MarkupKind;\n(function (MarkupKind) {\n    /**\n     * Plain text is supported as a content format\n     */\n    MarkupKind.PlainText = 'plaintext';\n    /**\n     * Markdown is supported as a content format\n     */\n    MarkupKind.Markdown = 'markdown';\n    /**\n     * Checks whether the given value is a value of the {@link MarkupKind} type.\n     */\n    function is(value) {\n        var candidate = value;\n        return candidate === MarkupKind.PlainText || candidate === MarkupKind.Markdown;\n    }\n    MarkupKind.is = is;\n})(MarkupKind || (MarkupKind = {}));\nexport var MarkupContent;\n(function (MarkupContent) {\n    /**\n     * Checks whether the given value conforms to the {@link MarkupContent} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(value) && MarkupKind.is(candidate.kind) && Is.string(candidate.value);\n    }\n    MarkupContent.is = is;\n})(MarkupContent || (MarkupContent = {}));\n/**\n * The kind of a completion entry.\n */\nexport var CompletionItemKind;\n(function (CompletionItemKind) {\n    CompletionItemKind.Text = 1;\n    CompletionItemKind.Method = 2;\n    CompletionItemKind.Function = 3;\n    CompletionItemKind.Constructor = 4;\n    CompletionItemKind.Field = 5;\n    CompletionItemKind.Variable = 6;\n    CompletionItemKind.Class = 7;\n    CompletionItemKind.Interface = 8;\n    CompletionItemKind.Module = 9;\n    CompletionItemKind.Property = 10;\n    CompletionItemKind.Unit = 11;\n    CompletionItemKind.Value = 12;\n    CompletionItemKind.Enum = 13;\n    CompletionItemKind.Keyword = 14;\n    CompletionItemKind.Snippet = 15;\n    CompletionItemKind.Color = 16;\n    CompletionItemKind.File = 17;\n    CompletionItemKind.Reference = 18;\n    CompletionItemKind.Folder = 19;\n    CompletionItemKind.EnumMember = 20;\n    CompletionItemKind.Constant = 21;\n    CompletionItemKind.Struct = 22;\n    CompletionItemKind.Event = 23;\n    CompletionItemKind.Operator = 24;\n    CompletionItemKind.TypeParameter = 25;\n})(CompletionItemKind || (CompletionItemKind = {}));\n/**\n * Defines whether the insert text in a completion item should be interpreted as\n * plain text or a snippet.\n */\nexport var InsertTextFormat;\n(function (InsertTextFormat) {\n    /**\n     * The primary text to be inserted is treated as a plain string.\n     */\n    InsertTextFormat.PlainText = 1;\n    /**\n     * The primary text to be inserted is treated as a snippet.\n     *\n     * A snippet can define tab stops and placeholders with `$1`, `$2`\n     * and `${3:foo}`. `$0` defines the final tab stop, it defaults to\n     * the end of the snippet. Placeholders with equal identifiers are linked,\n     * that is typing in one will update others too.\n     *\n     * See also: https://microsoft.github.io/language-server-protocol/specifications/specification-current/#snippet_syntax\n     */\n    InsertTextFormat.Snippet = 2;\n})(InsertTextFormat || (InsertTextFormat = {}));\n/**\n * Completion item tags are extra annotations that tweak the rendering of a completion\n * item.\n *\n * @since 3.15.0\n */\nexport var CompletionItemTag;\n(function (CompletionItemTag) {\n    /**\n     * Render a completion as obsolete, usually using a strike-out.\n     */\n    CompletionItemTag.Deprecated = 1;\n})(CompletionItemTag || (CompletionItemTag = {}));\n/**\n * The InsertReplaceEdit namespace provides functions to deal with insert / replace edits.\n *\n * @since 3.16.0\n */\nexport var InsertReplaceEdit;\n(function (InsertReplaceEdit) {\n    /**\n     * Creates a new insert / replace edit\n     */\n    function create(newText, insert, replace) {\n        return { newText: newText, insert: insert, replace: replace };\n    }\n    InsertReplaceEdit.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link InsertReplaceEdit} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return candidate && Is.string(candidate.newText) && Range.is(candidate.insert) && Range.is(candidate.replace);\n    }\n    InsertReplaceEdit.is = is;\n})(InsertReplaceEdit || (InsertReplaceEdit = {}));\n/**\n * How whitespace and indentation is handled during completion\n * item insertion.\n *\n * @since 3.16.0\n */\nexport var InsertTextMode;\n(function (InsertTextMode) {\n    /**\n     * The insertion or replace strings is taken as it is. If the\n     * value is multi line the lines below the cursor will be\n     * inserted using the indentation defined in the string value.\n     * The client will not apply any kind of adjustments to the\n     * string.\n     */\n    InsertTextMode.asIs = 1;\n    /**\n     * The editor adjusts leading whitespace of new lines so that\n     * they match the indentation up to the cursor of the line for\n     * which the item is accepted.\n     *\n     * Consider a line like this: <2tabs><cursor><3tabs>foo. Accepting a\n     * multi line completion item is indented using 2 tabs and all\n     * following lines inserted will be indented using 2 tabs as well.\n     */\n    InsertTextMode.adjustIndentation = 2;\n})(InsertTextMode || (InsertTextMode = {}));\nexport var CompletionItemLabelDetails;\n(function (CompletionItemLabelDetails) {\n    function is(value) {\n        var candidate = value;\n        return candidate && (Is.string(candidate.detail) || candidate.detail === undefined) &&\n            (Is.string(candidate.description) || candidate.description === undefined);\n    }\n    CompletionItemLabelDetails.is = is;\n})(CompletionItemLabelDetails || (CompletionItemLabelDetails = {}));\n/**\n * The CompletionItem namespace provides functions to deal with\n * completion items.\n */\nexport var CompletionItem;\n(function (CompletionItem) {\n    /**\n     * Create a completion item and seed it with a label.\n     * @param label The completion item's label\n     */\n    function create(label) {\n        return { label: label };\n    }\n    CompletionItem.create = create;\n})(CompletionItem || (CompletionItem = {}));\n/**\n * The CompletionList namespace provides functions to deal with\n * completion lists.\n */\nexport var CompletionList;\n(function (CompletionList) {\n    /**\n     * Creates a new completion list.\n     *\n     * @param items The completion items.\n     * @param isIncomplete The list is not complete.\n     */\n    function create(items, isIncomplete) {\n        return { items: items ? items : [], isIncomplete: !!isIncomplete };\n    }\n    CompletionList.create = create;\n})(CompletionList || (CompletionList = {}));\nexport var MarkedString;\n(function (MarkedString) {\n    /**\n     * Creates a marked string from plain text.\n     *\n     * @param plainText The plain text.\n     */\n    function fromPlainText(plainText) {\n        return plainText.replace(/[\\\\`*_{}[\\]()#+\\-.!]/g, '\\\\$&'); // escape markdown syntax tokens: http://daringfireball.net/projects/markdown/syntax#backslash\n    }\n    MarkedString.fromPlainText = fromPlainText;\n    /**\n     * Checks whether the given value conforms to the {@link MarkedString} type.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.string(candidate) || (Is.objectLiteral(candidate) && Is.string(candidate.language) && Is.string(candidate.value));\n    }\n    MarkedString.is = is;\n})(MarkedString || (MarkedString = {}));\nexport var Hover;\n(function (Hover) {\n    /**\n     * Checks whether the given value conforms to the {@link Hover} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return !!candidate && Is.objectLiteral(candidate) && (MarkupContent.is(candidate.contents) ||\n            MarkedString.is(candidate.contents) ||\n            Is.typedArray(candidate.contents, MarkedString.is)) && (value.range === undefined || Range.is(value.range));\n    }\n    Hover.is = is;\n})(Hover || (Hover = {}));\n/**\n * The ParameterInformation namespace provides helper functions to work with\n * {@link ParameterInformation} literals.\n */\nexport var ParameterInformation;\n(function (ParameterInformation) {\n    /**\n     * Creates a new parameter information literal.\n     *\n     * @param label A label string.\n     * @param documentation A doc string.\n     */\n    function create(label, documentation) {\n        return documentation ? { label: label, documentation: documentation } : { label: label };\n    }\n    ParameterInformation.create = create;\n})(ParameterInformation || (ParameterInformation = {}));\n/**\n * The SignatureInformation namespace provides helper functions to work with\n * {@link SignatureInformation} literals.\n */\nexport var SignatureInformation;\n(function (SignatureInformation) {\n    function create(label, documentation) {\n        var parameters = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            parameters[_i - 2] = arguments[_i];\n        }\n        var result = { label: label };\n        if (Is.defined(documentation)) {\n            result.documentation = documentation;\n        }\n        if (Is.defined(parameters)) {\n            result.parameters = parameters;\n        }\n        else {\n            result.parameters = [];\n        }\n        return result;\n    }\n    SignatureInformation.create = create;\n})(SignatureInformation || (SignatureInformation = {}));\n/**\n * A document highlight kind.\n */\nexport var DocumentHighlightKind;\n(function (DocumentHighlightKind) {\n    /**\n     * A textual occurrence.\n     */\n    DocumentHighlightKind.Text = 1;\n    /**\n     * Read-access of a symbol, like reading a variable.\n     */\n    DocumentHighlightKind.Read = 2;\n    /**\n     * Write-access of a symbol, like writing to a variable.\n     */\n    DocumentHighlightKind.Write = 3;\n})(DocumentHighlightKind || (DocumentHighlightKind = {}));\n/**\n * DocumentHighlight namespace to provide helper functions to work with\n * {@link DocumentHighlight} literals.\n */\nexport var DocumentHighlight;\n(function (DocumentHighlight) {\n    /**\n     * Create a DocumentHighlight object.\n     * @param range The range the highlight applies to.\n     * @param kind The highlight kind\n     */\n    function create(range, kind) {\n        var result = { range: range };\n        if (Is.number(kind)) {\n            result.kind = kind;\n        }\n        return result;\n    }\n    DocumentHighlight.create = create;\n})(DocumentHighlight || (DocumentHighlight = {}));\n/**\n * A symbol kind.\n */\nexport var SymbolKind;\n(function (SymbolKind) {\n    SymbolKind.File = 1;\n    SymbolKind.Module = 2;\n    SymbolKind.Namespace = 3;\n    SymbolKind.Package = 4;\n    SymbolKind.Class = 5;\n    SymbolKind.Method = 6;\n    SymbolKind.Property = 7;\n    SymbolKind.Field = 8;\n    SymbolKind.Constructor = 9;\n    SymbolKind.Enum = 10;\n    SymbolKind.Interface = 11;\n    SymbolKind.Function = 12;\n    SymbolKind.Variable = 13;\n    SymbolKind.Constant = 14;\n    SymbolKind.String = 15;\n    SymbolKind.Number = 16;\n    SymbolKind.Boolean = 17;\n    SymbolKind.Array = 18;\n    SymbolKind.Object = 19;\n    SymbolKind.Key = 20;\n    SymbolKind.Null = 21;\n    SymbolKind.EnumMember = 22;\n    SymbolKind.Struct = 23;\n    SymbolKind.Event = 24;\n    SymbolKind.Operator = 25;\n    SymbolKind.TypeParameter = 26;\n})(SymbolKind || (SymbolKind = {}));\n/**\n * Symbol tags are extra annotations that tweak the rendering of a symbol.\n *\n * @since 3.16\n */\nexport var SymbolTag;\n(function (SymbolTag) {\n    /**\n     * Render a symbol as obsolete, usually using a strike-out.\n     */\n    SymbolTag.Deprecated = 1;\n})(SymbolTag || (SymbolTag = {}));\nexport var SymbolInformation;\n(function (SymbolInformation) {\n    /**\n     * Creates a new symbol information literal.\n     *\n     * @param name The name of the symbol.\n     * @param kind The kind of the symbol.\n     * @param range The range of the location of the symbol.\n     * @param uri The resource of the location of symbol.\n     * @param containerName The name of the symbol containing the symbol.\n     */\n    function create(name, kind, range, uri, containerName) {\n        var result = {\n            name: name,\n            kind: kind,\n            location: { uri: uri, range: range }\n        };\n        if (containerName) {\n            result.containerName = containerName;\n        }\n        return result;\n    }\n    SymbolInformation.create = create;\n})(SymbolInformation || (SymbolInformation = {}));\nexport var WorkspaceSymbol;\n(function (WorkspaceSymbol) {\n    /**\n     * Create a new workspace symbol.\n     *\n     * @param name The name of the symbol.\n     * @param kind The kind of the symbol.\n     * @param uri The resource of the location of the symbol.\n     * @param range An options range of the location.\n     * @returns A WorkspaceSymbol.\n     */\n    function create(name, kind, uri, range) {\n        return range !== undefined\n            ? { name: name, kind: kind, location: { uri: uri, range: range } }\n            : { name: name, kind: kind, location: { uri: uri } };\n    }\n    WorkspaceSymbol.create = create;\n})(WorkspaceSymbol || (WorkspaceSymbol = {}));\nexport var DocumentSymbol;\n(function (DocumentSymbol) {\n    /**\n     * Creates a new symbol information literal.\n     *\n     * @param name The name of the symbol.\n     * @param detail The detail of the symbol.\n     * @param kind The kind of the symbol.\n     * @param range The range of the symbol.\n     * @param selectionRange The selectionRange of the symbol.\n     * @param children Children of the symbol.\n     */\n    function create(name, detail, kind, range, selectionRange, children) {\n        var result = {\n            name: name,\n            detail: detail,\n            kind: kind,\n            range: range,\n            selectionRange: selectionRange\n        };\n        if (children !== undefined) {\n            result.children = children;\n        }\n        return result;\n    }\n    DocumentSymbol.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link DocumentSymbol} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return candidate &&\n            Is.string(candidate.name) && Is.number(candidate.kind) &&\n            Range.is(candidate.range) && Range.is(candidate.selectionRange) &&\n            (candidate.detail === undefined || Is.string(candidate.detail)) &&\n            (candidate.deprecated === undefined || Is.boolean(candidate.deprecated)) &&\n            (candidate.children === undefined || Array.isArray(candidate.children)) &&\n            (candidate.tags === undefined || Array.isArray(candidate.tags));\n    }\n    DocumentSymbol.is = is;\n})(DocumentSymbol || (DocumentSymbol = {}));\n/**\n * A set of predefined code action kinds\n */\nexport var CodeActionKind;\n(function (CodeActionKind) {\n    /**\n     * Empty kind.\n     */\n    CodeActionKind.Empty = '';\n    /**\n     * Base kind for quickfix actions: 'quickfix'\n     */\n    CodeActionKind.QuickFix = 'quickfix';\n    /**\n     * Base kind for refactoring actions: 'refactor'\n     */\n    CodeActionKind.Refactor = 'refactor';\n    /**\n     * Base kind for refactoring extraction actions: 'refactor.extract'\n     *\n     * Example extract actions:\n     *\n     * - Extract method\n     * - Extract function\n     * - Extract variable\n     * - Extract interface from class\n     * - ...\n     */\n    CodeActionKind.RefactorExtract = 'refactor.extract';\n    /**\n     * Base kind for refactoring inline actions: 'refactor.inline'\n     *\n     * Example inline actions:\n     *\n     * - Inline function\n     * - Inline variable\n     * - Inline constant\n     * - ...\n     */\n    CodeActionKind.RefactorInline = 'refactor.inline';\n    /**\n     * Base kind for refactoring rewrite actions: 'refactor.rewrite'\n     *\n     * Example rewrite actions:\n     *\n     * - Convert JavaScript function to class\n     * - Add or remove parameter\n     * - Encapsulate field\n     * - Make method static\n     * - Move method to base class\n     * - ...\n     */\n    CodeActionKind.RefactorRewrite = 'refactor.rewrite';\n    /**\n     * Base kind for source actions: `source`\n     *\n     * Source code actions apply to the entire file.\n     */\n    CodeActionKind.Source = 'source';\n    /**\n     * Base kind for an organize imports source action: `source.organizeImports`\n     */\n    CodeActionKind.SourceOrganizeImports = 'source.organizeImports';\n    /**\n     * Base kind for auto-fix source actions: `source.fixAll`.\n     *\n     * Fix all actions automatically fix errors that have a clear fix that do not require user input.\n     * They should not suppress errors or perform unsafe fixes such as generating new types or classes.\n     *\n     * @since 3.15.0\n     */\n    CodeActionKind.SourceFixAll = 'source.fixAll';\n})(CodeActionKind || (CodeActionKind = {}));\n/**\n * The reason why code actions were requested.\n *\n * @since 3.17.0\n */\nexport var CodeActionTriggerKind;\n(function (CodeActionTriggerKind) {\n    /**\n     * Code actions were explicitly requested by the user or by an extension.\n     */\n    CodeActionTriggerKind.Invoked = 1;\n    /**\n     * Code actions were requested automatically.\n     *\n     * This typically happens when current selection in a file changes, but can\n     * also be triggered when file content changes.\n     */\n    CodeActionTriggerKind.Automatic = 2;\n})(CodeActionTriggerKind || (CodeActionTriggerKind = {}));\n/**\n * The CodeActionContext namespace provides helper functions to work with\n * {@link CodeActionContext} literals.\n */\nexport var CodeActionContext;\n(function (CodeActionContext) {\n    /**\n     * Creates a new CodeActionContext literal.\n     */\n    function create(diagnostics, only, triggerKind) {\n        var result = { diagnostics: diagnostics };\n        if (only !== undefined && only !== null) {\n            result.only = only;\n        }\n        if (triggerKind !== undefined && triggerKind !== null) {\n            result.triggerKind = triggerKind;\n        }\n        return result;\n    }\n    CodeActionContext.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link CodeActionContext} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Is.typedArray(candidate.diagnostics, Diagnostic.is)\n            && (candidate.only === undefined || Is.typedArray(candidate.only, Is.string))\n            && (candidate.triggerKind === undefined || candidate.triggerKind === CodeActionTriggerKind.Invoked || candidate.triggerKind === CodeActionTriggerKind.Automatic);\n    }\n    CodeActionContext.is = is;\n})(CodeActionContext || (CodeActionContext = {}));\nexport var CodeAction;\n(function (CodeAction) {\n    function create(title, kindOrCommandOrEdit, kind) {\n        var result = { title: title };\n        var checkKind = true;\n        if (typeof kindOrCommandOrEdit === 'string') {\n            checkKind = false;\n            result.kind = kindOrCommandOrEdit;\n        }\n        else if (Command.is(kindOrCommandOrEdit)) {\n            result.command = kindOrCommandOrEdit;\n        }\n        else {\n            result.edit = kindOrCommandOrEdit;\n        }\n        if (checkKind && kind !== undefined) {\n            result.kind = kind;\n        }\n        return result;\n    }\n    CodeAction.create = create;\n    function is(value) {\n        var candidate = value;\n        return candidate && Is.string(candidate.title) &&\n            (candidate.diagnostics === undefined || Is.typedArray(candidate.diagnostics, Diagnostic.is)) &&\n            (candidate.kind === undefined || Is.string(candidate.kind)) &&\n            (candidate.edit !== undefined || candidate.command !== undefined) &&\n            (candidate.command === undefined || Command.is(candidate.command)) &&\n            (candidate.isPreferred === undefined || Is.boolean(candidate.isPreferred)) &&\n            (candidate.edit === undefined || WorkspaceEdit.is(candidate.edit));\n    }\n    CodeAction.is = is;\n})(CodeAction || (CodeAction = {}));\n/**\n * The CodeLens namespace provides helper functions to work with\n * {@link CodeLens} literals.\n */\nexport var CodeLens;\n(function (CodeLens) {\n    /**\n     * Creates a new CodeLens literal.\n     */\n    function create(range, data) {\n        var result = { range: range };\n        if (Is.defined(data)) {\n            result.data = data;\n        }\n        return result;\n    }\n    CodeLens.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link CodeLens} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.undefined(candidate.command) || Command.is(candidate.command));\n    }\n    CodeLens.is = is;\n})(CodeLens || (CodeLens = {}));\n/**\n * The FormattingOptions namespace provides helper functions to work with\n * {@link FormattingOptions} literals.\n */\nexport var FormattingOptions;\n(function (FormattingOptions) {\n    /**\n     * Creates a new FormattingOptions literal.\n     */\n    function create(tabSize, insertSpaces) {\n        return { tabSize: tabSize, insertSpaces: insertSpaces };\n    }\n    FormattingOptions.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link FormattingOptions} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Is.uinteger(candidate.tabSize) && Is.boolean(candidate.insertSpaces);\n    }\n    FormattingOptions.is = is;\n})(FormattingOptions || (FormattingOptions = {}));\n/**\n * The DocumentLink namespace provides helper functions to work with\n * {@link DocumentLink} literals.\n */\nexport var DocumentLink;\n(function (DocumentLink) {\n    /**\n     * Creates a new DocumentLink literal.\n     */\n    function create(range, target, data) {\n        return { range: range, target: target, data: data };\n    }\n    DocumentLink.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link DocumentLink} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.undefined(candidate.target) || Is.string(candidate.target));\n    }\n    DocumentLink.is = is;\n})(DocumentLink || (DocumentLink = {}));\n/**\n * The SelectionRange namespace provides helper function to work with\n * SelectionRange literals.\n */\nexport var SelectionRange;\n(function (SelectionRange) {\n    /**\n     * Creates a new SelectionRange\n     * @param range the range.\n     * @param parent an optional parent.\n     */\n    function create(range, parent) {\n        return { range: range, parent: parent };\n    }\n    SelectionRange.create = create;\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Range.is(candidate.range) && (candidate.parent === undefined || SelectionRange.is(candidate.parent));\n    }\n    SelectionRange.is = is;\n})(SelectionRange || (SelectionRange = {}));\n/**\n * A set of predefined token types. This set is not fixed\n * an clients can specify additional token types via the\n * corresponding client capabilities.\n *\n * @since 3.16.0\n */\nexport var SemanticTokenTypes;\n(function (SemanticTokenTypes) {\n    SemanticTokenTypes[\"namespace\"] = \"namespace\";\n    /**\n     * Represents a generic type. Acts as a fallback for types which can't be mapped to\n     * a specific type like class or enum.\n     */\n    SemanticTokenTypes[\"type\"] = \"type\";\n    SemanticTokenTypes[\"class\"] = \"class\";\n    SemanticTokenTypes[\"enum\"] = \"enum\";\n    SemanticTokenTypes[\"interface\"] = \"interface\";\n    SemanticTokenTypes[\"struct\"] = \"struct\";\n    SemanticTokenTypes[\"typeParameter\"] = \"typeParameter\";\n    SemanticTokenTypes[\"parameter\"] = \"parameter\";\n    SemanticTokenTypes[\"variable\"] = \"variable\";\n    SemanticTokenTypes[\"property\"] = \"property\";\n    SemanticTokenTypes[\"enumMember\"] = \"enumMember\";\n    SemanticTokenTypes[\"event\"] = \"event\";\n    SemanticTokenTypes[\"function\"] = \"function\";\n    SemanticTokenTypes[\"method\"] = \"method\";\n    SemanticTokenTypes[\"macro\"] = \"macro\";\n    SemanticTokenTypes[\"keyword\"] = \"keyword\";\n    SemanticTokenTypes[\"modifier\"] = \"modifier\";\n    SemanticTokenTypes[\"comment\"] = \"comment\";\n    SemanticTokenTypes[\"string\"] = \"string\";\n    SemanticTokenTypes[\"number\"] = \"number\";\n    SemanticTokenTypes[\"regexp\"] = \"regexp\";\n    SemanticTokenTypes[\"operator\"] = \"operator\";\n    /**\n     * @since 3.17.0\n     */\n    SemanticTokenTypes[\"decorator\"] = \"decorator\";\n})(SemanticTokenTypes || (SemanticTokenTypes = {}));\n/**\n * A set of predefined token modifiers. This set is not fixed\n * an clients can specify additional token types via the\n * corresponding client capabilities.\n *\n * @since 3.16.0\n */\nexport var SemanticTokenModifiers;\n(function (SemanticTokenModifiers) {\n    SemanticTokenModifiers[\"declaration\"] = \"declaration\";\n    SemanticTokenModifiers[\"definition\"] = \"definition\";\n    SemanticTokenModifiers[\"readonly\"] = \"readonly\";\n    SemanticTokenModifiers[\"static\"] = \"static\";\n    SemanticTokenModifiers[\"deprecated\"] = \"deprecated\";\n    SemanticTokenModifiers[\"abstract\"] = \"abstract\";\n    SemanticTokenModifiers[\"async\"] = \"async\";\n    SemanticTokenModifiers[\"modification\"] = \"modification\";\n    SemanticTokenModifiers[\"documentation\"] = \"documentation\";\n    SemanticTokenModifiers[\"defaultLibrary\"] = \"defaultLibrary\";\n})(SemanticTokenModifiers || (SemanticTokenModifiers = {}));\n/**\n * @since 3.16.0\n */\nexport var SemanticTokens;\n(function (SemanticTokens) {\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && (candidate.resultId === undefined || typeof candidate.resultId === 'string') &&\n            Array.isArray(candidate.data) && (candidate.data.length === 0 || typeof candidate.data[0] === 'number');\n    }\n    SemanticTokens.is = is;\n})(SemanticTokens || (SemanticTokens = {}));\n/**\n * The InlineValueText namespace provides functions to deal with InlineValueTexts.\n *\n * @since 3.17.0\n */\nexport var InlineValueText;\n(function (InlineValueText) {\n    /**\n     * Creates a new InlineValueText literal.\n     */\n    function create(range, text) {\n        return { range: range, text: text };\n    }\n    InlineValueText.create = create;\n    function is(value) {\n        var candidate = value;\n        return candidate !== undefined && candidate !== null && Range.is(candidate.range) && Is.string(candidate.text);\n    }\n    InlineValueText.is = is;\n})(InlineValueText || (InlineValueText = {}));\n/**\n * The InlineValueVariableLookup namespace provides functions to deal with InlineValueVariableLookups.\n *\n * @since 3.17.0\n */\nexport var InlineValueVariableLookup;\n(function (InlineValueVariableLookup) {\n    /**\n     * Creates a new InlineValueText literal.\n     */\n    function create(range, variableName, caseSensitiveLookup) {\n        return { range: range, variableName: variableName, caseSensitiveLookup: caseSensitiveLookup };\n    }\n    InlineValueVariableLookup.create = create;\n    function is(value) {\n        var candidate = value;\n        return candidate !== undefined && candidate !== null && Range.is(candidate.range) && Is.boolean(candidate.caseSensitiveLookup)\n            && (Is.string(candidate.variableName) || candidate.variableName === undefined);\n    }\n    InlineValueVariableLookup.is = is;\n})(InlineValueVariableLookup || (InlineValueVariableLookup = {}));\n/**\n * The InlineValueEvaluatableExpression namespace provides functions to deal with InlineValueEvaluatableExpression.\n *\n * @since 3.17.0\n */\nexport var InlineValueEvaluatableExpression;\n(function (InlineValueEvaluatableExpression) {\n    /**\n     * Creates a new InlineValueEvaluatableExpression literal.\n     */\n    function create(range, expression) {\n        return { range: range, expression: expression };\n    }\n    InlineValueEvaluatableExpression.create = create;\n    function is(value) {\n        var candidate = value;\n        return candidate !== undefined && candidate !== null && Range.is(candidate.range)\n            && (Is.string(candidate.expression) || candidate.expression === undefined);\n    }\n    InlineValueEvaluatableExpression.is = is;\n})(InlineValueEvaluatableExpression || (InlineValueEvaluatableExpression = {}));\n/**\n * The InlineValueContext namespace provides helper functions to work with\n * {@link InlineValueContext} literals.\n *\n * @since 3.17.0\n */\nexport var InlineValueContext;\n(function (InlineValueContext) {\n    /**\n     * Creates a new InlineValueContext literal.\n     */\n    function create(frameId, stoppedLocation) {\n        return { frameId: frameId, stoppedLocation: stoppedLocation };\n    }\n    InlineValueContext.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link InlineValueContext} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Range.is(value.stoppedLocation);\n    }\n    InlineValueContext.is = is;\n})(InlineValueContext || (InlineValueContext = {}));\n/**\n * Inlay hint kinds.\n *\n * @since 3.17.0\n */\nexport var InlayHintKind;\n(function (InlayHintKind) {\n    /**\n     * An inlay hint that for a type annotation.\n     */\n    InlayHintKind.Type = 1;\n    /**\n     * An inlay hint that is for a parameter.\n     */\n    InlayHintKind.Parameter = 2;\n    function is(value) {\n        return value === 1 || value === 2;\n    }\n    InlayHintKind.is = is;\n})(InlayHintKind || (InlayHintKind = {}));\nexport var InlayHintLabelPart;\n(function (InlayHintLabelPart) {\n    function create(value) {\n        return { value: value };\n    }\n    InlayHintLabelPart.create = create;\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate)\n            && (candidate.tooltip === undefined || Is.string(candidate.tooltip) || MarkupContent.is(candidate.tooltip))\n            && (candidate.location === undefined || Location.is(candidate.location))\n            && (candidate.command === undefined || Command.is(candidate.command));\n    }\n    InlayHintLabelPart.is = is;\n})(InlayHintLabelPart || (InlayHintLabelPart = {}));\nexport var InlayHint;\n(function (InlayHint) {\n    function create(position, label, kind) {\n        var result = { position: position, label: label };\n        if (kind !== undefined) {\n            result.kind = kind;\n        }\n        return result;\n    }\n    InlayHint.create = create;\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && Position.is(candidate.position)\n            && (Is.string(candidate.label) || Is.typedArray(candidate.label, InlayHintLabelPart.is))\n            && (candidate.kind === undefined || InlayHintKind.is(candidate.kind))\n            && (candidate.textEdits === undefined) || Is.typedArray(candidate.textEdits, TextEdit.is)\n            && (candidate.tooltip === undefined || Is.string(candidate.tooltip) || MarkupContent.is(candidate.tooltip))\n            && (candidate.paddingLeft === undefined || Is.boolean(candidate.paddingLeft))\n            && (candidate.paddingRight === undefined || Is.boolean(candidate.paddingRight));\n    }\n    InlayHint.is = is;\n})(InlayHint || (InlayHint = {}));\nexport var WorkspaceFolder;\n(function (WorkspaceFolder) {\n    function is(value) {\n        var candidate = value;\n        return Is.objectLiteral(candidate) && URI.is(candidate.uri) && Is.string(candidate.name);\n    }\n    WorkspaceFolder.is = is;\n})(WorkspaceFolder || (WorkspaceFolder = {}));\nexport var EOL = ['\\n', '\\r\\n', '\\r'];\n/**\n * @deprecated Use the text document from the new vscode-languageserver-textdocument package.\n */\nexport var TextDocument;\n(function (TextDocument) {\n    /**\n     * Creates a new ITextDocument literal from the given uri and content.\n     * @param uri The document's uri.\n     * @param languageId The document's language Id.\n     * @param version The document's version.\n     * @param content The document's content.\n     */\n    function create(uri, languageId, version, content) {\n        return new FullTextDocument(uri, languageId, version, content);\n    }\n    TextDocument.create = create;\n    /**\n     * Checks whether the given literal conforms to the {@link ITextDocument} interface.\n     */\n    function is(value) {\n        var candidate = value;\n        return Is.defined(candidate) && Is.string(candidate.uri) && (Is.undefined(candidate.languageId) || Is.string(candidate.languageId)) && Is.uinteger(candidate.lineCount)\n            && Is.func(candidate.getText) && Is.func(candidate.positionAt) && Is.func(candidate.offsetAt) ? true : false;\n    }\n    TextDocument.is = is;\n    function applyEdits(document, edits) {\n        var text = document.getText();\n        var sortedEdits = mergeSort(edits, function (a, b) {\n            var diff = a.range.start.line - b.range.start.line;\n            if (diff === 0) {\n                return a.range.start.character - b.range.start.character;\n            }\n            return diff;\n        });\n        var lastModifiedOffset = text.length;\n        for (var i = sortedEdits.length - 1; i >= 0; i--) {\n            var e = sortedEdits[i];\n            var startOffset = document.offsetAt(e.range.start);\n            var endOffset = document.offsetAt(e.range.end);\n            if (endOffset <= lastModifiedOffset) {\n                text = text.substring(0, startOffset) + e.newText + text.substring(endOffset, text.length);\n            }\n            else {\n                throw new Error('Overlapping edit');\n            }\n            lastModifiedOffset = startOffset;\n        }\n        return text;\n    }\n    TextDocument.applyEdits = applyEdits;\n    function mergeSort(data, compare) {\n        if (data.length <= 1) {\n            // sorted\n            return data;\n        }\n        var p = (data.length / 2) | 0;\n        var left = data.slice(0, p);\n        var right = data.slice(p);\n        mergeSort(left, compare);\n        mergeSort(right, compare);\n        var leftIdx = 0;\n        var rightIdx = 0;\n        var i = 0;\n        while (leftIdx < left.length && rightIdx < right.length) {\n            var ret = compare(left[leftIdx], right[rightIdx]);\n            if (ret <= 0) {\n                // smaller_equal -> take left to preserve order\n                data[i++] = left[leftIdx++];\n            }\n            else {\n                // greater -> take right\n                data[i++] = right[rightIdx++];\n            }\n        }\n        while (leftIdx < left.length) {\n            data[i++] = left[leftIdx++];\n        }\n        while (rightIdx < right.length) {\n            data[i++] = right[rightIdx++];\n        }\n        return data;\n    }\n})(TextDocument || (TextDocument = {}));\n/**\n * @deprecated Use the text document from the new vscode-languageserver-textdocument package.\n */\nvar FullTextDocument = /** @class */ (function () {\n    function FullTextDocument(uri, languageId, version, content) {\n        this._uri = uri;\n        this._languageId = languageId;\n        this._version = version;\n        this._content = content;\n        this._lineOffsets = undefined;\n    }\n    Object.defineProperty(FullTextDocument.prototype, \"uri\", {\n        get: function () {\n            return this._uri;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FullTextDocument.prototype, \"languageId\", {\n        get: function () {\n            return this._languageId;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FullTextDocument.prototype, \"version\", {\n        get: function () {\n            return this._version;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    FullTextDocument.prototype.getText = function (range) {\n        if (range) {\n            var start = this.offsetAt(range.start);\n            var end = this.offsetAt(range.end);\n            return this._content.substring(start, end);\n        }\n        return this._content;\n    };\n    FullTextDocument.prototype.update = function (event, version) {\n        this._content = event.text;\n        this._version = version;\n        this._lineOffsets = undefined;\n    };\n    FullTextDocument.prototype.getLineOffsets = function () {\n        if (this._lineOffsets === undefined) {\n            var lineOffsets = [];\n            var text = this._content;\n            var isLineStart = true;\n            for (var i = 0; i < text.length; i++) {\n                if (isLineStart) {\n                    lineOffsets.push(i);\n                    isLineStart = false;\n                }\n                var ch = text.charAt(i);\n                isLineStart = (ch === '\\r' || ch === '\\n');\n                if (ch === '\\r' && i + 1 < text.length && text.charAt(i + 1) === '\\n') {\n                    i++;\n                }\n            }\n            if (isLineStart && text.length > 0) {\n                lineOffsets.push(text.length);\n            }\n            this._lineOffsets = lineOffsets;\n        }\n        return this._lineOffsets;\n    };\n    FullTextDocument.prototype.positionAt = function (offset) {\n        offset = Math.max(Math.min(offset, this._content.length), 0);\n        var lineOffsets = this.getLineOffsets();\n        var low = 0, high = lineOffsets.length;\n        if (high === 0) {\n            return Position.create(0, offset);\n        }\n        while (low < high) {\n            var mid = Math.floor((low + high) / 2);\n            if (lineOffsets[mid] > offset) {\n                high = mid;\n            }\n            else {\n                low = mid + 1;\n            }\n        }\n        // low is the least x for which the line offset is larger than the current offset\n        // or array.length if no line offset is larger than the current offset\n        var line = low - 1;\n        return Position.create(line, offset - lineOffsets[line]);\n    };\n    FullTextDocument.prototype.offsetAt = function (position) {\n        var lineOffsets = this.getLineOffsets();\n        if (position.line >= lineOffsets.length) {\n            return this._content.length;\n        }\n        else if (position.line < 0) {\n            return 0;\n        }\n        var lineOffset = lineOffsets[position.line];\n        var nextLineOffset = (position.line + 1 < lineOffsets.length) ? lineOffsets[position.line + 1] : this._content.length;\n        return Math.max(Math.min(lineOffset + position.character, nextLineOffset), lineOffset);\n    };\n    Object.defineProperty(FullTextDocument.prototype, \"lineCount\", {\n        get: function () {\n            return this.getLineOffsets().length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return FullTextDocument;\n}());\nvar Is;\n(function (Is) {\n    var toString = Object.prototype.toString;\n    function defined(value) {\n        return typeof value !== 'undefined';\n    }\n    Is.defined = defined;\n    function undefined(value) {\n        return typeof value === 'undefined';\n    }\n    Is.undefined = undefined;\n    function boolean(value) {\n        return value === true || value === false;\n    }\n    Is.boolean = boolean;\n    function string(value) {\n        return toString.call(value) === '[object String]';\n    }\n    Is.string = string;\n    function number(value) {\n        return toString.call(value) === '[object Number]';\n    }\n    Is.number = number;\n    function numberRange(value, min, max) {\n        return toString.call(value) === '[object Number]' && min <= value && value <= max;\n    }\n    Is.numberRange = numberRange;\n    function integer(value) {\n        return toString.call(value) === '[object Number]' && -2147483648 <= value && value <= 2147483647;\n    }\n    Is.integer = integer;\n    function uinteger(value) {\n        return toString.call(value) === '[object Number]' && 0 <= value && value <= 2147483647;\n    }\n    Is.uinteger = uinteger;\n    function func(value) {\n        return toString.call(value) === '[object Function]';\n    }\n    Is.func = func;\n    function objectLiteral(value) {\n        // Strictly speaking class instances pass this check as well. Since the LSP\n        // doesn't use classes we ignore this for now. If we do we need to add something\n        // like this: `Object.getPrototypeOf(Object.getPrototypeOf(x)) === null`\n        return value !== null && typeof value === 'object';\n    }\n    Is.objectLiteral = objectLiteral;\n    function typedArray(value, check) {\n        return Array.isArray(value) && value.every(check);\n    }\n    Is.typedArray = typedArray;\n})(Is || (Is = {}));\n","import * as lsProtocol from 'vscode-languageserver-types';\nimport { until_ready } from '../../utils';\nexport class LazyCompletionItem {\n    constructor(\n    /**\n     * Type of this completion item.\n     */\n    type, \n    /**\n     * LabIcon object for icon to be rendered with completion type.\n     */\n    icon, match, connector, uri) {\n        this.type = type;\n        this.icon = icon;\n        this.match = match;\n        this.connector = connector;\n        this.uri = uri;\n        this.label = match.label;\n        this._setDocumentation(match.documentation);\n        this._requested_resolution = false;\n        this._resolved = false;\n        this._detail = match.detail;\n        this.self = this;\n    }\n    get isDocumentationMarkdown() {\n        return this._is_documentation_markdown;\n    }\n    _setDocumentation(documentation) {\n        if (lsProtocol.MarkupContent.is(documentation)) {\n            this._documentation = documentation.value;\n            this._is_documentation_markdown = documentation.kind === 'markdown';\n        }\n        else {\n            this._documentation = documentation;\n            this._is_documentation_markdown = false;\n        }\n    }\n    /**\n     * Completion to be inserted.\n     */\n    get insertText() {\n        return this._currentInsertText || this.match.insertText || this.match.label;\n    }\n    set insertText(text) {\n        this._currentInsertText = text;\n    }\n    get sortText() {\n        return this.match.sortText || this.match.label;\n    }\n    get filterText() {\n        return this.match.filterText;\n    }\n    supportsResolution() {\n        const connection = this.connector.get_connection(this.uri);\n        return connection != null && connection.isCompletionResolveProvider();\n    }\n    get detail() {\n        return this._detail;\n    }\n    needsResolution() {\n        if (this.documentation) {\n            return false;\n        }\n        if (this._resolved) {\n            return false;\n        }\n        if (this._requested_resolution) {\n            return false;\n        }\n        return this.supportsResolution();\n    }\n    isResolved() {\n        return this._resolved;\n    }\n    /**\n     * Resolve (fetch) details such as documentation.\n     */\n    resolve() {\n        if (this._resolved) {\n            return Promise.resolve(this);\n        }\n        if (!this.supportsResolution()) {\n            return Promise.resolve(this);\n        }\n        if (this._requested_resolution) {\n            return until_ready(() => this._resolved, 100, 50).then(() => this);\n        }\n        const connection = this.connector.get_connection(this.uri);\n        this._requested_resolution = true;\n        return connection\n            .getCompletionResolve(this.match)\n            .then(resolvedCompletionItem => {\n            if (resolvedCompletionItem === null) {\n                return resolvedCompletionItem;\n            }\n            this._setDocumentation(resolvedCompletionItem === null || resolvedCompletionItem === void 0 ? void 0 : resolvedCompletionItem.documentation);\n            this._detail = resolvedCompletionItem === null || resolvedCompletionItem === void 0 ? void 0 : resolvedCompletionItem.detail;\n            // TODO: implement in pyls and enable with proper LSP communication\n            // this.label = resolvedCompletionItem.label;\n            this._resolved = true;\n            return this;\n        });\n    }\n    /**\n     * A human-readable string with additional information\n     * about this item, like type or symbol information.\n     */\n    get documentation() {\n        if (!this.connector.should_show_documentation) {\n            return undefined;\n        }\n        if (this._documentation) {\n            return this._documentation;\n        }\n        return undefined;\n    }\n    /**\n     * Indicates if the item is deprecated.\n     */\n    get deprecated() {\n        if (this.match.deprecated) {\n            return this.match.deprecated;\n        }\n        return (this.match.tags != null &&\n            this.match.tags.some(tag => tag == lsProtocol.CompletionItemTag.Deprecated));\n    }\n}\n//# sourceMappingURL=item.js.map","import { CompletionConnector, CompletionHandler, ContextConnector, KernelConnector } from '@jupyterlab/completer';\nimport { KernelKind } from '@krassowski/completion-theme/lib/types';\nimport { PositionConverter } from '../../converter';\nimport { AdditionalCompletionTriggerKinds, CompletionItemKind, CompletionTriggerKind } from '../../lsp';\nimport { LazyCompletionItem } from './item';\nvar ICompletionItemsResponseType = CompletionHandler.ICompletionItemsResponseType;\n/**\n * A LSP connector for completion handlers.\n */\nexport class LSPConnector {\n    /**\n     * Create a new LSP connector for completion requests.\n     *\n     * @param options - The instantiation options for the LSP connector.\n     */\n    constructor(options) {\n        this.options = options;\n        this.isDisposed = false;\n        // signal that this is the new type connector (providing completion items)\n        this.responseType = ICompletionItemsResponseType;\n        this._editor = options.editor;\n        this._connections = options.connections;\n        this.virtual_editor = options.virtual_editor;\n        this._context_connector = new ContextConnector({ editor: options.editor });\n        if (options.session) {\n            let kernel_options = { editor: options.editor, session: options.session };\n            this._kernel_connector = new KernelConnector(kernel_options);\n            this._kernel_and_context_connector = new CompletionConnector(kernel_options);\n        }\n        this.lab_integration = options.labIntegration;\n        this.console = options.console;\n    }\n    get kernel_completions_first() {\n        return this.options.settings.composite.kernelCompletionsFirst;\n    }\n    get use_lsp_completions() {\n        return (this.options.settings.composite.disableCompletionsFrom.indexOf('LSP') ==\n            -1);\n    }\n    get use_kernel_completions() {\n        return (this.options.settings.composite.disableCompletionsFrom.indexOf('Kernel') == -1);\n    }\n    get suppress_continuous_hinting_in() {\n        return this.options.settings.composite.suppressContinuousHintingIn;\n    }\n    get suppress_trigger_character_in() {\n        return this.options.settings.composite.suppressTriggerCharacterIn;\n    }\n    get should_show_documentation() {\n        return this.options.settings.composite.showDocumentation;\n    }\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this._connections = null;\n        this.virtual_editor = null;\n        this._context_connector = null;\n        this._kernel_connector = null;\n        this._kernel_and_context_connector = null;\n        this.options = null;\n        this._editor = null;\n        this.isDisposed = true;\n    }\n    get _has_kernel() {\n        var _a;\n        return ((_a = this.options.session) === null || _a === void 0 ? void 0 : _a.kernel) != null;\n    }\n    get _is_kernel_idle() {\n        var _a, _b;\n        return ((_b = (_a = this.options.session) === null || _a === void 0 ? void 0 : _a.kernel) === null || _b === void 0 ? void 0 : _b.status) == 'idle';\n    }\n    get _should_wait_for_busy_kernel() {\n        return this.lab_integration.settings.composite.waitForBusyKernel;\n    }\n    async _kernel_language() {\n        return (await this.options.session.kernel.info).language_info.name;\n    }\n    get _kernel_timeout() {\n        return this.lab_integration.settings.composite.kernelResponseTimeout;\n    }\n    get fallback_connector() {\n        return this._kernel_and_context_connector\n            ? this._kernel_and_context_connector\n            : this._context_connector;\n    }\n    transform_from_editor_to_root(position) {\n        let editor_position = PositionConverter.ce_to_cm(position);\n        return this.virtual_editor.transform_from_editor_to_root(this._editor, editor_position);\n    }\n    /**\n     * Fetch completion requests.\n     *\n     * @param request - The completion request text and details.\n     */\n    async fetch(request) {\n        let editor = this._editor;\n        const cursor = editor.getCursorPosition();\n        const token = editor.getTokenForPosition(cursor);\n        if (this.trigger_kind == AdditionalCompletionTriggerKinds.AutoInvoked) {\n            if (token.type &&\n                this.suppress_continuous_hinting_in.indexOf(token.type) !== -1) {\n                this.console.debug('Suppressing completer auto-invoke in', token.type);\n                this.trigger_kind = CompletionTriggerKind.Invoked;\n                return;\n            }\n        }\n        else if (this.trigger_kind == CompletionTriggerKind.TriggerCharacter) {\n            if (token.type &&\n                this.suppress_trigger_character_in.indexOf(token.type) !== -1) {\n                this.console.debug('Suppressing completer auto-invoke in', token.type);\n                this.trigger_kind = CompletionTriggerKind.Invoked;\n                return;\n            }\n        }\n        const start = editor.getPositionAt(token.offset);\n        const end = editor.getPositionAt(token.offset + token.value.length);\n        let position_in_token = cursor.column - start.column - 1;\n        const typed_character = token.value[cursor.column - start.column - 1];\n        let start_in_root = this.transform_from_editor_to_root(start);\n        let end_in_root = this.transform_from_editor_to_root(end);\n        let cursor_in_root = this.transform_from_editor_to_root(cursor);\n        let virtual_editor = this.virtual_editor;\n        // find document for position\n        let document = virtual_editor.document_at_root_position(start_in_root);\n        let virtual_start = virtual_editor.root_position_to_virtual_position(start_in_root);\n        let virtual_end = virtual_editor.root_position_to_virtual_position(end_in_root);\n        let virtual_cursor = virtual_editor.root_position_to_virtual_position(cursor_in_root);\n        const lsp_promise = this.use_lsp_completions\n            ? this.fetch_lsp(token, typed_character, virtual_start, virtual_end, virtual_cursor, document, position_in_token)\n            : Promise.resolve(undefined);\n        let promise = null;\n        try {\n            const kernelTimeout = this._kernel_timeout;\n            if (this.use_kernel_completions &&\n                this._kernel_connector &&\n                this._has_kernel &&\n                (this._is_kernel_idle || this._should_wait_for_busy_kernel) &&\n                kernelTimeout != 0) {\n                // TODO: this would be awesome if we could connect to rpy2 for R suggestions in Python,\n                //  but this is not the job of this extension; nevertheless its better to keep this in\n                //  mind to avoid introducing design decisions which would make this impossible\n                //  (for other extensions)\n                // TODO: should it be cashed?\n                const kernelLanguage = await this._kernel_language();\n                if (document.language.toLocaleLowerCase() === kernelLanguage.toLowerCase()) {\n                    let default_kernel_promise = this._kernel_connector.fetch(request);\n                    let kernel_promise;\n                    if (kernelTimeout == -1) {\n                        kernel_promise = default_kernel_promise;\n                    }\n                    else {\n                        // implement timeout for the kernel response using Promise.race:\n                        // an empty completion result will resolve after the timeout\n                        // if actual kernel response does not beat it to it\n                        kernel_promise = Promise.race([\n                            default_kernel_promise,\n                            new Promise(resolve => {\n                                return setTimeout(() => resolve({\n                                    start: 0,\n                                    end: 0,\n                                    matches: [],\n                                    metadata: {}\n                                }), kernelTimeout);\n                            })\n                        ]);\n                    }\n                    promise = Promise.all([\n                        kernel_promise.catch(p => p),\n                        lsp_promise.catch(p => p)\n                    ]).then(([kernel, lsp]) => {\n                        let replies = [];\n                        if (kernel != null) {\n                            replies.push(this.transform_reply(kernel));\n                        }\n                        if (lsp != null) {\n                            replies.push(lsp);\n                        }\n                        return this.merge_replies(replies, this._editor);\n                    });\n                }\n            }\n            if (!promise) {\n                promise = lsp_promise.catch(e => {\n                    this.console.warn('hint failed', e);\n                    return this.fallback_connector\n                        .fetch(request)\n                        .then(this.transform_reply);\n                });\n            }\n        }\n        catch (e) {\n            this.console.warn('kernel completions failed', e);\n            promise = this.fallback_connector\n                .fetch(request)\n                .then(this.transform_reply);\n        }\n        this.console.debug('All promises set up and ready.');\n        return promise.then(reply => {\n            reply = this.suppress_if_needed(reply, token, cursor);\n            if (reply) {\n                this.items = reply.items;\n            }\n            this.trigger_kind = CompletionTriggerKind.Invoked;\n            return reply;\n        });\n    }\n    get_connection(uri) {\n        return this._connections.get(uri);\n    }\n    async fetch_lsp(token, typed_character, start, end, cursor, document, position_in_token) {\n        let connection = this.get_connection(document.uri);\n        this.console.debug('Fetching');\n        this.console.debug('Token:', token, start, end);\n        const trigger_kind = this.trigger_kind == AdditionalCompletionTriggerKinds.AutoInvoked\n            ? CompletionTriggerKind.Invoked\n            : this.trigger_kind;\n        let lspCompletionItems = ((await connection.getCompletion(cursor, {\n            start,\n            end,\n            text: token.value\n        }, document.document_info, false, typed_character, trigger_kind)) || []);\n        this.console.debug('Transforming');\n        let prefix = token.value.slice(0, position_in_token + 1);\n        let all_non_prefixed = true;\n        let items = [];\n        lspCompletionItems.forEach(match => {\n            let kind = match.kind ? CompletionItemKind[match.kind] : '';\n            // Update prefix values\n            let text = match.insertText ? match.insertText : match.label;\n            // declare prefix presence if needed and update it\n            if (text.toLowerCase().startsWith(prefix.toLowerCase())) {\n                all_non_prefixed = false;\n                if (prefix !== token.value) {\n                    if (text.toLowerCase().startsWith(token.value.toLowerCase())) {\n                        // given a completion insert text \"display_table\" and two test cases:\n                        // disp<tab>data   display_table<cursor>data\n                        // disp<tab>lay    display_table<cursor>\n                        // we have to adjust the prefix for the latter (otherwise we would get display_table<cursor>lay),\n                        // as we are constrained NOT to replace after the prefix (which would be \"disp\" otherwise)\n                        prefix = token.value;\n                    }\n                }\n            }\n            // add prefix if needed\n            else if (token.type === 'string' && prefix.includes('/')) {\n                // special case for path completion in strings, ensuring that:\n                //     '/Com<tab>  '/Completion.ipynb\n                // when the returned insert text is `Completion.ipynb` (the token here is `'/Com`)\n                // developed against pyls and pylsp server, may not work well in other cases\n                const parts = prefix.split('/');\n                if (text.toLowerCase().startsWith(parts[parts.length - 1].toLowerCase())) {\n                    let pathPrefix = parts.slice(0, -1).join('/') + '/';\n                    match.insertText = pathPrefix + match.insertText;\n                    // for label removing the prefix quote if present\n                    if (pathPrefix.startsWith(\"'\") || pathPrefix.startsWith('\"')) {\n                        pathPrefix = pathPrefix.substr(1);\n                    }\n                    match.label = pathPrefix + match.label;\n                    all_non_prefixed = false;\n                }\n            }\n            let completionItem = new LazyCompletionItem(kind, this.icon_for(kind), match, this, document.uri);\n            items.push(completionItem);\n        });\n        this.console.debug('Transformed');\n        // required to make the repetitive trigger characters like :: or ::: work for R with R languageserver,\n        // see https://github.com/jupyter-lsp/jupyterlab-lsp/issues/436\n        let prefix_offset = token.value.length;\n        // completion of dictionaries for Python with jedi-language-server was\n        // causing an issue for dic['<tab>'] case; to avoid this let's make\n        // sure that prefix.length >= prefix.offset\n        if (all_non_prefixed && prefix_offset > prefix.length) {\n            prefix_offset = prefix.length;\n        }\n        let response = {\n            // note in the ContextCompleter it was:\n            // start: token.offset,\n            // end: token.offset + token.value.length,\n            // which does not work with \"from statistics import <tab>\" as the last token ends at \"t\" of \"import\",\n            // so the completer would append \"mean\" as \"from statistics importmean\" (without space!);\n            // (in such a case the typedCharacters is undefined as we are out of range)\n            // a different workaround would be to prepend the token.value prefix:\n            // text = token.value + text;\n            // but it did not work for \"from statistics <tab>\" and lead to \"from statisticsimport\" (no space)\n            start: token.offset + (all_non_prefixed ? prefix_offset : 0),\n            end: token.offset + prefix.length,\n            items: items,\n            source: {\n                name: 'LSP',\n                priority: 2\n            }\n        };\n        if (response.start > response.end) {\n            console.warn('Response contains start beyond end; this should not happen!', response);\n        }\n        return response;\n    }\n    icon_for(type) {\n        if (typeof type === 'undefined') {\n            type = KernelKind;\n        }\n        return this.options.themeManager.get_icon(type) || undefined;\n    }\n    transform_reply(reply) {\n        this.console.log('Transforming kernel reply:', reply);\n        let items;\n        const metadata = reply.metadata || {};\n        const types = metadata._jupyter_types_experimental;\n        if (types) {\n            items = types.map((item) => {\n                return {\n                    label: item.text,\n                    insertText: item.text,\n                    type: item.type === '<unknown>' ? undefined : item.type,\n                    icon: this.icon_for(item.type),\n                    sortText: this.kernel_completions_first ? 'a' : 'z'\n                };\n            });\n        }\n        else {\n            items = reply.matches.map(match => {\n                return {\n                    label: match,\n                    insertText: match,\n                    sortText: this.kernel_completions_first ? 'a' : 'z'\n                };\n            });\n        }\n        return {\n            start: reply.start,\n            end: reply.end,\n            source: {\n                name: 'Kernel',\n                priority: 1,\n                fallbackIcon: this.icon_for('Kernel')\n            },\n            items\n        };\n    }\n    merge_replies(replies, editor) {\n        this.console.debug('Merging completions:', replies);\n        replies = replies.filter(reply => {\n            if (reply instanceof Error) {\n                this.console.warn(`Caught ${reply.source.name} completions error`, reply);\n                return false;\n            }\n            // ignore if no matches\n            if (!reply.items.length) {\n                return false;\n            }\n            // otherwise keep\n            return true;\n        });\n        replies.sort((a, b) => b.source.priority - a.source.priority);\n        this.console.debug('Sorted replies:', replies);\n        const minEnd = Math.min(...replies.map(reply => reply.end));\n        // if any of the replies uses a wider range, we need to align them\n        // so that all responses use the same range\n        const minStart = Math.min(...replies.map(reply => reply.start));\n        const maxStart = Math.max(...replies.map(reply => reply.start));\n        if (minStart != maxStart) {\n            const cursor = editor.getCursorPosition();\n            const line = editor.getLine(cursor.line);\n            if (line == null) {\n                this.console.warn(`Could not remove prefixes: line is undefined`, cursor.line);\n            }\n            else {\n                replies = replies.map(reply => {\n                    // no prefix to strip, return as-is\n                    if (reply.start == maxStart) {\n                        return reply;\n                    }\n                    let prefix = line.substring(reply.start, maxStart);\n                    this.console.debug(`Removing ${reply.source.name} prefix: `, prefix);\n                    return Object.assign(Object.assign({}, reply), { items: reply.items.map(item => {\n                            item.insertText = item.insertText.startsWith(prefix)\n                                ? item.insertText.substr(prefix.length)\n                                : item.insertText;\n                            return item;\n                        }) });\n                });\n            }\n        }\n        const insertTextSet = new Set();\n        const processedItems = new Array();\n        for (const reply of replies) {\n            reply.items.forEach(item => {\n                // trimming because:\n                // IPython returns 'import' and 'import '; while the latter is more useful,\n                // user should not see two suggestions with identical labels and nearly-identical\n                // behaviour as they could not distinguish the two either way\n                let text = item.insertText.trim();\n                if (insertTextSet.has(text)) {\n                    return;\n                }\n                insertTextSet.add(text);\n                // extra processing (adding icon/source name) is delayed until\n                // we are sure that the item will be kept (as otherwise it could\n                // lead to processing hundreds of suggestions - e.g. from numpy\n                // multiple times if multiple sources provide them).\n                let processedItem = item;\n                if (reply.source) {\n                    processedItem.source = reply.source;\n                    if (!processedItem.icon) {\n                        processedItem.icon = reply.source.fallbackIcon;\n                    }\n                }\n                processedItems.push(processedItem);\n            });\n        }\n        // Return reply with processed items.\n        this.console.debug('Merged: ', processedItems);\n        return {\n            start: maxStart,\n            end: minEnd,\n            source: null,\n            items: processedItems\n        };\n    }\n    list(query) {\n        return Promise.resolve(undefined);\n    }\n    remove(id) {\n        return Promise.resolve(undefined);\n    }\n    save(id, value) {\n        return Promise.resolve(undefined);\n    }\n    suppress_if_needed(reply, token, cursor_at_request) {\n        if (reply == null) {\n            return reply;\n        }\n        if (!this._editor.hasFocus()) {\n            this.console.debug('Ignoring completion response: the corresponding editor lost focus');\n            return {\n                start: reply.start,\n                end: reply.end,\n                items: []\n            };\n        }\n        const cursor_now = this._editor.getCursorPosition();\n        // if the cursor advanced in the same line, the previously retrieved completions may still be useful\n        // if the line changed or cursor moved backwards then no reason to keep the suggestions\n        if (cursor_at_request.line != cursor_now.line ||\n            cursor_now.column < cursor_at_request.column) {\n            this.console.debug('Ignoring completion response: cursor has receded or changed line');\n            return {\n                start: reply.start,\n                end: reply.end,\n                items: []\n            };\n        }\n        if (this.trigger_kind == AdditionalCompletionTriggerKinds.AutoInvoked) {\n            if (\n            // do not auto-invoke if no match found\n            reply.start == reply.end ||\n                // do not auto-invoke if only one match found and this match is exactly the same as the current token\n                (reply.items.length === 1 && reply.items[0].insertText === token.value)) {\n                return {\n                    start: reply.start,\n                    end: reply.end,\n                    items: []\n                };\n            }\n        }\n        return reply;\n    }\n}\n//# sourceMappingURL=completion_handler.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { CompleterModel } from '@jupyterlab/completer';\nimport { StringExt } from '@lumino/algorithm';\nfunction escapeHTML(text) {\n    let node = document.createElement('span');\n    node.textContent = text;\n    return node.innerHTML;\n}\n/**\n * This will be contributed upstream\n */\nexport class GenericCompleterModel extends CompleterModel {\n    constructor(settings = {}) {\n        super();\n        // TODO: refactor upstream so that it does not block \"options\"?\n        this.settings = Object.assign(Object.assign({}, GenericCompleterModel.defaultOptions), settings);\n    }\n    completionItems() {\n        let query = this.query;\n        this.query = '';\n        let unfilteredItems = super.completionItems();\n        this.query = query;\n        // always want to sort\n        // TODO does this behave strangely with %%<tab> if always sorting?\n        return this._sortAndFilter(query, unfilteredItems);\n    }\n    setCompletionItems(newValue) {\n        super.setCompletionItems(newValue);\n        if (this.settings.preFilterMatches && this.current && this.cursor) {\n            // set initial query to pre-filter items; in future we should use:\n            // https://github.com/jupyterlab/jupyterlab/issues/9763#issuecomment-1001603348\n            const { start, end } = this.cursor;\n            let query = this.current.text.substring(start, end).trim();\n            // special case for \"Completes Paths In Strings\" test case\n            if (query.startsWith('\"') || query.startsWith(\"'\")) {\n                query = query.substring(1);\n            }\n            if (query.endsWith('\"') || query.endsWith(\"'\")) {\n                query = query.substring(0, -1);\n            }\n            this.query = query;\n        }\n    }\n    _markFragment(value) {\n        return `<mark>${value}</mark>`;\n    }\n    getFilterText(item) {\n        return this.getHighlightableLabelRegion(item);\n    }\n    getHighlightableLabelRegion(item) {\n        // TODO: ideally label and params would be separated so we don't have to do\n        //  things like these which are not language-agnostic\n        //  (assume that params follow after first opening parenthesis which may not be the case);\n        //  the upcoming LSP 3.17 includes CompletionItemLabelDetails\n        //  which separates parameters from the label\n        // With ICompletionItems, the label may include parameters, so we exclude them from the matcher.\n        // e.g. Given label `foo(b, a, r)` and query `bar`,\n        // don't count parameters, `b`, `a`, and `r` as matches.\n        const index = item.label.indexOf('(');\n        return index > -1 ? item.label.substring(0, index) : item.label;\n    }\n    _sortAndFilter(query, items) {\n        let results = [];\n        for (let item of items) {\n            // See if label matches query string\n            let matched;\n            let filterText = null;\n            let filterMatch = null;\n            let lowerCaseQuery = query.toLowerCase();\n            if (query) {\n                filterText = this.getFilterText(item);\n                if (this.settings.caseSensitive) {\n                    filterMatch = StringExt.matchSumOfSquares(filterText, query);\n                }\n                else {\n                    filterMatch = StringExt.matchSumOfSquares(filterText.toLowerCase(), lowerCaseQuery);\n                }\n                matched = !!filterMatch;\n                if (!this.settings.includePerfectMatches) {\n                    matched = matched && filterText != query;\n                }\n            }\n            else {\n                matched = true;\n            }\n            // Filter non-matching items. Filtering may happen on a criterion different than label.\n            if (matched) {\n                // If the matches are substrings of label, highlight them\n                // in this part of the label that can be highlighted (must be a prefix),\n                // which is intended to avoid highlighting matches in function arguments etc.\n                let labelMatch = null;\n                if (query) {\n                    let labelPrefix = escapeHTML(this.getHighlightableLabelRegion(item));\n                    if (labelPrefix == filterText) {\n                        labelMatch = filterMatch;\n                    }\n                    else {\n                        labelMatch = StringExt.matchSumOfSquares(labelPrefix, query);\n                    }\n                }\n                let label;\n                let score;\n                if (labelMatch) {\n                    // Highlight label text if there's a match\n                    // there won't be a match if filter text includes additional keywords\n                    // for easier search that are not a part of the label\n                    let marked = StringExt.highlight(escapeHTML(item.label), labelMatch.indices, this._markFragment);\n                    label = marked.join('');\n                    score = labelMatch.score;\n                }\n                else {\n                    label = escapeHTML(item.label);\n                    score = 0;\n                }\n                // preserve getters (allow for lazily retrieved documentation)\n                const itemClone = Object.create(Object.getPrototypeOf(item), Object.getOwnPropertyDescriptors(item));\n                itemClone.label = label;\n                // If no insertText is present, preserve original label value\n                // by setting it as the insertText.\n                itemClone.insertText = item.insertText ? item.insertText : item.label;\n                results.push({\n                    item: itemClone,\n                    score: score\n                });\n            }\n        }\n        results.sort(this.compareMatches);\n        return results.map(x => x.item);\n    }\n    compareMatches(a, b) {\n        var _a, _b, _c;\n        const delta = a.score - b.score;\n        if (delta !== 0) {\n            return delta;\n        }\n        return (_c = (_a = a.item.insertText) === null || _a === void 0 ? void 0 : _a.localeCompare((_b = b.item.insertText) !== null && _b !== void 0 ? _b : '')) !== null && _c !== void 0 ? _c : 0;\n    }\n}\n(function (GenericCompleterModel) {\n    GenericCompleterModel.defaultOptions = {\n        caseSensitive: true,\n        includePerfectMatches: true,\n        preFilterMatches: true\n    };\n})(GenericCompleterModel || (GenericCompleterModel = {}));\nexport class LSPCompleterModel extends GenericCompleterModel {\n    getFilterText(item) {\n        if (item.filterText) {\n            return item.filterText;\n        }\n        return super.getFilterText(item);\n    }\n    compareMatches(a, b) {\n        const delta = a.score - b.score;\n        if (delta !== 0) {\n            return delta;\n        }\n        // solve ties using sortText\n        // note: locale compare is case-insensitive\n        return a.item.sortText.localeCompare(b.item.sortText);\n    }\n}\n//# sourceMappingURL=model.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { Completer } from '@jupyterlab/completer';\nimport { Signal } from '@lumino/signaling';\nexport class LSPCompletionRenderer extends Completer.Renderer {\n    constructor(options) {\n        super();\n        this.options = options;\n        this.ITEM_PLACEHOLDER_CLASS = 'lsp-detail-placeholder';\n        this.EXTRA_INFO_CLASS = 'jp-Completer-typeExtended';\n        this.activeChanged = new Signal(this);\n        this.itemShown = new Signal(this);\n        this.elementToItem = new WeakMap();\n        this.wasActivated = new WeakMap();\n        this.visibilityObserver = new IntersectionObserver(entries => {\n            entries.forEach(entry => {\n                if (!entry.isIntersecting) {\n                    return;\n                }\n                let li = entry.target;\n                let item = this.elementToItem.get(li);\n                this.itemShown.emit({\n                    item: item,\n                    element: li\n                });\n            });\n        }, {\n            threshold: 0.25\n        });\n        // note: there should be no need to unobserve deleted elements as per:\n        // https://stackoverflow.com/a/51106262/6646912\n        this.activityObserver = new MutationObserver(mutations => {\n            mutations.forEach(mutation => {\n                let li = mutation.target;\n                if (!(li instanceof HTMLLIElement)) {\n                    return;\n                }\n                let inactive = !this.wasActivated.get(li);\n                if (li.classList.contains('jp-mod-active')) {\n                    if (inactive) {\n                        this.wasActivated.set(li, true);\n                        let item = this.elementToItem.get(li);\n                        this.activeChanged.emit({\n                            item: item,\n                            element: li\n                        });\n                    }\n                }\n                else {\n                    this.wasActivated.set(li, false);\n                }\n            });\n        });\n    }\n    getExtraInfo(item) {\n        var _a, _b, _c, _d, _e, _f;\n        const labelExtra = this.options.integrator.settings.composite.labelExtra;\n        switch (labelExtra) {\n            case 'detail':\n                return (item === null || item === void 0 ? void 0 : item.detail) || '';\n            case 'type':\n                return (_b = (_a = item === null || item === void 0 ? void 0 : item.type) === null || _a === void 0 ? void 0 : _a.toLowerCase) === null || _b === void 0 ? void 0 : _b.call(_a);\n            case 'source':\n                return (_c = item === null || item === void 0 ? void 0 : item.source) === null || _c === void 0 ? void 0 : _c.name;\n            case 'auto':\n                return [\n                    (item === null || item === void 0 ? void 0 : item.detail) || '',\n                    (_e = (_d = item === null || item === void 0 ? void 0 : item.type) === null || _d === void 0 ? void 0 : _d.toLowerCase) === null || _e === void 0 ? void 0 : _e.call(_d),\n                    (_f = item === null || item === void 0 ? void 0 : item.source) === null || _f === void 0 ? void 0 : _f.name\n                ].filter(x => !!x)[0];\n            default:\n                this.options.console.warn('labelExtra does not match any of the expected values', labelExtra);\n                return '';\n        }\n    }\n    updateExtraInfo(item, li) {\n        const extraText = this.getExtraInfo(item);\n        if (extraText) {\n            const extraElement = li.getElementsByClassName(this.EXTRA_INFO_CLASS)[0];\n            extraElement.textContent = extraText;\n        }\n    }\n    createCompletionItemNode(item, orderedTypes) {\n        const li = super.createCompletionItemNode(item, orderedTypes);\n        // make sure that an instance reference, and not an object copy is being used;\n        const lsp_item = item.self;\n        // only monitor nodes that have item.self as others are not our completion items\n        if (lsp_item) {\n            lsp_item.element = li;\n            this.elementToItem.set(li, lsp_item);\n            this.activityObserver.observe(li, {\n                attributes: true,\n                attributeFilter: ['class']\n            });\n            this.visibilityObserver.observe(li);\n            // TODO: build custom li from ground up\n            this.updateExtraInfo(lsp_item, li);\n        }\n        else {\n            this.updateExtraInfo(item, li);\n        }\n        return li;\n    }\n    createDocumentationNode(item) {\n        // note: not worth trying to `fetchDocumentation()` as this is not\n        // invoked if documentation is empty (as of jlab 3.2)\n        if (item.isDocumentationMarkdown && this.options.markdownRenderer) {\n            let documentation = item.documentation;\n            this.options.markdownRenderer\n                .renderModel({\n                data: {\n                    'text/markdown': documentation\n                },\n                trusted: false,\n                metadata: {},\n                setData(options) {\n                    // empty\n                }\n            })\n                .then(() => {\n                if (this.options.markdownRenderer &&\n                    this.options.latexTypesetter &&\n                    documentation &&\n                    documentation.includes('$')) {\n                    this.options.latexTypesetter.typeset(this.options.markdownRenderer.node);\n                }\n            })\n                .catch(this.options.console.warn);\n            return this.options.markdownRenderer.node;\n        }\n        else {\n            let node = document.createElement('pre');\n            if (item.documentation) {\n                node.textContent = item.documentation;\n            }\n            return node;\n        }\n    }\n}\n//# sourceMappingURL=renderer.js.map","import { NotebookAdapter } from '../../adapters/notebook/notebook';\nimport { CodeMirrorIntegration } from '../../editor_integration/codemirror';\nimport { AdditionalCompletionTriggerKinds, CompletionTriggerKind } from '../../lsp';\nimport { LSPConnector } from './completion_handler';\nimport { LSPCompleterModel } from './model';\nimport { LSPCompletionRenderer } from './renderer';\nconst DOC_PANEL_SELECTOR = '.jp-Completer-docpanel';\nconst DOC_PANEL_PLACEHOLDER_CLASS = 'lsp-completer-placeholder';\nexport class CompletionCM extends CodeMirrorIntegration {\n    get settings() {\n        return super.settings;\n    }\n    get completionCharacters() {\n        if (this._completionCharacters == null ||\n            !this._completionCharacters.length) {\n            this._completionCharacters =\n                this.connection.getLanguageCompletionCharacters();\n        }\n        return this._completionCharacters;\n    }\n    // public handleCompletion(completions: lsProtocol.CompletionItem[]) {\n    // TODO: populate the (already displayed) completions list if the completions timed out initially?\n    // }\n    afterChange(change) {\n        // TODO: maybe the completer could be kicked off in the handleChange() method directly; signature help still\n        //  requires an up-to-date virtual document on the LSP side, so we need to wait for sync.\n        // note: trigger character completion need to be have a higher priority than auto-invoked completion\n        // because the latter does not work for on-dot completion due to suppression of trivial suggestions\n        // see gh430\n        let last_character = this.extract_last_character(change);\n        if (this.completionCharacters.indexOf(last_character) > -1) {\n            this.virtual_editor.console.log('Will invoke completer after', last_character);\n            this.feature.labIntegration\n                .invoke_completer(CompletionTriggerKind.TriggerCharacter)\n                .catch(this.console.warn);\n            return;\n        }\n        if (change.text &&\n            change.text[0].length == 1 &&\n            this.settings.composite.continuousHinting) {\n            this.feature.labIntegration\n                .invoke_completer(AdditionalCompletionTriggerKinds.AutoInvoked)\n                .catch(this.console.warn);\n        }\n    }\n}\nexport class CompletionLabIntegration {\n    constructor(app, completionManager, settings, adapterManager, completionThemeManager, console, renderMimeRegistry) {\n        this.app = app;\n        this.completionManager = completionManager;\n        this.settings = settings;\n        this.adapterManager = adapterManager;\n        this.completionThemeManager = completionThemeManager;\n        this.console = console;\n        this.renderMimeRegistry = renderMimeRegistry;\n        this.current_adapter = null;\n        this._latestActiveItem = null;\n        const markdown_renderer = this.renderMimeRegistry.createRenderer('text/markdown');\n        this.renderer = new LSPCompletionRenderer({\n            integrator: this,\n            markdownRenderer: markdown_renderer,\n            latexTypesetter: this.renderMimeRegistry.latexTypesetter,\n            console: console.scope('renderer')\n        });\n        this.renderer.activeChanged.connect(this.active_completion_changed, this);\n        this.renderer.itemShown.connect(this.resolve_and_update, this);\n        // TODO: figure out a better way to disable lab integration elements (postpone initialization?)\n        settings.ready\n            .then(() => {\n            if (!settings.composite.disable) {\n                adapterManager.adapterChanged.connect(this.swap_adapter, this);\n            }\n        })\n            .catch(console.warn);\n        settings.changed.connect(() => {\n            completionThemeManager.set_theme(this.settings.composite.theme);\n            completionThemeManager.set_icons_overrides(this.settings.composite.typesMap);\n            if (!settings.composite.disable) {\n                document.body.dataset.lspCompleterLayout =\n                    this.settings.composite.layout;\n            }\n            if (this.current_completion_handler) {\n                this.model.settings.caseSensitive =\n                    this.settings.composite.caseSensitive;\n                this.model.settings.includePerfectMatches =\n                    this.settings.composite.includePerfectMatches;\n                this.model.settings.preFilterMatches =\n                    this.settings.composite.preFilterMatches;\n            }\n        });\n    }\n    fetchDocumentation(item) {\n        if (!item) {\n            return;\n        }\n        item\n            .resolve()\n            .then(resolvedCompletionItem => {\n            if (item.self !== this._latestActiveItem.self) {\n                return;\n            }\n            this.set_doc_panel_placeholder(false);\n            if (resolvedCompletionItem === null) {\n                return;\n            }\n            this.refresh_doc_panel(item);\n        })\n            .catch(e => {\n            // disabling placeholder can remove currently displayed documentation,\n            // so only do that if this is really the active item!\n            if (item.self === this._latestActiveItem.self) {\n                this.set_doc_panel_placeholder(false);\n            }\n            this.console.warn(e);\n        });\n    }\n    active_completion_changed(renderer, active_completion) {\n        let { item } = active_completion;\n        this._latestActiveItem = item;\n        if (!item.supportsResolution()) {\n            if (item.isDocumentationMarkdown) {\n                // TODO: remove once https://github.com/jupyterlab/jupyterlab/pull/9663 is merged and released\n                this.refresh_doc_panel(item);\n            }\n            return;\n        }\n        if (item.needsResolution()) {\n            this.set_doc_panel_placeholder(true);\n            this.fetchDocumentation(item);\n        }\n        else if (item.isResolved()) {\n            this.refresh_doc_panel(item);\n        }\n        else {\n            // resolution has already started, but the re-render update could have been invalidated\n            // by user action, so let's ensure the documentation will get shown this time.\n            this.fetchDocumentation(item);\n        }\n        // also fetch completion for the previous and the next item to prevent jitter\n        const index = this.current_index;\n        const items = this.current_items;\n        if (index - 1 >= 0) {\n            const previous = items[index - 1];\n            this.resolve_and_update_from_item(previous === null || previous === void 0 ? void 0 : previous.self);\n        }\n        if (index + 1 < items.length) {\n            const next = items[index + 1];\n            this.resolve_and_update_from_item(next === null || next === void 0 ? void 0 : next.self);\n        }\n    }\n    resolve_and_update_from_item(item) {\n        if (!item) {\n            return;\n        }\n        this.resolve_and_update(this.renderer, {\n            item: item,\n            element: item.element\n        });\n    }\n    resolve_and_update(renderer, active_completion) {\n        let { item, element } = active_completion;\n        if (!item.supportsResolution()) {\n            this.renderer.updateExtraInfo(item, element);\n            return;\n        }\n        if (item.isResolved()) {\n            this.renderer.updateExtraInfo(item, element);\n        }\n        else {\n            // supportsResolution as otherwise would short-circuit above\n            item\n                .resolve()\n                .then(resolvedCompletionItem => {\n                this.renderer.updateExtraInfo(item, element);\n            })\n                .catch(e => {\n                this.console.warn(e);\n            });\n        }\n    }\n    swap_adapter(manager, adapter) {\n        if (this.current_adapter) {\n            // disconnect signals from the old adapter\n            this.current_adapter.activeEditorChanged.disconnect(this.set_connector, this);\n            this.current_adapter.adapterConnected.disconnect(this.connect_completion, this);\n        }\n        this.current_adapter = adapter;\n        // connect the new adapter\n        if (this.current_adapter.isConnected) {\n            this.connect_completion(this.current_adapter);\n            // TODO: what to do if adapter.activeEditor was just deleted/there is none because focus shifted?\n            this.set_connector(adapter, { editor: adapter.activeEditor });\n        }\n        // connect signals to the new adapter\n        this.current_adapter.activeEditorChanged.connect(this.set_connector, this);\n        this.current_adapter.adapterConnected.connect(this.connect_completion, this);\n    }\n    connect_completion(adapter, data) {\n        let editor = adapter.activeEditor;\n        if (editor == null) {\n            return;\n        }\n        this.set_completion_connector(adapter, editor);\n        this.current_completion_handler = this.completionManager.register({\n            connector: this.current_completion_connector,\n            editor: editor,\n            parent: adapter.widget\n        }, this.renderer);\n        let completer = this.completer;\n        completer.addClass('lsp-completer');\n        completer.model = new LSPCompleterModel({\n            caseSensitive: this.settings.composite.caseSensitive,\n            includePerfectMatches: this.settings.composite.includePerfectMatches,\n            preFilterMatches: this.settings.composite.preFilterMatches\n        });\n    }\n    get completer() {\n        // TODO upstream: make completer public?\n        return this.current_completion_handler.completer;\n    }\n    get model() {\n        return this.completer.model;\n    }\n    invoke_completer(kind) {\n        // TODO: ideally this would not re-trigger if list of items not isIncomplete\n        let command;\n        this.current_completion_connector.trigger_kind = kind;\n        if (this.adapterManager.currentAdapter instanceof NotebookAdapter) {\n            command = 'completer:invoke-notebook';\n        }\n        else {\n            command = 'completer:invoke-file';\n        }\n        return this.app.commands.execute(command).catch(() => {\n            this.current_completion_connector.trigger_kind =\n                CompletionTriggerKind.Invoked;\n        });\n    }\n    set_connector(adapter, editor_changed) {\n        if (!this.current_completion_handler) {\n            // workaround for current_completion_handler not being there yet\n            this.connect_completion(adapter);\n        }\n        this.set_completion_connector(adapter, editor_changed.editor);\n        this.current_completion_handler.editor = editor_changed.editor;\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        this.current_completion_handler.connector =\n            this.current_completion_connector;\n    }\n    get current_items() {\n        // TODO upstream: allow to get completionItems() without markup\n        //   (note: not trivial as _markup() does filtering too)\n        return this.model.completionItems();\n    }\n    get current_index() {\n        let completer = this.current_completion_handler.completer;\n        // TODO: use public activeIndex available since 3.1\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        return completer._activeIndex;\n    }\n    refresh_doc_panel(item) {\n        let completer = this.current_completion_handler.completer;\n        const active = this.current_items[this.current_index];\n        if (!item || !active || active.insertText != item.insertText) {\n            return;\n        }\n        const docPanel = completer.node.querySelector(DOC_PANEL_SELECTOR);\n        if (!docPanel) {\n            this.console.warn('Could not find completer panel to refresh');\n            return;\n        }\n        docPanel.classList.remove(DOC_PANEL_PLACEHOLDER_CLASS);\n        if (item.documentation) {\n            // remove all children\n            docPanel.textContent = '';\n            // TODO upstream: renderer should take care of the documentation rendering\n            //  sent PR: https://github.com/jupyterlab/jupyterlab/pull/9663\n            const node = this.renderer.createDocumentationNode(item);\n            docPanel.appendChild(node);\n            docPanel.setAttribute('style', '');\n        }\n        else {\n            docPanel.setAttribute('style', 'display: none');\n        }\n    }\n    set_doc_panel_placeholder(enable) {\n        let completer = this.current_completion_handler.completer;\n        const docPanel = completer.node.querySelector(DOC_PANEL_SELECTOR);\n        if (!docPanel) {\n            this.console.warn('Could not find completer panel for placeholder');\n            return;\n        }\n        if (enable) {\n            docPanel.setAttribute('style', '');\n            docPanel.classList.add(DOC_PANEL_PLACEHOLDER_CLASS);\n        }\n        else if (docPanel.classList.contains(DOC_PANEL_PLACEHOLDER_CLASS)) {\n            docPanel.setAttribute('style', 'display: none');\n            docPanel.classList.remove(DOC_PANEL_PLACEHOLDER_CLASS);\n        }\n    }\n    set_completion_connector(adapter, editor) {\n        var _a, _b;\n        this.current_completion_connector = new LSPConnector({\n            editor: editor,\n            themeManager: this.completionThemeManager,\n            connections: this.current_adapter.connection_manager.connections,\n            virtual_editor: this.current_adapter.virtual_editor,\n            settings: this.settings,\n            labIntegration: this,\n            // it might or might not be a notebook panel (if it is not, the sessionContext and session will just be undefined)\n            session: (_b = (_a = this.current_adapter.widget) === null || _a === void 0 ? void 0 : _a.sessionContext) === null || _b === void 0 ? void 0 : _b.session,\n            console: this.console\n        });\n    }\n}\n//# sourceMappingURL=completion.js.map","import { ICompletionManager } from '@jupyterlab/completer';\nimport { IRenderMimeRegistry } from '@jupyterlab/rendermime';\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { LabIcon } from '@jupyterlab/ui-components';\nimport { ILSPCompletionThemeManager } from '@krassowski/completion-theme/lib/types';\nimport completionSvg from '../../../style/icons/completion.svg';\nimport { FeatureSettings } from '../../feature';\nimport { CompletionItemTag } from '../../lsp';\nimport { ILSPAdapterManager, ILSPFeatureManager, ILSPLogConsole, PLUGIN_ID } from '../../tokens';\nimport { CompletionCM, CompletionLabIntegration } from './completion';\nexport const completionIcon = new LabIcon({\n    name: 'lsp:completion',\n    svgstr: completionSvg\n});\nconst FEATURE_ID = PLUGIN_ID + ':completion';\nexport const COMPLETION_PLUGIN = {\n    id: FEATURE_ID,\n    requires: [\n        ILSPFeatureManager,\n        ISettingRegistry,\n        ICompletionManager,\n        ILSPAdapterManager,\n        ILSPCompletionThemeManager,\n        ILSPLogConsole,\n        IRenderMimeRegistry\n    ],\n    autoStart: true,\n    activate: (app, featureManager, settingRegistry, completionManager, adapterManager, iconsThemeManager, logConsole, renderMimeRegistry) => {\n        const settings = new FeatureSettings(settingRegistry, FEATURE_ID);\n        const labIntegration = new CompletionLabIntegration(app, completionManager, settings, adapterManager, iconsThemeManager, logConsole.scope('CompletionLab'), renderMimeRegistry);\n        featureManager.register({\n            feature: {\n                editorIntegrationFactory: new Map([['CodeMirrorEditor', CompletionCM]]),\n                id: FEATURE_ID,\n                name: 'LSP Completion',\n                labIntegration: labIntegration,\n                settings: settings,\n                capabilities: {\n                    textDocument: {\n                        completion: {\n                            dynamicRegistration: true,\n                            completionItem: {\n                                snippetSupport: false,\n                                commitCharactersSupport: true,\n                                documentationFormat: ['markdown', 'plaintext'],\n                                deprecatedSupport: true,\n                                preselectSupport: false,\n                                tagSupport: {\n                                    valueSet: [CompletionItemTag.Deprecated]\n                                }\n                            },\n                            contextSupport: false\n                        }\n                    }\n                }\n            }\n        });\n    }\n};\n//# sourceMappingURL=index.js.map","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n    <path d=\\\"M19 8c.56 0 1 .43 1 1a1 1 0 01-1 1c-.57 0-1-.45-1-1 0-.57.43-1 1-1M2 2v9c0 2.96 2.19 5.5 5.14 5.91.62 3.01 3.28 5.09 6.36 5.09a6.5 6.5 0 006.5-6.5v-3.69c1.16-.42 2-1.52 2-2.81a3 3 0 00-3-3 3 3 0 00-3 3c0 1.29.84 2.4 2 2.81v3.6c0 2.5-2 4.5-4.5 4.5-2 0-3.68-1.21-4.28-3.01C12 16.3 14 13.8 14 11V2h-4v3h2v6a4 4 0 01-4 4 4 4 0 01-4-4V5h2V2H2z\\\"/>\\n  </g>\\n</svg>\\n\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n    <path d=\\\"M12 14a2 2 0 012 2 2 2 0 01-2 2 2 2 0 01-2-2 2 2 0 012-2m11.46-5.14l-1.59 6.89L15 14.16l3.8-2.38A7.972 7.972 0 0012 8c-3.95 0-7.23 2.86-7.88 6.63l-1.97-.35C2.96 9.58 7.06 6 12 6c3.58 0 6.73 1.89 8.5 4.72l2.96-1.86z\\\"/>\\n  </g>\\n</svg>\\n\";","import { CodeMirrorEditor } from '@jupyterlab/codemirror';\nimport { URLExt } from '@jupyterlab/coreutils';\nimport { IDocumentManager } from '@jupyterlab/docmanager';\nimport { IEditorTracker } from '@jupyterlab/fileeditor';\nimport { INotebookTracker } from '@jupyterlab/notebook';\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { ITranslator } from '@jupyterlab/translation';\nimport { LabIcon } from '@jupyterlab/ui-components';\nimport { FileEditorJumper, NotebookJumper } from '@krassowski/code-jumpers';\nimport jumpToSvg from '../../style/icons/jump-to.svg';\nimport { PositionConverter } from '../converter';\nimport { CodeMirrorIntegration } from '../editor_integration/codemirror';\nimport { FeatureSettings } from '../feature';\nimport { ILSPAdapterManager, ILSPFeatureManager, PLUGIN_ID } from '../tokens';\nimport { getModifierState, uri_to_contents_path, uris_equal } from '../utils';\nexport const jumpToIcon = new LabIcon({\n    name: 'lsp:jump-to',\n    svgstr: jumpToSvg\n});\nconst jumpBackIcon = new LabIcon({\n    name: 'lsp:jump-back',\n    svgstr: jumpToSvg.replace('jp-icon3', 'lsp-icon-flip-x jp-icon3')\n});\nconst FEATURE_ID = PLUGIN_ID + ':jump_to';\nlet trans;\nexport class CMJumpToDefinition extends CodeMirrorIntegration {\n    get jumper() {\n        return this.feature.labIntegration.jumper;\n    }\n    get settings() {\n        return super.settings;\n    }\n    get modifierKey() {\n        return this.settings.composite.modifierKey;\n    }\n    register() {\n        this.editor_handlers.set('mousedown', (virtual_editor, event) => {\n            const { button } = event;\n            if (button === 0 && getModifierState(event, this.modifierKey)) {\n                let root_position = this.position_from_mouse(event);\n                if (root_position == null) {\n                    this.console.warn('Could not retrieve root position from mouse event to jump to definition');\n                    return;\n                }\n                let document = virtual_editor.document_at_root_position(root_position);\n                let virtual_position = virtual_editor.root_position_to_virtual_position(root_position);\n                this.connection\n                    .getDefinition(virtual_position, document.document_info, false)\n                    .then(targets => {\n                    this.handle_jump(targets, document.document_info.uri).catch(this.console.warn);\n                })\n                    .catch(this.console.warn);\n                event.preventDefault();\n                event.stopPropagation();\n            }\n        });\n        super.register();\n    }\n    get_uri_and_range(location_or_locations) {\n        if (location_or_locations == null) {\n            return undefined;\n        }\n        // some language servers appear to return a single object\n        const locations = Array.isArray(location_or_locations)\n            ? location_or_locations\n            : [location_or_locations];\n        // TODO: implement selector for multiple locations\n        //  (like when there are multiple definitions or usages)\n        //  could use the showHints() or completion frontend as a reference\n        if (locations.length === 0) {\n            return undefined;\n        }\n        this.console.log('Will jump to the first of suggested locations:', locations);\n        const location_or_link = locations[0];\n        if ('targetUri' in location_or_link) {\n            return {\n                uri: location_or_link.targetUri,\n                range: location_or_link.targetRange\n            };\n        }\n        else if ('uri' in location_or_link) {\n            return {\n                uri: location_or_link.uri,\n                range: location_or_link.range\n            };\n        }\n        else {\n            this.console.warn('Returned jump location is incorrect (no uri or targetUri):', location_or_link);\n            return undefined;\n        }\n    }\n    async handle_jump(location_or_locations, document_uri) {\n        const target_info = this.get_uri_and_range(location_or_locations);\n        if (!target_info) {\n            this.status_message.set(trans.__('No jump targets found'), 2 * 1000);\n            return;\n        }\n        let { uri, range } = target_info;\n        let virtual_position = PositionConverter.lsp_to_cm(range.start);\n        if (uris_equal(uri, document_uri)) {\n            let editor_index = this.adapter.get_editor_index_at(virtual_position);\n            // if in current file, transform from the position within virtual document to the editor position:\n            let editor_position = this.virtual_editor.transform_virtual_to_editor(virtual_position);\n            if (editor_position === null) {\n                this.console.warn('Could not jump: conversion from virtual position to editor position failed', virtual_position);\n                return;\n            }\n            let editor_position_ce = PositionConverter.cm_to_ce(editor_position);\n            this.console.log(`Jumping to ${editor_index}th editor of ${uri}`);\n            this.console.log('Jump target within editor:', editor_position_ce);\n            let contents_path = this.adapter.widget.context.path;\n            this.jumper.global_jump({\n                line: editor_position_ce.line,\n                column: editor_position.ch,\n                editor_index: editor_index,\n                is_symlink: false,\n                contents_path: contents_path\n            });\n        }\n        else {\n            // otherwise there is no virtual document and we expect the returned position to be source position:\n            let source_position_ce = PositionConverter.cm_to_ce(virtual_position);\n            this.console.log(`Jumping to external file: ${uri}`);\n            this.console.log('Jump target (source location):', source_position_ce);\n            let jump_data = {\n                editor_index: 0,\n                line: source_position_ce.line,\n                column: source_position_ce.column\n            };\n            // assume that we got a relative path to a file within the project\n            // TODO use is_relative() or something? It would need to be not only compatible\n            //  with different OSes but also with JupyterHub and other platforms.\n            // can it be resolved vs our guessed server root?\n            let contents_path = uri_to_contents_path(uri);\n            if (contents_path == null) {\n                if (uri.startsWith('file://')) {\n                    contents_path = decodeURIComponent(uri.slice(7));\n                }\n                else {\n                    contents_path = decodeURIComponent(uri);\n                }\n            }\n            if (contents_path === null) {\n                this.console.warn('contents_path could not be resolved');\n                return;\n            }\n            try {\n                await this.jumper.document_manager.services.contents.get(contents_path, {\n                    content: false\n                });\n                this.jumper.global_jump(Object.assign(Object.assign({ contents_path }, jump_data), { is_symlink: false }));\n                return;\n            }\n            catch (err) {\n                this.console.warn(err);\n            }\n            this.jumper.global_jump(Object.assign(Object.assign({ contents_path: URLExt.join('.lsp_symlink', contents_path) }, jump_data), { is_symlink: true }));\n        }\n    }\n}\nclass JumperLabIntegration {\n    constructor(settings, adapterManager, notebookTracker, documentManager, fileEditorTracker) {\n        this.settings = settings;\n        this.adapterManager = adapterManager;\n        this.jumpers = new Map();\n        if (fileEditorTracker !== null) {\n            fileEditorTracker.widgetAdded.connect((sender, widget) => {\n                let fileEditor = widget.content;\n                if (fileEditor.editor instanceof CodeMirrorEditor) {\n                    let jumper = new FileEditorJumper(widget, documentManager);\n                    this.jumpers.set(widget.id, jumper);\n                }\n            });\n        }\n        notebookTracker.widgetAdded.connect(async (sender, widget) => {\n            // NOTE: assuming that the default cells content factory produces CodeMirror editors(!)\n            let jumper = new NotebookJumper(widget, documentManager);\n            this.jumpers.set(widget.id, jumper);\n        });\n    }\n    get jumper() {\n        let current = this.adapterManager.currentAdapter.widget.id;\n        return this.jumpers.get(current);\n    }\n}\nconst COMMANDS = (trans) => [\n    {\n        id: 'jump-to-definition',\n        execute: async ({ connection, virtual_position, document, features }) => {\n            const jump_feature = features.get(FEATURE_ID);\n            const targets = await (connection === null || connection === void 0 ? void 0 : connection.getDefinition(virtual_position, document.document_info, false));\n            await jump_feature.handle_jump(targets, document.document_info.uri);\n        },\n        is_enabled: ({ connection }) => connection ? connection.isDefinitionSupported() : false,\n        label: trans.__('Jump to definition'),\n        icon: jumpToIcon\n    },\n    {\n        id: 'jump-back',\n        execute: async ({ connection, virtual_position, document, features }) => {\n            const jump_feature = features.get(FEATURE_ID);\n            jump_feature.jumper.global_jump_back();\n        },\n        is_enabled: ({ connection }) => connection ? connection.isDefinitionSupported() : false,\n        label: trans.__('Jump back'),\n        icon: jumpBackIcon,\n        // do not attach to any of the context menus\n        attach_to: new Set()\n    }\n];\nexport const JUMP_PLUGIN = {\n    id: FEATURE_ID,\n    requires: [\n        ILSPFeatureManager,\n        ISettingRegistry,\n        ILSPAdapterManager,\n        INotebookTracker,\n        IDocumentManager,\n        ITranslator\n    ],\n    optional: [IEditorTracker],\n    autoStart: true,\n    activate: (app, featureManager, settingRegistry, adapterManager, notebookTracker, documentManager, translator, fileEditorTracker) => {\n        const settings = new FeatureSettings(settingRegistry, FEATURE_ID);\n        trans = translator.load('jupyterlab-lsp');\n        let labIntegration = new JumperLabIntegration(settings, adapterManager, notebookTracker, documentManager, fileEditorTracker);\n        featureManager.register({\n            feature: {\n                editorIntegrationFactory: new Map([\n                    ['CodeMirrorEditor', CMJumpToDefinition]\n                ]),\n                commands: COMMANDS(trans),\n                id: FEATURE_ID,\n                name: 'Jump to definition',\n                labIntegration: labIntegration,\n                settings: settings,\n                capabilities: {\n                    textDocument: {\n                        declaration: {\n                            dynamicRegistration: true,\n                            linkSupport: true\n                        },\n                        definition: {\n                            dynamicRegistration: true,\n                            linkSupport: true\n                        },\n                        typeDefinition: {\n                            dynamicRegistration: true,\n                            linkSupport: true\n                        },\n                        implementation: {\n                            dynamicRegistration: true,\n                            linkSupport: true\n                        }\n                    }\n                }\n            }\n        });\n    }\n};\n//# sourceMappingURL=jump_to.js.map","import api from \"!../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../css-loader/dist/cjs.js!./diagnostics_listing.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import { VDomModel, VDomRenderer } from '@jupyterlab/apputils';\nimport { caretDownIcon, caretUpIcon } from '@jupyterlab/ui-components';\nimport React from 'react';\nimport { DocumentLocator, focus_on } from '../../components/utils';\nimport { DiagnosticSeverity } from '../../lsp';\nimport '../../../style/diagnostics_listing.css';\nexport const DIAGNOSTICS_LISTING_CLASS = 'lsp-diagnostics-listing';\nconst DIAGNOSTICS_PLACEHOLDER_CLASS = 'lsp-diagnostics-placeholder';\nexport class DiagnosticsDatabase extends Map {\n    get all() {\n        return [].concat.apply([], this.values());\n    }\n}\nclass Column {\n    constructor(options) {\n        this.options = options;\n        this.is_visible = true;\n    }\n    render_cell(data, context) {\n        return this.options.render_cell(data, context);\n    }\n    sort(a, b) {\n        return this.options.sort(a, b);\n    }\n    get id() {\n        return this.options.id;\n    }\n    is_available(context) {\n        if (this.options.is_available != null) {\n            return this.options.is_available(context);\n        }\n        return true;\n    }\n    render_header(listing) {\n        return (React.createElement(SortableTH, { label: this.options.label, id: this.id, listing: listing, key: this.id }));\n    }\n}\nfunction SortableTH(props) {\n    const is_sort_key = props.id === props.listing.sort_key;\n    const sortIcon = !is_sort_key || props.listing.sort_direction === 1\n        ? caretUpIcon\n        : caretDownIcon;\n    return (React.createElement(\"th\", { key: props.id, onClick: () => props.listing.sort(props.id), className: is_sort_key ? 'lsp-sorted-header' : undefined, \"data-id\": props.id },\n        React.createElement(\"div\", null,\n            React.createElement(\"label\", null, props.label),\n            React.createElement(sortIcon.react, { tag: \"span\", className: \"lsp-sort-icon\" }))));\n}\nexport function message_without_code(diagnostic) {\n    let message = diagnostic.message;\n    let code_str = '' + diagnostic.code;\n    if (diagnostic.code != null &&\n        diagnostic.code !== '' &&\n        message.startsWith(code_str + '')) {\n        return message.slice(code_str.length).trim();\n    }\n    return message;\n}\nexport class DiagnosticsListing extends VDomRenderer {\n    constructor(model) {\n        super(model);\n        this.sort_key = 'Severity';\n        this.sort_direction = 1;\n        const trans = model.trans;\n        this.trans = trans;\n        this.severityTranslations = {\n            Error: trans.__('Error'),\n            Warning: trans.__('Warning'),\n            Information: trans.__('Information'),\n            Hint: trans.__('Hint')\n        };\n        this.columns = [\n            new Column({\n                id: 'Virtual Document',\n                label: this.trans.__('Virtual Document'),\n                render_cell: (row, context) => (React.createElement(\"td\", { key: 0 },\n                    React.createElement(DocumentLocator, { document: row.document, adapter: context.adapter, trans: this.trans }))),\n                sort: (a, b) => a.document.id_path.localeCompare(b.document.id_path),\n                is_available: context => context.db.size > 1\n            }),\n            new Column({\n                id: 'Message',\n                label: this.trans.__('Message'),\n                render_cell: row => {\n                    let message = message_without_code(row.data.diagnostic);\n                    return React.createElement(\"td\", { key: 1 }, message);\n                },\n                sort: (a, b) => a.data.diagnostic.message.localeCompare(b.data.diagnostic.message)\n            }),\n            new Column({\n                id: 'Code',\n                label: this.trans.__('Code'),\n                render_cell: row => React.createElement(\"td\", { key: 2 }, row.data.diagnostic.code),\n                sort: (a, b) => (a.data.diagnostic.code + '').localeCompare(b.data.diagnostic.source + '')\n            }),\n            new Column({\n                id: 'Severity',\n                label: this.trans.__('Severity'),\n                // TODO: use default diagnostic severity\n                render_cell: row => {\n                    const severity = DiagnosticSeverity[row.data.diagnostic.severity || 1];\n                    return (React.createElement(\"td\", { key: 3 }, this.severityTranslations[severity] || severity));\n                },\n                sort: (a, b) => {\n                    if (!a.data.diagnostic.severity) {\n                        return +1;\n                    }\n                    if (!b.data.diagnostic.severity) {\n                        return -1;\n                    }\n                    return a.data.diagnostic.severity > b.data.diagnostic.severity\n                        ? 1\n                        : -1;\n                }\n            }),\n            new Column({\n                id: 'Source',\n                label: this.trans.__('Source'),\n                render_cell: row => React.createElement(\"td\", { key: 4 }, row.data.diagnostic.source),\n                sort: (a, b) => {\n                    if (!a.data.diagnostic.source) {\n                        return +1;\n                    }\n                    if (!b.data.diagnostic.source) {\n                        return -1;\n                    }\n                    return a.data.diagnostic.source.localeCompare(b.data.diagnostic.source);\n                }\n            }),\n            new Column({\n                id: 'Cell',\n                label: this.trans.__('Cell'),\n                render_cell: row => React.createElement(\"td\", { key: 5 }, row.cell_number),\n                sort: (a, b) => a.cell_number - b.cell_number ||\n                    a.data.range.start.line - b.data.range.start.line ||\n                    a.data.range.start.ch - b.data.range.start.ch,\n                is_available: context => context.adapter.has_multiple_editors\n            }),\n            new Column({\n                id: 'Line:Ch',\n                label: this.trans.__('Line:Ch'),\n                render_cell: row => (React.createElement(\"td\", { key: 6 },\n                    row.data.range.start.line,\n                    \":\",\n                    row.data.range.start.ch)),\n                sort: (a, b) => a.data.range.start.line - b.data.range.start.line ||\n                    a.data.range.start.ch - b.data.range.start.ch\n            })\n        ];\n    }\n    sort(key) {\n        if (key === this.sort_key) {\n            this.sort_direction = this.sort_direction * -1;\n        }\n        else {\n            this.sort_key = key;\n            this.sort_direction = 1;\n        }\n        this.update();\n    }\n    render() {\n        let diagnostics_db = this.model.diagnostics;\n        const editor = this.model.virtual_editor;\n        const adapter = this.model.adapter;\n        if (diagnostics_db == null || editor == null || !adapter) {\n            return (React.createElement(\"div\", { className: DIAGNOSTICS_PLACEHOLDER_CLASS }, this.trans.__('Diagnostics are not available')));\n        }\n        if (diagnostics_db.size === 0) {\n            return (React.createElement(\"div\", { className: DIAGNOSTICS_PLACEHOLDER_CLASS }, this.trans.__('No issues detected, great job!')));\n        }\n        let by_document = Array.from(diagnostics_db).map(([virtual_document, diagnostics]) => {\n            if (virtual_document.isDisposed) {\n                return [];\n            }\n            return diagnostics.map((diagnostic_data, i) => {\n                let cell_number = null;\n                if (adapter.has_multiple_editors) {\n                    let { index: cell_id } = editor.find_editor(diagnostic_data.editor);\n                    cell_number = cell_id + 1;\n                }\n                return {\n                    data: diagnostic_data,\n                    key: virtual_document.uri + ',' + i,\n                    document: virtual_document,\n                    cell_number: cell_number,\n                    editor: editor\n                };\n            });\n        });\n        let flattened = [].concat.apply([], by_document);\n        this._diagnostics = new Map(flattened.map(row => [row.key, row]));\n        let sorted_column = this.columns.filter(column => column.id === this.sort_key)[0];\n        let sorter = sorted_column.sort.bind(sorted_column);\n        let sorted = flattened.sort((a, b) => sorter(a, b) * this.sort_direction);\n        let context = {\n            db: diagnostics_db,\n            editor: editor,\n            adapter: adapter\n        };\n        let columns_to_display = this.columns.filter(column => column.is_available(context) && column.is_visible);\n        let elements = sorted.map(row => {\n            let cells = columns_to_display.map(column => column.render_cell(row, context));\n            return (React.createElement(\"tr\", { key: row.key, \"data-key\": row.key, onClick: () => {\n                    this.jump_to(row);\n                } }, cells));\n        });\n        let columns_headers = columns_to_display.map(column => column.render_header(this));\n        return (React.createElement(\"table\", { className: DIAGNOSTICS_LISTING_CLASS },\n            React.createElement(\"thead\", null,\n                React.createElement(\"tr\", null, columns_headers)),\n            React.createElement(\"tbody\", null, elements)));\n    }\n    get_diagnostic(key) {\n        if (!this._diagnostics.has(key)) {\n            console.warn('Could not find the diagnostics row with key', key);\n            return;\n        }\n        return this._diagnostics.get(key);\n    }\n    jump_to(row) {\n        const cm_editor = row.data.editor;\n        focus_on(cm_editor.getWrapperElement());\n        cm_editor.getDoc().setCursor(row.data.range.start);\n        cm_editor.focus();\n    }\n}\n(function (DiagnosticsListing) {\n    /**\n     * A VDomModel for the LSP of current file editor/notebook.\n     */\n    class Model extends VDomModel {\n        constructor(translator_bundle) {\n            super();\n            this.trans = translator_bundle;\n        }\n    }\n    DiagnosticsListing.Model = Model;\n})(DiagnosticsListing || (DiagnosticsListing = {}));\n//# sourceMappingURL=listing.js.map","import { MainAreaWidget } from '@jupyterlab/apputils';\nimport { nullTranslator } from '@jupyterlab/translation';\nimport { LabIcon, copyIcon } from '@jupyterlab/ui-components';\nimport { Menu } from '@lumino/widgets';\nimport diagnosticsSvg from '../../../style/icons/diagnostics.svg';\nimport { PositionConverter } from '../../converter';\nimport { CodeMirrorIntegration } from '../../editor_integration/codemirror';\nimport { DiagnosticSeverity, DiagnosticTag } from '../../lsp';\nimport { DefaultMap, uris_equal } from '../../utils';\nimport { jumpToIcon } from '../jump_to';\nimport { DIAGNOSTICS_LISTING_CLASS, DiagnosticsDatabase, DiagnosticsListing } from './listing';\nexport const diagnosticsIcon = new LabIcon({\n    name: 'lsp:diagnostics',\n    svgstr: diagnosticsSvg\n});\nconst CMD_COLUMN_VISIBILITY = 'lsp-set-column-visibility';\nconst CMD_JUMP_TO_DIAGNOSTIC = 'lsp-jump-to-diagnostic';\nconst CMD_COPY_DIAGNOSTIC = 'lsp-copy-diagnostic';\nconst CMD_IGNORE_DIAGNOSTIC_CODE = 'lsp-ignore-diagnostic-code';\nconst CMD_IGNORE_DIAGNOSTIC_MSG = 'lsp-ignore-diagnostic-message';\n/**\n * Escape pattern to form a base of a regular expression.\n * The snippet comes from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#Escaping\n * and is in the Public Domain (CC0):\n *  > Any copyright is dedicated to the Public Domain.\n *  > http://creativecommons.org/publicdomain/zero/1.0/\n */\nfunction escapeRegExp(string) {\n    return string.replace(/[.*+\\-?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\nclass DiagnosticsPanel {\n    constructor(trans) {\n        this._content = null;\n        this._widget = null;\n        this.is_registered = false;\n        this.trans = trans;\n    }\n    get widget() {\n        if (this._widget == null || this._widget.content.model == null) {\n            if (this._widget && !this._widget.isDisposed) {\n                this._widget.dispose();\n            }\n            this._widget = this.initWidget();\n        }\n        return this._widget;\n    }\n    get content() {\n        return this.widget.content;\n    }\n    initWidget() {\n        this._content = new DiagnosticsListing(new DiagnosticsListing.Model(this.trans));\n        this._content.model.diagnostics = new DiagnosticsDatabase();\n        this._content.addClass('lsp-diagnostics-panel-content');\n        const widget = new MainAreaWidget({ content: this._content });\n        widget.id = 'lsp-diagnostics-panel';\n        widget.title.label = this.trans.__('Diagnostics Panel');\n        widget.title.closable = true;\n        widget.title.icon = diagnosticsIcon;\n        return widget;\n    }\n    update() {\n        // if not attached, do not bother to update\n        if (!this.widget.isAttached) {\n            return;\n        }\n        this.widget.content.update();\n    }\n    register(app) {\n        const widget = this.widget;\n        let get_column = (id) => {\n            // TODO: a hashmap in the panel itself?\n            for (let column of widget.content.columns) {\n                if (column.id === id) {\n                    return column;\n                }\n            }\n            return undefined;\n        };\n        /** Columns Menu **/\n        let columns_menu = new Menu({ commands: app.commands });\n        columns_menu.title.label = this.trans.__('Panel columns');\n        app.commands.addCommand(CMD_COLUMN_VISIBILITY, {\n            execute: args => {\n                let column = get_column(args['id']);\n                column.is_visible = !column.is_visible;\n                widget.update();\n            },\n            label: args => this.trans.__(args['id']),\n            isToggled: args => {\n                let column = get_column(args['id']);\n                return column ? column.is_visible : false;\n            }\n        });\n        for (let column of widget.content.columns) {\n            columns_menu.addItem({\n                command: CMD_COLUMN_VISIBILITY,\n                args: { id: column.id }\n            });\n        }\n        app.contextMenu.addItem({\n            selector: '.' + DIAGNOSTICS_LISTING_CLASS + ' th',\n            submenu: columns_menu,\n            type: 'submenu'\n        });\n        /** Diagnostics Menu **/\n        let ignore_diagnostics_menu = new Menu({ commands: app.commands });\n        ignore_diagnostics_menu.title.label = this.trans.__('Ignore diagnostics like this');\n        let get_row = () => {\n            let tr = app.contextMenuHitTest(node => node.tagName.toLowerCase() == 'tr');\n            if (!tr) {\n                return;\n            }\n            return this.widget.content.get_diagnostic(tr.dataset.key);\n        };\n        ignore_diagnostics_menu.addItem({\n            command: CMD_IGNORE_DIAGNOSTIC_CODE\n        });\n        ignore_diagnostics_menu.addItem({\n            command: CMD_IGNORE_DIAGNOSTIC_MSG\n        });\n        app.commands.addCommand(CMD_IGNORE_DIAGNOSTIC_CODE, {\n            execute: () => {\n                const row = get_row();\n                if (!row) {\n                    console.warn('LPS: diagnostics row not found for ignore code execute()');\n                    return;\n                }\n                const diagnostic = row.data.diagnostic;\n                let current = this.content.model.settings.composite.ignoreCodes;\n                this.content.model.settings.set('ignoreCodes', [\n                    ...current,\n                    diagnostic.code\n                ]);\n                this.feature.refreshDiagnostics();\n            },\n            isVisible: () => {\n                const row = get_row();\n                if (!row) {\n                    return false;\n                }\n                const diagnostic = row.data.diagnostic;\n                return !!diagnostic.code;\n            },\n            label: () => {\n                const row = get_row();\n                if (!row) {\n                    return '';\n                }\n                const diagnostic = row.data.diagnostic;\n                return this.trans.__('Ignore diagnostics with \"%1\" code', diagnostic.code);\n            }\n        });\n        app.commands.addCommand(CMD_IGNORE_DIAGNOSTIC_MSG, {\n            execute: () => {\n                const row = get_row();\n                if (!row) {\n                    console.warn('LPS: diagnostics row not found for ignore message execute()');\n                    return;\n                }\n                const diagnostic = row.data.diagnostic;\n                let current = this.content.model.settings.composite.ignoreMessagesPatterns;\n                this.content.model.settings.set('ignoreMessagesPatterns', [\n                    ...current,\n                    escapeRegExp(diagnostic.message)\n                ]);\n                this.feature.refreshDiagnostics();\n            },\n            isVisible: () => {\n                const row = get_row();\n                if (!row) {\n                    return false;\n                }\n                const diagnostic = row.data.diagnostic;\n                return !!diagnostic.message;\n            },\n            label: () => {\n                const row = get_row();\n                if (!row) {\n                    return '';\n                }\n                const diagnostic = row.data.diagnostic;\n                return this.trans.__('Ignore diagnostics with \"%1\" message', diagnostic.message);\n            }\n        });\n        app.commands.addCommand(CMD_JUMP_TO_DIAGNOSTIC, {\n            execute: () => {\n                const row = get_row();\n                if (!row) {\n                    console.warn('LPS: diagnostics row not found for jump execute()');\n                    return;\n                }\n                this.widget.content.jump_to(row);\n            },\n            label: this.trans.__('Jump to location'),\n            icon: jumpToIcon\n        });\n        app.commands.addCommand(CMD_COPY_DIAGNOSTIC, {\n            execute: () => {\n                const row = get_row();\n                if (!row) {\n                    console.warn('LPS: diagnostics row not found for copy execute()');\n                    return;\n                }\n                const message = row.data.diagnostic.message;\n                navigator.clipboard\n                    .writeText(message)\n                    .then(() => {\n                    this.content.model.status_message.set(this.trans.__('Successfully copied \"%1\" to clipboard', message));\n                })\n                    .catch(() => {\n                    console.warn('Could not copy with clipboard.writeText interface, falling back');\n                    window.prompt(this.trans.__('Your browser protects clipboard from write operations; please copy the message manually'), message);\n                });\n            },\n            label: this.trans.__(\"Copy diagnostics' message\"),\n            icon: copyIcon\n        });\n        app.contextMenu.addItem({\n            selector: '.' + DIAGNOSTICS_LISTING_CLASS + ' tbody tr',\n            command: CMD_COPY_DIAGNOSTIC\n        });\n        app.contextMenu.addItem({\n            selector: '.' + DIAGNOSTICS_LISTING_CLASS + ' tbody tr',\n            command: CMD_JUMP_TO_DIAGNOSTIC\n        });\n        app.contextMenu.addItem({\n            selector: '.' + DIAGNOSTICS_LISTING_CLASS + ' tbody tr',\n            submenu: ignore_diagnostics_menu,\n            type: 'submenu'\n        });\n        this.is_registered = true;\n    }\n}\nexport const diagnostics_panel = new DiagnosticsPanel(nullTranslator.load('jupyterlab_lsp'));\nexport const diagnostics_databases = new WeakMap();\nexport class DiagnosticsCM extends CodeMirrorIntegration {\n    constructor() {\n        super(...arguments);\n        this.marked_diagnostics = new Map();\n        this.switchDiagnosticsPanelSource = () => {\n            diagnostics_panel.trans = this.adapter.trans;\n            if (diagnostics_panel.content.model.virtual_editor === this.virtual_editor &&\n                diagnostics_panel.content.model.diagnostics == this.diagnostics_db) {\n                return;\n            }\n            diagnostics_panel.content.model.diagnostics = this.diagnostics_db;\n            diagnostics_panel.content.model.virtual_editor = this.virtual_editor;\n            diagnostics_panel.content.model.adapter = this.adapter;\n            diagnostics_panel.content.model.settings = this.settings;\n            diagnostics_panel.content.model.status_message = this.status_message;\n            diagnostics_panel.feature = this;\n            diagnostics_panel.update();\n        };\n        this.handleDiagnostic = (connection, response) => {\n            var _a, _b;\n            // use optional chaining operator because the diagnostics message may come late (after the document was disposed)\n            if (!uris_equal(response.uri, (_b = (_a = this.virtual_document) === null || _a === void 0 ? void 0 : _a.document_info) === null || _b === void 0 ? void 0 : _b.uri)) {\n                return;\n            }\n            if (this.virtual_document.last_virtual_line === 0) {\n                return;\n            }\n            /* TODO: gutters */\n            try {\n                this.last_response = response;\n                this.setDiagnostics(response);\n                diagnostics_panel.update();\n            }\n            catch (e) {\n                this.console.warn(e);\n            }\n        };\n    }\n    get settings() {\n        return super.settings;\n    }\n    register() {\n        // this.connection_handlers.set('diagnostic', this.handleDiagnostic);\n        // TODO: unregister\n        this.connection.serverNotifications['textDocument/publishDiagnostics'].connect(this.handleDiagnostic);\n        this.wrapper_handlers.set('focusin', this.switchDiagnosticsPanelSource);\n        this.unique_editor_ids = new DefaultMap(() => this.unique_editor_ids.size);\n        this.settings.changed.connect(this.refreshDiagnostics, this);\n        this.adapter.adapterConnected.connect(() => this.switchDiagnosticsPanelSource());\n        this.virtual_document.foreign_document_closed.connect((document, context) => {\n            this.clearDocumentDiagnostics(context.foreign_document);\n        });\n        super.register();\n    }\n    clearDocumentDiagnostics(document) {\n        this.diagnostics_db.set(document, []);\n    }\n    /**\n     * Allows access to the most recent diagnostics in context of the editor.\n     *\n     * One can use VirtualEditorForNotebook.find_cell_by_editor() to find\n     * the corresponding cell in notebook.\n     * Can be used to implement a Panel showing diagnostics list.\n     *\n     * Maps virtual_document.uri to IEditorDiagnostic[].\n     */\n    get diagnostics_db() {\n        // Note that virtual_editor can change at runtime (kernel restart)\n        if (!diagnostics_databases.has(this.virtual_editor)) {\n            diagnostics_databases.set(this.virtual_editor, new DiagnosticsDatabase());\n        }\n        return diagnostics_databases.get(this.virtual_editor);\n    }\n    collapseOverlappingDiagnostics(diagnostics) {\n        // because Range is not a primitive type, the equality of the objects having\n        // the same parameters won't be compared (thus considered equal) in Map.\n        const range_id_to_range = new Map();\n        const range_id_to_diagnostics = new Map();\n        function get_range_id(range) {\n            return (range.start.line +\n                ',' +\n                range.start.character +\n                ',' +\n                range.end.line +\n                ',' +\n                range.end.character);\n        }\n        diagnostics.forEach((diagnostic) => {\n            let range = diagnostic.range;\n            let range_id = get_range_id(range);\n            range_id_to_range.set(range_id, range);\n            if (range_id_to_diagnostics.has(range_id)) {\n                let ranges_list = range_id_to_diagnostics.get(range_id);\n                ranges_list.push(diagnostic);\n            }\n            else {\n                range_id_to_diagnostics.set(range_id, [diagnostic]);\n            }\n        });\n        let map = new Map();\n        range_id_to_diagnostics.forEach((range_diagnostics, range_id) => {\n            let range = range_id_to_range.get(range_id);\n            map.set(range, range_diagnostics);\n        });\n        return map;\n    }\n    get defaultSeverity() {\n        return DiagnosticSeverity[this.settings.composite.defaultSeverity];\n    }\n    filterDiagnostics(diagnostics) {\n        const ignoredDiagnosticsCodes = new Set(this.settings.composite.ignoreCodes);\n        const ignoredMessagesRegExp = this.settings.composite.ignoreMessagesPatterns.map(pattern => new RegExp(pattern));\n        return diagnostics.filter(diagnostic => {\n            let code = diagnostic.code;\n            if (typeof code !== 'undefined' &&\n                // pygls servers return code null if value is missing (rather than undefined)\n                // which is a departure from the LSP specs: https://microsoft.github.io/language-server-protocol/specification#diagnostic\n                // there is an open issue: https://github.com/openlawlibrary/pygls/issues/124\n                // and PR: https://github.com/openlawlibrary/pygls/pull/132\n                // this also affects hover tooltips.\n                code !== null &&\n                ignoredDiagnosticsCodes.has(code.toString())) {\n                return false;\n            }\n            let message = diagnostic.message;\n            if (message &&\n                ignoredMessagesRegExp.some(pattern => pattern.test(message))) {\n                return false;\n            }\n            return true;\n        });\n    }\n    setDiagnostics(response) {\n        let diagnostics_list = [];\n        // Note: no deep equal for Sets or Maps in JS\n        const markers_to_retain = new Set();\n        // add new markers, keep track of the added ones\n        // TODO: test case for severity class always being set, even if diagnostic has no severity\n        let diagnostics_by_range = this.collapseOverlappingDiagnostics(this.filterDiagnostics(response.diagnostics));\n        diagnostics_by_range.forEach((diagnostics, range) => {\n            const start = PositionConverter.lsp_to_cm(range.start);\n            const end = PositionConverter.lsp_to_cm(range.end);\n            const last_line_number = this.virtual_document.last_virtual_line -\n                this.virtual_document.blank_lines_between_cells;\n            if (start.line > last_line_number) {\n                this.console.log(`Out of range diagnostic (${start.line} line > ${last_line_number}) was skipped `, diagnostics);\n                return;\n            }\n            else {\n                let last_line = this.virtual_document.last_line;\n                if (start.line == last_line_number && start.ch > last_line.length) {\n                    this.console.log(`Out of range diagnostic (${start.ch} character > ${last_line.length} at line ${last_line_number}) was skipped `, diagnostics);\n                    return;\n                }\n            }\n            let document;\n            try {\n                // assuming that we got a response for this document\n                let start_in_root = this.transform_virtual_position_to_root_position(start);\n                document =\n                    this.virtual_editor.document_at_root_position(start_in_root);\n            }\n            catch (e) {\n                this.console.warn(`Could not place inspections from ${response.uri}`, ` inspections: `, diagnostics, 'error: ', e);\n                return;\n            }\n            // This may happen if the response came delayed\n            // and the user already changed the document so\n            // that now this regions is in another virtual document!\n            if (this.virtual_document !== document) {\n                this.console.log(`Ignoring inspections from ${response.uri}`, ` (this region is covered by a another virtual document: ${document.uri})`, ` inspections: `, diagnostics);\n                return;\n            }\n            if (document.virtual_lines\n                .get(start.line)\n                .skip_inspect.indexOf(document.id_path) !== -1) {\n                this.console.log('Ignoring inspections silenced for this document:', diagnostics);\n                return;\n            }\n            let ce_editor = document.get_editor_at_virtual_line(start);\n            let cm_editor = this.virtual_editor.ce_editor_to_cm_editor.get(ce_editor);\n            let start_in_editor = document.transform_virtual_to_editor(start);\n            let end_in_editor;\n            if (start_in_editor === null) {\n                this.console.warn('Start in editor could not be be determined for', diagnostics);\n                return;\n            }\n            // some servers return strange positions for ends\n            try {\n                end_in_editor = document.transform_virtual_to_editor(end);\n            }\n            catch (err) {\n                this.console.warn('Malformed range for diagnostic', end);\n                end_in_editor = Object.assign(Object.assign({}, start_in_editor), { ch: start_in_editor.ch + 1 });\n            }\n            if (end_in_editor === null) {\n                this.console.warn('End in editor could not be be determined for', diagnostics);\n                return;\n            }\n            let range_in_editor = {\n                start: start_in_editor,\n                end: end_in_editor\n            };\n            // what a pity there is no hash in the standard library...\n            // we could use this: https://stackoverflow.com/a/7616484 though it may not be worth it:\n            //   the stringified diagnostic objects are only about 100-200 JS characters anyway,\n            //   depending on the message length; this could be reduced using some structure-aware\n            //   stringifier; such a stringifier could also prevent the possibility of having a false\n            //   negative due to a different ordering of keys\n            // obviously, the hash would prevent recovery of info from the key.\n            let diagnostic_hash = JSON.stringify({\n                // diagnostics without ranges\n                diagnostics: diagnostics.map(diagnostic => [\n                    diagnostic.severity,\n                    diagnostic.message,\n                    diagnostic.code,\n                    diagnostic.source,\n                    diagnostic.relatedInformation\n                ]),\n                // the apparent marker position will change in the notebook with every line change for each marker\n                // after the (inserted/removed) line - but such markers should not be invalidated,\n                // i.e. the invalidation should be performed in the cell space, not in the notebook coordinate space,\n                // thus we transform the coordinates and keep the cell id in the hash\n                range: range_in_editor,\n                editor: this.unique_editor_ids.get(cm_editor)\n            });\n            for (let diagnostic of diagnostics) {\n                diagnostics_list.push({\n                    diagnostic,\n                    editor: cm_editor,\n                    range: range_in_editor\n                });\n            }\n            markers_to_retain.add(diagnostic_hash);\n            if (!this.marked_diagnostics.has(diagnostic_hash)) {\n                const highestSeverityCode = diagnostics\n                    .map(diagnostic => diagnostic.severity || this.defaultSeverity)\n                    .sort()[0];\n                const severity = DiagnosticSeverity[highestSeverityCode];\n                const classNames = [\n                    'cm-lsp-diagnostic',\n                    'cm-lsp-diagnostic-' + severity\n                ];\n                const tags = [];\n                for (let diagnostic of diagnostics) {\n                    if (diagnostic.tags) {\n                        tags.push(...diagnostic.tags);\n                    }\n                }\n                for (const tag of new Set(tags)) {\n                    classNames.push('cm-lsp-diagnostic-tag-' + DiagnosticTag[tag]);\n                }\n                let options = {\n                    title: diagnostics\n                        .map(d => d.message + (d.source ? ' (' + d.source + ')' : ''))\n                        .join('\\n'),\n                    className: classNames.join(' ')\n                };\n                let marker;\n                try {\n                    marker = cm_editor\n                        .getDoc()\n                        .markText(start_in_editor, end_in_editor, options);\n                }\n                catch (e) {\n                    this.console.warn('Marking inspection (diagnostic text) failed:', diagnostics, e);\n                    return;\n                }\n                this.marked_diagnostics.set(diagnostic_hash, marker);\n            }\n        });\n        // remove the markers which were not included in the new message\n        this.removeUnusedDiagnosticMarkers(markers_to_retain);\n        this.diagnostics_db.set(this.virtual_document, diagnostics_list);\n    }\n    refreshDiagnostics() {\n        if (this.last_response) {\n            this.setDiagnostics(this.last_response);\n        }\n        diagnostics_panel.update();\n    }\n    removeUnusedDiagnosticMarkers(to_retain) {\n        this.marked_diagnostics.forEach((marker, diagnostic_hash) => {\n            if (!to_retain.has(diagnostic_hash)) {\n                this.marked_diagnostics.delete(diagnostic_hash);\n                marker.clear();\n            }\n        });\n    }\n    remove() {\n        this.settings.changed.disconnect(this.refreshDiagnostics, this);\n        // remove all markers\n        this.removeUnusedDiagnosticMarkers(new Set());\n        this.diagnostics_db.clear();\n        diagnostics_databases.delete(this.virtual_editor);\n        this.unique_editor_ids.clear();\n        if (diagnostics_panel.content.model.virtual_editor === this.virtual_editor) {\n            diagnostics_panel.content.model.virtual_editor = null;\n            diagnostics_panel.content.model.diagnostics = null;\n            diagnostics_panel.content.model.adapter = null;\n        }\n        diagnostics_panel.update();\n        super.remove();\n    }\n}\n//# sourceMappingURL=diagnostics.js.map","import { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { ITranslator } from '@jupyterlab/translation';\nimport { FeatureSettings } from '../../feature';\nimport { DiagnosticTag } from '../../lsp';\nimport { ILSPFeatureManager, PLUGIN_ID } from '../../tokens';\nimport { DiagnosticsCM, diagnosticsIcon, diagnostics_panel } from './diagnostics';\nexport const FEATURE_ID = PLUGIN_ID + ':diagnostics';\nconst COMMANDS = (trans) => [\n    {\n        id: 'show-diagnostics-panel',\n        execute: ({ app, features, adapter }) => {\n            let diagnostics_feature = features.get(FEATURE_ID);\n            diagnostics_feature.switchDiagnosticsPanelSource();\n            if (!diagnostics_panel.is_registered) {\n                diagnostics_panel.trans = trans;\n                diagnostics_panel.register(app);\n            }\n            const panel_widget = diagnostics_panel.widget;\n            if (!panel_widget.isAttached) {\n                app.shell.add(panel_widget, 'main', {\n                    ref: adapter.widget_id,\n                    mode: 'split-bottom'\n                });\n            }\n            app.shell.activateById(panel_widget.id);\n        },\n        is_enabled: context => {\n            return context.app.name != 'JupyterLab Classic';\n        },\n        label: trans.__('Show diagnostics panel'),\n        rank: 3,\n        icon: diagnosticsIcon\n    }\n];\nexport const DIAGNOSTICS_PLUGIN = {\n    id: FEATURE_ID,\n    requires: [ILSPFeatureManager, ISettingRegistry, ITranslator],\n    autoStart: true,\n    activate: (app, featureManager, settingRegistry, translator) => {\n        const settings = new FeatureSettings(settingRegistry, FEATURE_ID);\n        const trans = translator.load('jupyterlab_lsp');\n        featureManager.register({\n            feature: {\n                editorIntegrationFactory: new Map([\n                    ['CodeMirrorEditor', DiagnosticsCM]\n                ]),\n                id: FEATURE_ID,\n                capabilities: {\n                    textDocument: {\n                        publishDiagnostics: {\n                            tagSupport: {\n                                valueSet: [DiagnosticTag.Deprecated, DiagnosticTag.Unnecessary]\n                            }\n                        }\n                    }\n                },\n                name: 'LSP Diagnostics',\n                settings: settings,\n                commands: COMMANDS(trans)\n            }\n        });\n    }\n};\n//# sourceMappingURL=index.js.map","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n    <path d=\\\"M18.5 1.15c-.53 0-1.04.19-1.43.58l-5.81 5.82 5.65 5.65 5.82-5.81c.77-.78.77-2.04 0-2.83l-2.84-2.83c-.39-.39-.89-.58-1.39-.58M10.3 8.5l-5.96 5.96c-.78.78-.78 2.04.02 2.85C3.14 18.54 1.9 19.77.67 21h5.66l.86-.86c.78.76 2.03.75 2.81-.02l5.95-5.96M18 16v2h2v8h2v-8h2v-2h-6z\\\"/>\\n  </g>\\n</svg>\\n\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n    <path d=\\\"M18.5 1.15c-.53 0-1.04.19-1.43.58l-5.81 5.82 5.65 5.65 5.82-5.81c.77-.78.77-2.04 0-2.83l-2.84-2.83c-.39-.39-.89-.58-1.39-.58M10.3 8.5l-5.96 5.96c-.78.78-.78 2.04.02 2.85C3.14 18.54 1.9 19.77.67 21h5.66l.86-.86c.78.76 2.03.75 2.81-.02l5.95-5.96\\\"/>\\n  </g>\\n</svg>\\n\";","import { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { ITranslator } from '@jupyterlab/translation';\nimport { LabIcon } from '@jupyterlab/ui-components';\nimport { Debouncer } from '@lumino/polling';\nimport highlightTypeSvg from '../../style/icons/highlight-type.svg';\nimport highlightSvg from '../../style/icons/highlight.svg';\nimport { CodeMirrorIntegration } from '../editor_integration/codemirror';\nimport { FeatureSettings } from '../feature';\nimport { DocumentHighlightKind } from '../lsp';\nimport { ILSPFeatureManager, PLUGIN_ID } from '../tokens';\nexport const highlightIcon = new LabIcon({\n    name: 'lsp:highlight',\n    svgstr: highlightSvg\n});\nexport const highlightTypeIcon = new LabIcon({\n    name: 'lsp:highlight-type',\n    svgstr: highlightTypeSvg\n});\nconst COMMANDS = (trans) => [\n    {\n        id: 'highlight-references',\n        execute: ({ connection, virtual_position, document }) => connection === null || connection === void 0 ? void 0 : connection.getReferences(virtual_position, document.document_info),\n        is_enabled: ({ connection }) => connection ? connection.isReferencesSupported() : false,\n        label: trans.__('Highlight references'),\n        icon: highlightIcon\n    },\n    {\n        id: 'highlight-type-definition',\n        execute: ({ connection, virtual_position, document }) => connection === null || connection === void 0 ? void 0 : connection.getTypeDefinition(virtual_position, document.document_info),\n        is_enabled: ({ connection }) => connection ? connection.isTypeDefinitionSupported() : false,\n        label: trans.__('Highlight type definition'),\n        icon: highlightTypeIcon\n    }\n];\nexport class HighlightsCM extends CodeMirrorIntegration {\n    constructor() {\n        super(...arguments);\n        this.highlight_markers = [];\n        this.last_token = null;\n        this.onBlur = () => {\n            if (this.settings.composite.removeOnBlur) {\n                this.clear_markers();\n                this.last_token = null;\n            }\n            else {\n                this.onCursorActivity().catch(console.warn);\n            }\n        };\n        this.handleHighlight = (items) => {\n            this.clear_markers();\n            if (!items) {\n                return;\n            }\n            for (let item of items) {\n                let range = this.range_to_editor_range(item.range);\n                let kind_class = item.kind\n                    ? 'cm-lsp-highlight-' + DocumentHighlightKind[item.kind]\n                    : '';\n                let marker = this.highlight_range(range, 'cm-lsp-highlight ' + kind_class);\n                this.highlight_markers.push(marker);\n            }\n        };\n        this.on_cursor_activity = async () => {\n            this.sent_version = this.virtual_document.document_info.version;\n            return await this.connection.getDocumentHighlights(this.virtual_position, this.virtual_document.document_info, false);\n        };\n        this.onCursorActivity = async () => {\n            var _a, _b;\n            if (!((_b = (_a = this.virtual_editor) === null || _a === void 0 ? void 0 : _a.virtual_document) === null || _b === void 0 ? void 0 : _b.document_info)) {\n                return;\n            }\n            let root_position;\n            await this.virtual_editor.virtual_document.update_manager.update_done;\n            try {\n                root_position = this.virtual_editor\n                    .getDoc()\n                    .getCursor('start');\n            }\n            catch (err) {\n                this.console.warn('no root position available');\n                return;\n            }\n            if (root_position == null) {\n                this.console.warn('no root position available');\n                return;\n            }\n            const token = this.virtual_editor.get_token_at(root_position);\n            // if token has not changed, no need to update highlight, unless it is an empty token\n            // which would indicate that the cursor is at the first character\n            if (this.last_token &&\n                token.value === this.last_token.value &&\n                token.value !== '') {\n                this.console.log('not requesting highlights (token did not change)', token);\n                return;\n            }\n            let document;\n            try {\n                document = this.virtual_editor.document_at_root_position(root_position);\n            }\n            catch (e) {\n                this.console.warn('Could not obtain virtual document from position', root_position);\n                return;\n            }\n            if (document !== this.virtual_document) {\n                return;\n            }\n            try {\n                let virtual_position = this.virtual_editor.root_position_to_virtual_position(root_position);\n                this.virtual_position = virtual_position;\n                Promise.all([\n                    // request the highlights as soon as possible\n                    this.debounced_get_highlight.invoke(),\n                    // and in the meantime remove the old markers\n                    async () => {\n                        this.clear_markers();\n                        this.last_token = null;\n                    }\n                ])\n                    .then(([highlights]) => {\n                    // in the time the response returned the document might have been closed - check that\n                    if (this.virtual_document.isDisposed) {\n                        return;\n                    }\n                    let version_after = this.virtual_document.document_info.version;\n                    /// if document was updated since (e.g. user pressed delete - token change, but position did not)\n                    if (version_after !== this.sent_version) {\n                        this.console.log('skipping highlights response delayed by ' +\n                            (version_after - this.sent_version) +\n                            ' document versions');\n                        return;\n                    }\n                    // if cursor position changed (e.g. user moved cursor up - position has changed, but document version did not)\n                    if (virtual_position !== this.virtual_position) {\n                        this.console.log('skipping highlights response: cursor moved since it was requested');\n                        return;\n                    }\n                    this.handleHighlight(highlights);\n                    this.last_token = token;\n                })\n                    .catch(this.console.warn);\n            }\n            catch (e) {\n                this.console.warn('Could not get highlights:', e);\n            }\n        };\n    }\n    get settings() {\n        return super.settings;\n    }\n    register() {\n        this.debounced_get_highlight = this.create_debouncer();\n        this.settings.changed.connect(() => {\n            this.debounced_get_highlight = this.create_debouncer();\n        });\n        this.editor_handlers.set('cursorActivity', this.onCursorActivity);\n        this.editor_handlers.set('blur', this.onBlur);\n        this.editor_handlers.set('focus', this.onCursorActivity);\n        super.register();\n    }\n    remove() {\n        this.clear_markers();\n        super.remove();\n    }\n    clear_markers() {\n        for (let marker of this.highlight_markers) {\n            marker.clear();\n        }\n        this.highlight_markers = [];\n    }\n    create_debouncer() {\n        return new Debouncer(this.on_cursor_activity, this.settings.composite.debouncerDelay);\n    }\n}\nconst FEATURE_ID = PLUGIN_ID + ':highlights';\nexport const HIGHLIGHTS_PLUGIN = {\n    id: FEATURE_ID,\n    requires: [ILSPFeatureManager, ISettingRegistry, ITranslator],\n    autoStart: true,\n    activate: (app, featureManager, settingRegistry, translator) => {\n        const settings = new FeatureSettings(settingRegistry, FEATURE_ID);\n        const trans = translator.load('jupyterlab_lsp');\n        featureManager.register({\n            feature: {\n                editorIntegrationFactory: new Map([['CodeMirrorEditor', HighlightsCM]]),\n                id: FEATURE_ID,\n                name: 'LSP Highlights',\n                settings: settings,\n                commands: COMMANDS(trans)\n            }\n        });\n    }\n};\n//# sourceMappingURL=highlights.js.map","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n    <path d=\\\"M11 18h2v-2h-2v2m1-12a4 4 0 00-4 4h2a2 2 0 012-2 2 2 0 012 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5a4 4 0 00-4-4M5 3h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2z\\\"/>\\n  </g>\\n</svg>\\n\";","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n// (Parts of the FreeTooltip code are copy-paste from Tooltip, ideally this would be PRed be merged)\nimport { HoverBox } from '@jupyterlab/apputils';\nimport { MimeModel } from '@jupyterlab/rendermime';\nimport { Tooltip } from '@jupyterlab/tooltip';\nimport { Widget } from '@lumino/widgets';\nimport { PositionConverter } from '../converter';\nconst MIN_HEIGHT = 20;\nconst MAX_HEIGHT = 250;\nconst CLASS_NAME = 'lsp-tooltip';\n/**\n * Tooltip which can be placed  at any character, not only at the current position (derived from getCursorPosition)\n */\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nexport class FreeTooltip extends Tooltip {\n    constructor(options) {\n        super(options);\n        this.options = options;\n        this._setGeometry();\n        // TODO: remove once https://github.com/jupyterlab/jupyterlab/pull/11010 is merged & released\n        const model = new MimeModel({ data: options.bundle });\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        const content = this._content;\n        content\n            .renderModel(model)\n            .then(() => this._setGeometry())\n            .catch(console.warn);\n    }\n    handleEvent(event) {\n        if (this.isHidden || this.isDisposed) {\n            return;\n        }\n        const { node } = this;\n        const target = event.target;\n        switch (event.type) {\n            case 'keydown': {\n                const keyCode = event.keyCode;\n                // ESC or Backspace cancel anyways\n                if (node.contains(target) ||\n                    (!this.options.hideOnKeyPress && keyCode != 27 && keyCode != 8)) {\n                    return;\n                }\n                this.dispose();\n                break;\n            }\n            default:\n                super.handleEvent(event);\n                break;\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    _setGeometry() {\n        // Find the start of the current token for hover box placement.\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        const editor = this._editor;\n        const cursor = this.options.position == null\n            ? editor.getCursorPosition()\n            : this.options.position;\n        const end = editor.getOffsetAt(cursor);\n        const line = editor.getLine(cursor.line);\n        if (!line) {\n            return;\n        }\n        let position;\n        switch (this.options.alignment) {\n            case 'start': {\n                const tokens = line.substring(0, end).split(/\\W+/);\n                const last = tokens[tokens.length - 1];\n                const start = last ? end - last.length : end;\n                position = editor.getPositionAt(start);\n                break;\n            }\n            case 'end': {\n                const tokens = line.substring(0, end).split(/\\W+/);\n                const last = tokens[tokens.length - 1];\n                const start = last ? end - last.length : end;\n                position = editor.getPositionAt(start);\n                break;\n            }\n            default: {\n                position = cursor;\n                break;\n            }\n        }\n        if (!position) {\n            return;\n        }\n        const anchor = editor.getCoordinateForPosition(position);\n        const style = window.getComputedStyle(this.node);\n        const paddingLeft = parseInt(style.paddingLeft, 10) || 0;\n        // Calculate the geometry of the tooltip.\n        HoverBox.setGeometry({\n            anchor,\n            host: editor.host,\n            maxHeight: MAX_HEIGHT,\n            minHeight: MIN_HEIGHT,\n            node: this.node,\n            offset: { horizontal: -1 * paddingLeft },\n            privilege: this.options.privilege || 'below',\n            style: style\n        });\n    }\n}\nexport class EditorTooltipManager {\n    constructor(rendermime_registry) {\n        this.rendermime_registry = rendermime_registry;\n        this.currentTooltip = null;\n    }\n    create(options) {\n        this.remove();\n        this.currentOptions = options;\n        let { markup, position, adapter } = options;\n        let widget = adapter.widget;\n        const bundle = markup.kind === 'plaintext'\n            ? { 'text/plain': markup.value }\n            : { 'text/markdown': markup.value };\n        const tooltip = new FreeTooltip(Object.assign(Object.assign({}, (options.tooltip || {})), { anchor: widget.content, bundle: bundle, editor: options.ce_editor, rendermime: this.rendermime_registry, position: PositionConverter.cm_to_ce(position) }));\n        tooltip.addClass(CLASS_NAME);\n        if (options.className) {\n            tooltip.addClass(options.className);\n        }\n        Widget.attach(tooltip, document.body);\n        this.currentTooltip = tooltip;\n        return tooltip;\n    }\n    get position() {\n        return this.currentOptions.position;\n    }\n    isShown(id) {\n        var _a;\n        if (id && this.currentOptions && ((_a = this.currentOptions) === null || _a === void 0 ? void 0 : _a.id) !== id) {\n            return false;\n        }\n        return (this.currentTooltip !== null &&\n            !this.currentTooltip.isDisposed &&\n            this.currentTooltip.isVisible);\n    }\n    remove() {\n        if (this.currentTooltip !== null) {\n            this.currentTooltip.dispose();\n            this.currentTooltip = null;\n        }\n    }\n}\n//# sourceMappingURL=free_tooltip.js.map","import { IRenderMimeRegistry } from '@jupyterlab/rendermime';\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { LabIcon } from '@jupyterlab/ui-components';\nimport { Throttler } from '@lumino/polling';\nimport hoverSvg from '../../style/icons/hover.svg';\nimport { EditorTooltipManager } from '../components/free_tooltip';\nimport { PositionConverter } from '../converter';\nimport { CodeMirrorIntegration } from '../editor_integration/codemirror';\nimport { FeatureSettings } from '../feature';\nimport { is_equal } from '../positioning';\nimport { ILSPFeatureManager, PLUGIN_ID } from '../tokens';\nimport { getModifierState } from '../utils';\nexport const hoverIcon = new LabIcon({\n    name: 'lsp:hover',\n    svgstr: hoverSvg\n});\n/**\n * Check whether mouse is close to given element (within a specified number of pixels)\n * @param what target element\n * @param who mouse event determining position and target\n * @param cushion number of pixels on each side defining \"closeness\" boundary\n */\nfunction isCloseTo(what, who, cushion = 50) {\n    const target = who.type === 'mouseleave' ? who.relatedTarget : who.target;\n    if (what === target || what.contains(target)) {\n        return true;\n    }\n    const whatRect = what.getBoundingClientRect();\n    return !(who.x < whatRect.left - cushion ||\n        who.x > whatRect.right + cushion ||\n        who.y < whatRect.top - cushion ||\n        who.y > whatRect.bottom + cushion);\n}\nclass ResponseCache {\n    constructor(maxSize) {\n        this.maxSize = maxSize;\n        this._data = [];\n    }\n    get data() {\n        return this._data;\n    }\n    store(item) {\n        const previousIndex = this._data.findIndex(previous => previous.document === item.document &&\n            is_equal(previous.editor_range.start, item.editor_range.start) &&\n            is_equal(previous.editor_range.end, item.editor_range.end) &&\n            previous.editor_range.editor === item.editor_range.editor);\n        if (previousIndex !== -1) {\n            this._data[previousIndex] = item;\n            return;\n        }\n        if (this._data.length >= this.maxSize) {\n            this._data.shift();\n        }\n        this._data.push(item);\n    }\n    clean() {\n        this._data = [];\n    }\n}\nfunction to_markup(content) {\n    if (typeof content === 'string') {\n        // coerce deprecated MarkedString to an MarkupContent; if given as a string it is markdown too,\n        // quote: \"It is either a markdown string or a code-block that provides a language and a code snippet.\"\n        // (https://microsoft.github.io/language-server-protocol/specifications/specification-3-17/#markedString)\n        return {\n            kind: 'markdown',\n            value: content\n        };\n    }\n    else {\n        return {\n            kind: 'markdown',\n            value: '```' + content.language + '\\n' + content.value + '\\n```'\n        };\n    }\n}\nexport class HoverCM extends CodeMirrorIntegration {\n    constructor(options) {\n        super(options);\n        this.last_hover_character = null;\n        this.hover_marker = null;\n        this._previousHoverRequest = null;\n        this.onKeyDown = (event) => {\n            if (getModifierState(event, this.modifierKey) &&\n                this.last_hover_character !== null) {\n                // does not need to be shown if it is already visible (otherwise we would be creating an identical tooltip again!)\n                if (this.tooltip && this.tooltip.isVisible && !this.tooltip.isDisposed) {\n                    return;\n                }\n                const document = this.virtual_editor.document_at_root_position(this.last_hover_character);\n                let response_data = this.restore_from_cache(document, this.virtual_position);\n                if (response_data == null) {\n                    return;\n                }\n                event.stopPropagation();\n                this.handleResponse(response_data, this.last_hover_character, true);\n            }\n        };\n        this.onMouseLeave = (event) => {\n            this.remove_range_highlight();\n            this.maybeHideTooltip(event);\n        };\n        this.on_hover = async () => {\n            var _a;\n            if (!(this.connection.isReady && ((_a = this.connection.serverCapabilities) === null || _a === void 0 ? void 0 : _a.hoverProvider))) {\n                return;\n            }\n            let position = this.virtual_position;\n            return await this.connection.clientRequests['textDocument/hover'].request({\n                textDocument: {\n                    // this might be wrong - should not it be using the specific virtual document?\n                    uri: this.virtual_document.document_info.uri\n                },\n                position: {\n                    line: position.line,\n                    character: position.ch\n                }\n            });\n        };\n        /**\n         * Underlines the word if a tooltip is available.\n         * Displays tooltip if asked to do so.\n         *\n         * Returns true is the tooltip was shown.\n         */\n        this.handleResponse = (response_data, root_position, show_tooltip) => {\n            let response = response_data.response;\n            // testing for object equality because the response will likely be reused from cache\n            if (this.last_hover_response != response) {\n                this.remove_range_highlight();\n                this.hover_marker = this.highlight_range(response_data.editor_range, 'cm-lsp-hover-available');\n            }\n            this.last_hover_response = response;\n            if (show_tooltip) {\n                this.lab_integration.tooltip.remove();\n                const markup = HoverCM.get_markup_for_hover(response);\n                let editor_position = this.virtual_editor.root_position_to_editor(root_position);\n                this.tooltip = this.lab_integration.tooltip.create({\n                    markup,\n                    position: editor_position,\n                    ce_editor: response_data.ce_editor,\n                    adapter: this.adapter,\n                    className: 'lsp-hover'\n                });\n                return true;\n            }\n            return false;\n        };\n        this.updateUnderlineAndTooltip = (event) => {\n            try {\n                return this._updateUnderlineAndTooltip(event);\n            }\n            catch (e) {\n                if (!(e.message === 'Cell not found in cell_line_map' ||\n                    e.message === \"Cannot read property 'string' of undefined\")) {\n                    this.console.warn(e);\n                }\n                return undefined;\n            }\n        };\n        this.remove_range_highlight = () => {\n            if (this.hover_marker) {\n                this.hover_marker.clear();\n                this.hover_marker = null;\n                this.last_hover_response = null;\n                this.last_hover_character = null;\n            }\n        };\n    }\n    get modifierKey() {\n        return this.settings.composite.modifierKey;\n    }\n    get lab_integration() {\n        return super.lab_integration;\n    }\n    get settings() {\n        return super.settings;\n    }\n    restore_from_cache(document, virtual_position) {\n        const { line, ch } = virtual_position;\n        const matching_items = this.cache.data.filter(cache_item => {\n            if (cache_item.document !== document) {\n                return false;\n            }\n            let range = cache_item.response.range;\n            return (line >= range.start.line &&\n                line <= range.end.line &&\n                // need to be non-overlapping see https://github.com/jupyter-lsp/jupyterlab-lsp/issues/628\n                (line != range.start.line || ch > range.start.character) &&\n                (line != range.end.line || ch <= range.end.character));\n        });\n        if (matching_items.length > 1) {\n            this.console.warn('Potential hover cache malfunction: ', virtual_position, matching_items);\n        }\n        return matching_items.length != 0 ? matching_items[0] : null;\n    }\n    register() {\n        this.cache = new ResponseCache(this.settings.composite.cacheSize);\n        this.wrapper_handlers.set('mousemove', event => {\n            var _a;\n            // as CodeMirror.Editor does not support mouseleave nor mousemove,\n            // we simulate the mouseleave for the editor in wrapper's mousemove;\n            // this is used to hide the tooltip on leaving cells in notebook\n            (_a = this.updateUnderlineAndTooltip(event)) === null || _a === void 0 ? void 0 : _a.then(keep_tooltip => {\n                if (!keep_tooltip) {\n                    this.maybeHideTooltip(event);\n                }\n            }).catch(this.console.warn);\n        });\n        this.wrapper_handlers.set('mouseleave', this.onMouseLeave);\n        // show hover after pressing the modifier key\n        // TODO: when the editor (notebook or file editor) is not focused, the keydown event is not getting to us\n        //  (probably getting captured by lab); this gives subpar experience when using hover in two editors open\n        //  side-by-side, BUT this does not happen for mousemove which properly reads keyModifier from the event\n        //  (so this is no too bad as most of the time the user will get the desired outcome - they just need to\n        //  budge the mice when holding ctrl if looking at a document which is not active).\n        // whether the editor is focused\n        this.wrapper_handlers.set('keydown', this.onKeyDown);\n        // or just the wrapper (e.g. the notebook but no cell active)\n        this.editor_handlers.set('keydown', (instance, event) => this.onKeyDown(event));\n        this.debounced_get_hover = this.create_throttler();\n        this.settings.changed.connect(() => {\n            this.cache.maxSize = this.settings.composite.cacheSize;\n            this.debounced_get_hover = this.create_throttler();\n        });\n        super.register();\n    }\n    maybeHideTooltip(mouseEvent) {\n        if (typeof this.tooltip !== 'undefined' &&\n            !isCloseTo(this.tooltip.node, mouseEvent)) {\n            this.tooltip.dispose();\n        }\n    }\n    create_throttler() {\n        return new Throttler(this.on_hover, {\n            limit: this.settings.composite.throttlerDelay,\n            edge: 'trailing'\n        });\n    }\n    afterChange(change, root_position) {\n        super.afterChange(change, root_position);\n        // reset cache on any change in the document\n        this.cache.clean();\n        this.last_hover_character = null;\n        this.remove_range_highlight();\n    }\n    static get_markup_for_hover(response) {\n        let contents = response.contents;\n        if (typeof contents === 'string') {\n            contents = [contents];\n        }\n        if (!Array.isArray(contents)) {\n            return contents;\n        }\n        let markups = contents.map(to_markup);\n        if (markups.every(markup => markup.kind == 'plaintext')) {\n            return {\n                kind: 'plaintext',\n                value: markups.map(markup => markup.value).join('\\n')\n            };\n        }\n        else {\n            return {\n                kind: 'markdown',\n                value: markups.map(markup => markup.value).join('\\n\\n')\n            };\n        }\n    }\n    is_token_empty(token) {\n        return token.string.length === 0;\n        // TODO  || token.type.length === 0? (sometimes the underline is shown on meaningless tokens)\n    }\n    is_event_inside_visible(event) {\n        let target = event.target;\n        return target.closest('.CodeMirror-sizer') != null;\n    }\n    is_useful_response(response) {\n        return (response &&\n            response.contents &&\n            !(Array.isArray(response.contents) && response.contents.length === 0));\n    }\n    /**\n     * Returns true if the tooltip should stay.\n     */\n    async _updateUnderlineAndTooltip(event) {\n        const target = event.target;\n        // if over an empty space in a line (and not over a token) then not worth checking\n        if (target.classList.contains('CodeMirror-line')) {\n            this.remove_range_highlight();\n            return false;\n        }\n        const show_tooltip = getModifierState(event, this.modifierKey);\n        // currently the events are coming from notebook panel; ideally these would be connected to individual cells,\n        // (only cells with code) instead, but this is more complex to implement right. In any case filtering\n        // is needed to determine in hovered character belongs to this virtual document\n        let root_position = this.position_from_mouse(event);\n        // happens because mousemove is attached to panel, not individual code cells,\n        // and because some regions of the editor (between lines) have no characters\n        if (root_position == null) {\n            this.remove_range_highlight();\n            return false;\n        }\n        let token = this.virtual_editor.getTokenAt(root_position);\n        let document = this.virtual_editor.document_at_root_position(root_position);\n        if (this.is_token_empty(token) ||\n            document !== this.virtual_document ||\n            !this.is_event_inside_visible(event)) {\n            this.remove_range_highlight();\n            return false;\n        }\n        if (!this.last_hover_character ||\n            !is_equal(root_position, this.last_hover_character)) {\n            let virtual_position = this.virtual_editor.root_position_to_virtual_position(root_position);\n            this.virtual_position = virtual_position;\n            this.last_hover_character = root_position;\n            // if we already sent a request, maybe it already covers the are of interest?\n            // not harm waiting as the server won't be able to help us anyways\n            if (this._previousHoverRequest) {\n                await Promise.race([\n                    this._previousHoverRequest,\n                    // just in case if the request stalled, set a timeout so we do not\n                    // get stuck indefinitely\n                    new Promise(resolve => {\n                        return setTimeout(resolve, 1000);\n                    })\n                ]);\n            }\n            let response_data = this.restore_from_cache(document, virtual_position);\n            if (response_data == null) {\n                const promise = this.debounced_get_hover.invoke();\n                this._previousHoverRequest = promise;\n                let response = await promise;\n                if (this._previousHoverRequest === promise) {\n                    this._previousHoverRequest = null;\n                }\n                if (response && this.is_useful_response(response)) {\n                    let ce_editor = this.virtual_editor.get_editor_at_root_position(root_position);\n                    let cm_editor = this.virtual_editor.ce_editor_to_cm_editor.get(ce_editor);\n                    let editor_range = this.get_editor_range(response, root_position, token, cm_editor);\n                    response_data = {\n                        response: this.add_range_if_needed(response, editor_range, ce_editor),\n                        document: document,\n                        editor_range: editor_range,\n                        ce_editor: ce_editor\n                    };\n                    this.cache.store(response_data);\n                }\n                else {\n                    this.remove_range_highlight();\n                    return false;\n                }\n            }\n            return this.handleResponse(response_data, root_position, show_tooltip);\n        }\n        else {\n            return true;\n        }\n    }\n    remove() {\n        this.cache.clean();\n        this.remove_range_highlight();\n        this.debounced_get_hover.dispose();\n        super.remove();\n    }\n    get_editor_range(response, position, token, cm_editor) {\n        if (typeof response.range !== 'undefined') {\n            return this.range_to_editor_range(response.range, cm_editor);\n        }\n        // construct the range manually using the token information\n        let start_in_root = {\n            line: position.line,\n            ch: token.start\n        };\n        let end_in_root = {\n            line: position.line,\n            ch: token.end\n        };\n        return {\n            start: this.virtual_editor.root_position_to_editor(start_in_root),\n            end: this.virtual_editor.root_position_to_editor(end_in_root),\n            editor: cm_editor\n        };\n    }\n    add_range_if_needed(response, editor_range, ce_editor) {\n        if (typeof response.range !== 'undefined') {\n            return response;\n        }\n        return Object.assign(Object.assign({}, response), { range: {\n                start: PositionConverter.cm_to_lsp(this.virtual_editor.root_position_to_virtual_position(this.virtual_editor.transform_from_editor_to_root(ce_editor, editor_range.start))),\n                end: PositionConverter.cm_to_lsp(this.virtual_editor.root_position_to_virtual_position(this.virtual_editor.transform_from_editor_to_root(ce_editor, editor_range.end)))\n            } });\n    }\n}\nclass HoverLabIntegration {\n    constructor(app, settings, renderMimeRegistry) {\n        this.tooltip = new EditorTooltipManager(renderMimeRegistry);\n    }\n}\nconst FEATURE_ID = PLUGIN_ID + ':hover';\nexport const HOVER_PLUGIN = {\n    id: FEATURE_ID,\n    requires: [ILSPFeatureManager, ISettingRegistry, IRenderMimeRegistry],\n    autoStart: true,\n    activate: (app, featureManager, settingRegistry, renderMimeRegistry) => {\n        const settings = new FeatureSettings(settingRegistry, FEATURE_ID);\n        const labIntegration = new HoverLabIntegration(app, settings, renderMimeRegistry);\n        featureManager.register({\n            feature: {\n                editorIntegrationFactory: new Map([['CodeMirrorEditor', HoverCM]]),\n                id: FEATURE_ID,\n                name: 'LSP Hover tooltip',\n                labIntegration: labIntegration,\n                settings: settings,\n                capabilities: {\n                    textDocument: {\n                        hover: {\n                            dynamicRegistration: true,\n                            contentFormat: ['markdown', 'plaintext']\n                        }\n                    }\n                }\n            }\n        });\n    }\n};\n//# sourceMappingURL=hover.js.map","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n    <path d=\\\"M17 7h5v10h-5v2a1 1 0 001 1h2v2h-2.5c-.55 0-1.5-.45-1.5-1 0 .55-.95 1-1.5 1H12v-2h2a1 1 0 001-1V5a1 1 0 00-1-1h-2V2h2.5c.55 0 1.5.45 1.5 1 0-.55.95-1 1.5-1H20v2h-2a1 1 0 00-1 1v2M2 7h11v2H4v6h9v2H2V7m18 8V9h-3v6h3z\\\"/>\\n  </g>\\n</svg>\\n\";","import { InputDialog } from '@jupyterlab/apputils';\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { ITranslator, nullTranslator } from '@jupyterlab/translation';\nimport { LabIcon } from '@jupyterlab/ui-components';\nimport renameSvg from '../../style/icons/rename.svg';\nimport { CodeMirrorIntegration } from '../editor_integration/codemirror';\nimport { FeatureSettings } from '../feature';\nimport { ILSPFeatureManager, PLUGIN_ID } from '../tokens';\nimport { FEATURE_ID as DIAGNOSTICS_PLUGIN_ID } from './diagnostics';\nexport const renameIcon = new LabIcon({\n    name: 'lsp:rename',\n    svgstr: renameSvg\n});\nconst FEATURE_ID = PLUGIN_ID + ':rename';\nconst COMMANDS = (trans) => [\n    {\n        id: 'rename-symbol',\n        execute: async ({ editor, connection, virtual_position, document, features }) => {\n            const rename_feature = features.get(FEATURE_ID);\n            rename_feature.setTrans(trans);\n            let root_position = rename_feature.transform_virtual_position_to_root_position(virtual_position);\n            let old_value = editor.get_token_at(root_position).value;\n            let handle_failure = (error) => {\n                let status = '';\n                if (features.has(DIAGNOSTICS_PLUGIN_ID)) {\n                    let diagnostics_feature = features.get(DIAGNOSTICS_PLUGIN_ID);\n                    status = RenameCM.ux_workaround_for_rope_limitation(error, diagnostics_feature, editor, rename_feature);\n                }\n                if (!status) {\n                    status = trans.__(`Rename failed: %1`, error);\n                }\n                rename_feature.setStatus(status, 7.5 * 1000);\n            };\n            const dialog_value = await InputDialog.getText({\n                title: trans.__('Rename to'),\n                text: old_value,\n                okLabel: trans.__('Rename'),\n                cancelLabel: trans.__('Cancel')\n            });\n            try {\n                const new_value = dialog_value.value;\n                if (dialog_value.button.accept != true || new_value == null) {\n                    // the user has cancelled the rename action or did not provide new value\n                    return;\n                }\n                rename_feature.setStatus(trans.__('Renaming %1 to %2...', old_value, new_value), 2 * 1000);\n                const edit = await (connection === null || connection === void 0 ? void 0 : connection.rename(virtual_position, document.document_info, new_value, false));\n                if (edit) {\n                    await rename_feature.handleRename(edit, old_value, new_value);\n                }\n                else {\n                    handle_failure(new Error('no edit from server'));\n                }\n            }\n            catch (error) {\n                handle_failure(error);\n            }\n        },\n        is_enabled: ({ connection }) => connection ? connection.provides('renameProvider') : false,\n        label: trans.__('Rename symbol'),\n        icon: renameIcon\n    }\n];\nexport class RenameCM extends CodeMirrorIntegration {\n    setTrans(trans) {\n        this.trans = trans;\n    }\n    setStatus(message, timeout) {\n        return this.status_message.set(message, timeout);\n    }\n    async handleRename(workspaceEdit, old_value, new_value) {\n        let outcome;\n        try {\n            outcome = await this.apply_edit(workspaceEdit);\n        }\n        catch (error) {\n            this.status_message.set(this.trans.__('Rename failed: %1', error));\n            return;\n        }\n        try {\n            let status;\n            const change_text = this.trans.__('%1 to %2', old_value, new_value);\n            if (outcome.appliedChanges === 0) {\n                status = this.trans.__('Could not rename %1 - consult the language server documentation', change_text);\n            }\n            else if (outcome.wasGranular) {\n                status = this.trans._n('Renamed %2 in %3 place', 'Renamed %2 in %3 places', outcome.appliedChanges, change_text, outcome.appliedChanges);\n            }\n            else if (this.adapter.has_multiple_editors) {\n                status = this.trans._n('Renamed %2 in %3 cell', 'Renamed %2 in %3 cells', outcome.modifiedCells, change_text, outcome.modifiedCells);\n            }\n            else {\n                status = this.trans.__('Renamed %1', change_text);\n            }\n            if (outcome.errors.length !== 0) {\n                status += this.trans.__(' with errors: %1', outcome.errors);\n            }\n            this.status_message.set(status, 5 * 1000);\n        }\n        catch (error) {\n            this.console.warn(error);\n        }\n        return outcome;\n    }\n    /**\n     * In #115 an issue with rename for Python (when using pyls) was identified:\n     * rename was failing with an obscure message when the source code could\n     * not be parsed correctly by rope (due to a user's syntax error).\n     *\n     * This function detects such a condition using diagnostics feature\n     * and provides a nice error message to the user.\n     */\n    static ux_workaround_for_rope_limitation(error, diagnostics_feature, editor, rename_feature) {\n        let has_index_error = false;\n        try {\n            has_index_error = error.message.includes('IndexError');\n        }\n        catch (e) {\n            return null;\n        }\n        if (!has_index_error) {\n            return null;\n        }\n        let dire_python_errors = (diagnostics_feature.diagnostics_db.all || []).filter(diagnostic => diagnostic.diagnostic.message.includes('invalid syntax') ||\n            diagnostic.diagnostic.message.includes('SyntaxError') ||\n            diagnostic.diagnostic.message.includes('IndentationError'));\n        if (dire_python_errors.length === 0) {\n            return null;\n        }\n        let dire_errors = [\n            ...new Set(dire_python_errors.map(diagnostic => {\n                let message = diagnostic.diagnostic.message;\n                let start = diagnostic.range.start;\n                if (rename_feature.adapter.has_multiple_editors) {\n                    let { index: editor_id } = editor.find_editor(diagnostic.editor);\n                    let cell_number = editor_id + 1;\n                    // TODO: should we show \"code cell\" numbers, or just cell number?\n                    return rename_feature.trans.__('%1 in cell %2 at line %3', message, cell_number, start.line);\n                }\n                else {\n                    return rename_feature.trans.__('%1 at line %2', message, start.line);\n                }\n            }))\n        ].join(', ');\n        return rename_feature.trans.__('Syntax error(s) prevent rename: %1', dire_errors);\n    }\n}\nexport const RENAME_PLUGIN = {\n    id: FEATURE_ID,\n    requires: [ILSPFeatureManager, ISettingRegistry, ITranslator],\n    autoStart: true,\n    activate: (app, featureManager, settingRegistry, translator) => {\n        const trans = (translator || nullTranslator).load('jupyterlab_lsp');\n        const settings = new FeatureSettings(settingRegistry, FEATURE_ID);\n        featureManager.register({\n            feature: {\n                editorIntegrationFactory: new Map([['CodeMirrorEditor', RenameCM]]),\n                id: FEATURE_ID,\n                name: 'LSP Rename',\n                settings: settings,\n                commands: COMMANDS(trans)\n            }\n        });\n    }\n};\n//# sourceMappingURL=rename.js.map","import { ICodeMirror } from '@jupyterlab/codemirror';\nimport { IRenderMimeRegistry } from '@jupyterlab/rendermime';\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { EditorTooltipManager } from '../components/free_tooltip';\nimport { CodeMirrorIntegration } from '../editor_integration/codemirror';\nimport { FeatureSettings } from '../feature';\nimport { ILSPFeatureManager, PLUGIN_ID } from '../tokens';\nimport { escapeMarkdown } from '../utils';\nconst TOOLTIP_ID = 'signature';\nconst CLASS_NAME = 'lsp-signature-help';\nfunction getMarkdown(item) {\n    if (typeof item === 'string') {\n        return escapeMarkdown(item);\n    }\n    else {\n        if (item.kind === 'markdown') {\n            return item.value;\n        }\n        else {\n            return escapeMarkdown(item.value);\n        }\n    }\n}\nexport function extractLead(lines, size) {\n    // try to split after paragraph\n    const leadLines = [];\n    let splitOnParagraph = false;\n    for (const line of lines.slice(0, size + 1)) {\n        const isEmpty = line.trim() == '';\n        if (isEmpty) {\n            splitOnParagraph = true;\n            break;\n        }\n        leadLines.push(line);\n    }\n    // see if we got something which does not include Markdown formatting\n    // (so it won't lead to broken formatting if we split after it);\n    const leadCandidate = leadLines.join('\\n');\n    if (splitOnParagraph && leadCandidate.search(/[\\\\*#[\\]<>_]/g) === -1) {\n        return {\n            lead: leadCandidate,\n            remainder: lines.slice(leadLines.length + 1).join('\\n')\n        };\n    }\n    return null;\n}\n/**\n * Represent signature as a Markdown element.\n */\nexport function signatureToMarkdown(item, language = '', codeHighlighter, logger, activeParameterFallback, maxLinesBeforeCollapse = 4) {\n    const activeParameter = typeof item.activeParameter !== 'undefined'\n        ? item.activeParameter\n        : activeParameterFallback;\n    let markdown;\n    let label = item.label;\n    if (item.parameters && activeParameter != null) {\n        if (activeParameter > item.parameters.length) {\n            logger.error('LSP server returned wrong number for activeSignature for: ', item);\n            markdown = '```' + language + '\\n' + label + '\\n```';\n        }\n        else {\n            const parameter = item.parameters[activeParameter];\n            let substring = typeof parameter.label === 'string'\n                ? parameter.label\n                : label.slice(parameter.label[0], parameter.label[1]);\n            markdown = codeHighlighter(label, substring, language);\n        }\n    }\n    else {\n        markdown = '```' + language + '\\n' + label + '\\n```';\n    }\n    let details = '';\n    if (item.documentation) {\n        if (typeof item.documentation === 'string' ||\n            item.documentation.kind === 'plaintext') {\n            const plainTextDocumentation = typeof item.documentation === 'string'\n                ? item.documentation\n                : item.documentation.value;\n            // TODO: make use of the MarkupContent object instead\n            for (let line of plainTextDocumentation.split('\\n')) {\n                if (line.trim() === item.label.trim()) {\n                    continue;\n                }\n                details += getMarkdown(line) + '\\n';\n            }\n        }\n        else {\n            if (item.documentation.kind !== 'markdown') {\n                logger.warn('Unknown MarkupContent kind:', item.documentation.kind);\n            }\n            details += item.documentation.value;\n        }\n    }\n    else if (item.parameters) {\n        details +=\n            '\\n\\n' +\n                item.parameters\n                    .filter(parameter => parameter.documentation)\n                    .map(parameter => '- ' + getMarkdown(parameter.documentation))\n                    .join('\\n');\n    }\n    if (details) {\n        const lines = details.trim().split('\\n');\n        if (lines.length > maxLinesBeforeCollapse) {\n            const split = extractLead(lines, maxLinesBeforeCollapse);\n            if (split) {\n                details =\n                    split.lead + '\\n<details>\\n' + split.remainder + '\\n</details>';\n            }\n            else {\n                details = '<details>\\n' + details + '\\n</details>';\n            }\n        }\n        markdown += '\\n\\n' + details;\n    }\n    else {\n        markdown += '\\n';\n    }\n    return markdown;\n}\nexport class SignatureCM extends CodeMirrorIntegration {\n    get settings() {\n        return super.settings;\n    }\n    get _closeCharacters() {\n        if (!this.settings) {\n            return [];\n        }\n        return this.settings.composite.closeCharacters;\n    }\n    register() {\n        this.editor_handlers.set('cursorActivity', this.onCursorActivity.bind(this));\n        this.editor_handlers.set('blur', this.onBlur.bind(this));\n        this.editor_handlers.set('focus', this.onCursorActivity.bind(this));\n        super.register();\n    }\n    onBlur(virtualEditor, event) {\n        // hide unless the focus moved to the signature itself\n        // (allowing user to select/copy from signature)\n        if (this.isSignatureShown() &&\n            event.relatedTarget.closest('.' + CLASS_NAME) === null) {\n            this._hideTooltip();\n        }\n    }\n    onCursorActivity() {\n        var _a;\n        if (!this.isSignatureShown()) {\n            return;\n        }\n        const newRootPosition = this.virtual_editor.get_cursor_position();\n        const previousPosition = this.lab_integration.tooltip.position;\n        let newEditorPosition = this.virtual_editor.root_position_to_editor(newRootPosition);\n        // hide tooltip if exceeded position\n        if (newEditorPosition.line === previousPosition.line &&\n            newEditorPosition.ch < previousPosition.ch) {\n            this._hideTooltip();\n        }\n        else {\n            // otherwise, update the signature as the active parameter could have changed,\n            // or the server may want us to close the tooltip\n            (_a = this.requestSignature(newRootPosition, previousPosition)) === null || _a === void 0 ? void 0 : _a.catch(this.console.warn);\n        }\n    }\n    get lab_integration() {\n        return super.lab_integration;\n    }\n    get_markup_for_signature_help(response, language = '') {\n        let signatures = new Array();\n        if (response.activeSignature != null) {\n            if (response.activeSignature >= response.signatures.length) {\n                this.console.error('LSP server returned wrong number for activeSignature for: ', response);\n            }\n            else {\n                const item = response.signatures[response.activeSignature];\n                return {\n                    kind: 'markdown',\n                    value: this.signatureToMarkdown(item, language, response.activeParameter)\n                };\n            }\n        }\n        response.signatures.forEach(item => {\n            let markdown = this.signatureToMarkdown(item, language);\n            signatures.push(markdown);\n        });\n        return {\n            kind: 'markdown',\n            value: signatures.join('\\n\\n')\n        };\n    }\n    highlightCode(source, variable, language) {\n        const pre = document.createElement('pre');\n        const code = document.createElement('code');\n        pre.appendChild(code);\n        code.className = `cm-s-jupyter language-${language}`;\n        this.lab_integration.codeMirror.CodeMirror.runMode(source, language, (token, className) => {\n            let element;\n            if (className) {\n                element = document.createElement('span');\n                element.classList.add('cm-' + className);\n                element.textContent = token;\n            }\n            else {\n                element = document.createTextNode(token);\n            }\n            if (className === 'variable' && token === variable) {\n                const mark = document.createElement('mark');\n                mark.appendChild(element);\n                element = mark;\n            }\n            code.appendChild(element);\n        });\n        return pre.outerHTML;\n    }\n    /**\n     * Represent signature as a Markdown element.\n     */\n    signatureToMarkdown(item, language, activeParameterFallback) {\n        return signatureToMarkdown(item, language, this.highlightCode.bind(this), this.console, activeParameterFallback, this.settings.composite.maxLines);\n    }\n    _hideTooltip() {\n        this.lab_integration.tooltip.remove();\n    }\n    handleSignature(response, position_at_request, display_position = null) {\n        this.console.log('Signature received', response);\n        if (response || response === null) {\n            // do not hide on undefined as it simply indicates that no new info is available\n            // (null means close, response means update)\n            this._hideTooltip();\n        }\n        if (!this.signatureCharacter || !response || !response.signatures.length) {\n            this.console.debug('Ignoring signature response: cursor lost or response empty');\n            return;\n        }\n        let root_position = this.virtual_editor.get_cursor_position();\n        // if the cursor advanced in the same line, the previously retrieved signature may still be useful\n        // if the line changed or cursor moved backwards then no reason to keep the suggestions\n        if (position_at_request.line != root_position.line ||\n            root_position.ch < position_at_request.ch) {\n            this.console.debug('Ignoring signature response: cursor has receded or changed line');\n        }\n        let cm_editor = this.get_cm_editor(root_position);\n        if (!cm_editor.hasFocus()) {\n            this.console.debug('Ignoring signature response: the corresponding editor lost focus');\n            return;\n        }\n        let editor_position = this.virtual_editor.root_position_to_editor(root_position);\n        let language = this.get_language_at(editor_position, cm_editor);\n        let markup = this.get_markup_for_signature_help(response, language);\n        this.console.log('Signature will be shown', language, markup, root_position, response);\n        this.lab_integration.tooltip.create({\n            markup,\n            position: display_position === null ? editor_position : display_position,\n            id: TOOLTIP_ID,\n            ce_editor: this.virtual_editor.find_ce_editor(cm_editor),\n            adapter: this.adapter,\n            className: CLASS_NAME,\n            tooltip: {\n                privilege: 'forceAbove',\n                alignment: 'start',\n                hideOnKeyPress: false\n            }\n        });\n    }\n    get signatureCharacters() {\n        var _a;\n        if (!((_a = this._signatureCharacters) === null || _a === void 0 ? void 0 : _a.length)) {\n            this._signatureCharacters =\n                this.connection.getLanguageSignatureCharacters();\n        }\n        return this._signatureCharacters;\n    }\n    isSignatureShown() {\n        return this.lab_integration.tooltip.isShown(TOOLTIP_ID);\n    }\n    afterChange(change, root_position) {\n        var _a;\n        let last_character = this.extract_last_character(change);\n        const isSignatureShown = this.isSignatureShown();\n        let previousPosition = null;\n        if (isSignatureShown) {\n            previousPosition = this.lab_integration.tooltip.position;\n            if (this._closeCharacters.includes(last_character)) {\n                // remove just in case but do not short-circuit in case if we need to re-trigger\n                this._hideTooltip();\n            }\n        }\n        // only proceed if: trigger character was used or the signature is/was visible immediately before\n        if (!(this.signatureCharacters.includes(last_character) || isSignatureShown)) {\n            return;\n        }\n        (_a = this.requestSignature(root_position, previousPosition)) === null || _a === void 0 ? void 0 : _a.catch(this.console.warn);\n    }\n    requestSignature(root_position, previousPosition) {\n        var _a;\n        if (!(this.connection.isReady && ((_a = this.connection.serverCapabilities) === null || _a === void 0 ? void 0 : _a.signatureHelpProvider))) {\n            return;\n        }\n        this.signatureCharacter = root_position;\n        let virtual_position = this.virtual_editor.root_position_to_virtual_position(root_position);\n        return this.connection.clientRequests['textDocument/signatureHelp']\n            .request({\n            position: {\n                line: virtual_position.line,\n                character: virtual_position.ch\n            },\n            textDocument: {\n                uri: this.virtual_document.document_info.uri\n            }\n        })\n            .then(help => this.handleSignature(help, root_position, previousPosition));\n    }\n}\nclass SignatureLabIntegration {\n    constructor(app, settings, renderMimeRegistry, codeMirror) {\n        this.codeMirror = codeMirror;\n        this.tooltip = new EditorTooltipManager(renderMimeRegistry);\n    }\n}\nconst FEATURE_ID = PLUGIN_ID + ':signature';\nexport const SIGNATURE_PLUGIN = {\n    id: FEATURE_ID,\n    requires: [\n        ILSPFeatureManager,\n        ISettingRegistry,\n        IRenderMimeRegistry,\n        ICodeMirror\n    ],\n    autoStart: true,\n    activate: (app, featureManager, settingRegistry, renderMimeRegistry, codeMirror) => {\n        const settings = new FeatureSettings(settingRegistry, FEATURE_ID);\n        const labIntegration = new SignatureLabIntegration(app, settings, renderMimeRegistry, codeMirror);\n        featureManager.register({\n            feature: {\n                editorIntegrationFactory: new Map([['CodeMirrorEditor', SignatureCM]]),\n                id: FEATURE_ID,\n                name: 'LSP Function signature',\n                labIntegration: labIntegration,\n                settings: settings,\n                capabilities: {\n                    textDocument: {\n                        signatureHelp: {\n                            dynamicRegistration: true,\n                            signatureInformation: {\n                                documentationFormat: ['markdown', 'plaintext']\n                            }\n                        }\n                    }\n                }\n            }\n        });\n    }\n};\n//# sourceMappingURL=signature.js.map","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" viewBox=\\\"0 0 24 24\\\">\\n  <g class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" shape-rendering=\\\"geometricPrecision\\\">\\n    <path d=\\\"M10.48 10.88l3.68-3.68-3.68-3.68L11.6 2.4l4.8 4.8-4.8 4.8-1.12-1.12m-4.16 0L2.64 7.2l3.68-3.68L5.2 2.4.4 7.2 5.2 12l1.12-1.12zM8.5 23.8l2.337-2.338-.025-.017a1.283 1.283 0 010-1.802l4.029-4.029 3.604 3.604-4.029 4.03a1.267 1.267 0 01-1.776.017l-.536.535H8.5m10.124-11.976a1.283 1.283 0 011.802 0l1.81 1.802a1.293 1.293 0 010 1.81l-2.805 2.796-3.604-3.604 2.797-2.805z\\\"/>\\n  </g>\\n</svg>\\n\";","import { IEditorServices } from '@jupyterlab/codeeditor';\nimport { ICodeMirror } from '@jupyterlab/codemirror';\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { ITranslator } from '@jupyterlab/translation';\nimport { LabIcon } from '@jupyterlab/ui-components';\nimport syntaxSvg from '../../style/icons/syntax-highlight.svg';\nimport { CodeMirrorIntegration } from '../editor_integration/codemirror';\nimport { FeatureSettings } from '../feature';\nimport { ILSPFeatureManager, PLUGIN_ID } from '../tokens';\nexport const syntaxHighlightingIcon = new LabIcon({\n    name: 'lsp:syntax-highlighting',\n    svgstr: syntaxSvg\n});\nconst FEATURE_ID = PLUGIN_ID + ':syntax_highlighting';\nexport class CMSyntaxHighlighting extends CodeMirrorIntegration {\n    constructor(options) {\n        super(options);\n        this.virtual_document.changed.connect(this.update_mode.bind(this), this);\n        this.editors_with_active_highlight = new Set();\n    }\n    get lab_integration() {\n        return super.lab_integration;\n    }\n    get settings() {\n        return super.settings;\n    }\n    get_mode(language) {\n        let mimetype = this.lab_integration.mimeTypeService.getMimeTypeByLanguage({\n            name: language\n        });\n        if (!mimetype || mimetype == 'text/plain') {\n            // if a mimetype cannot be found it will be 'text/plain', therefore do\n            // not change mode to text/plain, as this could be a step backwards for\n            // the user experience\n            return;\n        }\n        return this.lab_integration.codeMirror.CodeMirror.findModeByMIME(mimetype);\n    }\n    update_mode() {\n        let root = this.virtual_document;\n        let editors_with_current_highlight = new Set();\n        for (let map of root.foreign_document_maps) {\n            for (let [range, block] of map.entries()) {\n                let ce_editor = block.editor;\n                let editor = ce_editor.editor;\n                let lines = editor.getValue('\\n');\n                let total_area = lines.concat('').length;\n                let covered_area = ce_editor.getOffsetAt(range.end) - ce_editor.getOffsetAt(range.start);\n                let coverage = covered_area / total_area;\n                let language = block.virtual_document.language;\n                let mode = this.get_mode(language);\n                // if not highlighting mode available, skip this editor\n                if (typeof mode === 'undefined') {\n                    continue;\n                }\n                // change the mode if the majority of the code is the foreign code\n                if (coverage > this.settings.composite.foreignCodeThreshold) {\n                    editors_with_current_highlight.add(ce_editor);\n                    let old_mode = editor.getOption('mode');\n                    if (old_mode != mode.mime) {\n                        editor.setOption('mode', mode.mime);\n                    }\n                }\n            }\n        }\n        if (editors_with_current_highlight != this.editors_with_active_highlight) {\n            for (let ce_editor of this.editors_with_active_highlight) {\n                if (!editors_with_current_highlight.has(ce_editor)) {\n                    ce_editor.editor.setOption('mode', ce_editor.model.mimeType);\n                }\n            }\n        }\n        this.editors_with_active_highlight = editors_with_current_highlight;\n    }\n}\nclass SyntaxLabIntegration {\n    constructor(mimeTypeService, codeMirror) {\n        this.mimeTypeService = mimeTypeService;\n        this.codeMirror = codeMirror;\n    }\n}\nexport const SYNTAX_HIGHLIGHTING_PLUGIN = {\n    id: FEATURE_ID,\n    requires: [\n        ILSPFeatureManager,\n        IEditorServices,\n        ISettingRegistry,\n        ICodeMirror,\n        ITranslator\n    ],\n    autoStart: true,\n    activate: (app, featureManager, editorServices, settingRegistry, codeMirror, translator) => {\n        const settings = new FeatureSettings(settingRegistry, FEATURE_ID);\n        const trans = translator.load('jupyterlab_lsp');\n        featureManager.register({\n            feature: {\n                editorIntegrationFactory: new Map([\n                    ['CodeMirrorEditor', CMSyntaxHighlighting]\n                ]),\n                commands: [],\n                id: FEATURE_ID,\n                name: trans.__('Syntax highlighting'),\n                labIntegration: new SyntaxLabIntegration(editorServices.mimeTypeService, codeMirror),\n                settings: settings\n            }\n        });\n    }\n};\n//# sourceMappingURL=syntax_highlighting.js.map","import { PageConfig, URLExt } from '@jupyterlab/coreutils';\nimport { ServerConnection } from '@jupyterlab/services';\nimport { Signal } from '@lumino/signaling';\nimport { ILanguageServerManager } from './tokens';\nexport class LanguageServerManager {\n    constructor(options) {\n        this._sessionsChanged = new Signal(this);\n        this._sessions = new Map();\n        this._specs = new Map();\n        this._warningsEmitted = new Set();\n        this._settings = options.settings || ServerConnection.makeSettings();\n        this._baseUrl = options.baseUrl || PageConfig.getBaseUrl();\n        this._retries = options.retries || 2;\n        this._retriesInterval = options.retriesInterval || 10000;\n        this._statusCode = -1;\n        this._configuration = {};\n        this.console = options.console;\n        this.fetchSessions().catch(console.warn);\n    }\n    get specs() {\n        return this._specs;\n    }\n    get statusUrl() {\n        return URLExt.join(this._baseUrl, ILanguageServerManager.URL_NS, 'status');\n    }\n    get sessionsChanged() {\n        return this._sessionsChanged;\n    }\n    get sessions() {\n        return this._sessions;\n    }\n    setConfiguration(configuration) {\n        this._configuration = configuration;\n    }\n    warnOnce(arg) {\n        if (!this._warningsEmitted.has(arg)) {\n            this._warningsEmitted.add(arg);\n            this.console.warn(arg);\n        }\n    }\n    _comparePriorities(a, b) {\n        var _a, _b, _c, _d;\n        const DEFAULT_PRIORITY = 50;\n        const a_priority = (_b = (_a = this._configuration[a]) === null || _a === void 0 ? void 0 : _a.priority) !== null && _b !== void 0 ? _b : DEFAULT_PRIORITY;\n        const b_priority = (_d = (_c = this._configuration[b]) === null || _c === void 0 ? void 0 : _c.priority) !== null && _d !== void 0 ? _d : DEFAULT_PRIORITY;\n        if (a_priority == b_priority) {\n            this.warnOnce(`Two matching servers: ${a} and ${b} have the same priority; choose which one to use by changing the priority in Advanced Settings Editor`);\n            return a.localeCompare(b);\n        }\n        // higher priority = higher in the list (descending order)\n        return b_priority - a_priority;\n    }\n    isMatchingSpec(options, spec) {\n        // most things speak language\n        // if language is not known, it is guessed based on MIME type earlier\n        // so some language should be available by now (which can be not so obvious, e.g. \"plain\" for txt documents)\n        const lowerCaseLanguage = options.language.toLocaleLowerCase();\n        return spec.languages.some(language => language.toLocaleLowerCase() == lowerCaseLanguage);\n    }\n    getMatchingServers(options) {\n        if (!options.language) {\n            this.console.error('Cannot match server by language: language not available; ensure that kernel and specs provide language and MIME type');\n            return [];\n        }\n        const matchingSessionsKeys = [];\n        for (const [key, session] of this._sessions.entries()) {\n            if (this.isMatchingSpec(options, session.spec)) {\n                matchingSessionsKeys.push(key);\n            }\n        }\n        return matchingSessionsKeys.sort(this._comparePriorities.bind(this));\n    }\n    getMatchingSpecs(options) {\n        const result = new Map();\n        for (const [key, specification] of this._specs.entries()) {\n            if (this.isMatchingSpec(options, specification)) {\n                result.set(key, specification);\n            }\n        }\n        return result;\n    }\n    get statusCode() {\n        return this._statusCode;\n    }\n    async fetchSessions() {\n        let response = await ServerConnection.makeRequest(this.statusUrl, { method: 'GET' }, this._settings);\n        this._statusCode = response.status;\n        if (!response.ok) {\n            console.error('Could not fetch sessions', response);\n            if (this._retries > 0) {\n                this._retries -= 1;\n                setTimeout(this.fetchSessions.bind(this), this._retriesInterval);\n            }\n            return;\n        }\n        let sessions;\n        try {\n            const data = await response.json();\n            sessions = data.sessions;\n            try {\n                this._version = data.version;\n                this._specs = new Map(Object.entries(data.specs));\n            }\n            catch (err) {\n                console.warn(err);\n            }\n        }\n        catch (err) {\n            console.warn(err);\n            return;\n        }\n        for (let key of Object.keys(sessions)) {\n            let id = key;\n            if (this._sessions.has(id)) {\n                Object.assign(this._sessions.get(id), sessions[key]);\n            }\n            else {\n                this._sessions.set(id, sessions[key]);\n            }\n        }\n        const oldKeys = this._sessions.keys();\n        for (const oldKey in oldKeys) {\n            if (!sessions[oldKey]) {\n                let oldId = oldKey;\n                this._sessions.delete(oldId);\n            }\n        }\n        this._sessionsChanged.emit(void 0);\n    }\n}\n//# sourceMappingURL=manager.js.map","import { ILSPCodeOverridesManager } from './tokens';\nclass CodeOverridesManager {\n    constructor() {\n        this._overrides = {};\n    }\n    get registry() {\n        return this._overrides;\n    }\n    register(override, language) {\n        if (!(language in this._overrides)) {\n            this._overrides[language] = { cell: [], line: [] };\n        }\n        let overrides = this._overrides[language];\n        switch (override.scope) {\n            case 'cell':\n                overrides.cell.push(override);\n                break;\n            case 'line':\n                overrides.line.push(override);\n                break;\n        }\n    }\n}\nexport const CODE_OVERRIDES_MANAGER = {\n    id: ILSPCodeOverridesManager.name,\n    requires: [],\n    activate: app => {\n        return new CodeOverridesManager();\n    },\n    provides: ILSPCodeOverridesManager,\n    autoStart: true\n};\n//# sourceMappingURL=index.js.map","import { RegExpForeignCodeExtractor } from '../../extractors/regexp';\nexport let foreign_code_extractors = {\n    // general note: to match new lines use [^] instead of dot, unless the target is ES2018, then use /s\n    python: [\n        //\n        // Standalone IPython magics\n        // (script magics are standalone, i.e. consecutive code cells with the same magic create two different namespaces)\n        //\n        new RegExpForeignCodeExtractor({\n            language: 'python',\n            pattern: '^%%(python|python2|python3|pypy)( .*?)?\\n([^]*)',\n            foreign_capture_groups: [3],\n            is_standalone: true,\n            file_extension: 'py'\n        }),\n        new RegExpForeignCodeExtractor({\n            language: 'perl',\n            pattern: '^%%(perl)( .*?)?\\n([^]*)',\n            foreign_capture_groups: [3],\n            is_standalone: true,\n            file_extension: 'pl'\n        }),\n        new RegExpForeignCodeExtractor({\n            language: 'ruby',\n            pattern: '^%%(ruby)( .*?)?\\n([^]*)',\n            foreign_capture_groups: [3],\n            is_standalone: true,\n            file_extension: 'rb'\n        }),\n        new RegExpForeignCodeExtractor({\n            language: 'sh',\n            pattern: '^%%(sh|bash)( .*?)?\\n([^]*)',\n            foreign_capture_groups: [3],\n            is_standalone: true,\n            file_extension: 'sh'\n        }),\n        new RegExpForeignCodeExtractor({\n            language: 'html',\n            pattern: '^%%(html --isolated)( .*?)?\\n([^]*)',\n            foreign_capture_groups: [3],\n            is_standalone: true,\n            file_extension: 'html'\n        }),\n        //\n        // IPython magics producing continuous documents (non-standalone):\n        //\n        new RegExpForeignCodeExtractor({\n            language: 'javascript',\n            pattern: '^%%(js|javascript)( .*?)?\\n([^]*)',\n            foreign_capture_groups: [3],\n            is_standalone: false,\n            file_extension: 'js'\n        }),\n        new RegExpForeignCodeExtractor({\n            language: 'html',\n            pattern: '^%%(?!html --isolated)(html)( .*?)?\\n([^]*)',\n            foreign_capture_groups: [3],\n            is_standalone: false,\n            file_extension: 'html'\n        }),\n        new RegExpForeignCodeExtractor({\n            language: 'latex',\n            pattern: '^%%(latex)( .*?)?\\n([^]*)',\n            foreign_capture_groups: [3],\n            is_standalone: false,\n            file_extension: 'tex'\n        }),\n        new RegExpForeignCodeExtractor({\n            language: 'markdown',\n            pattern: '^%%(markdown)( .*?)?\\n([^]*)',\n            foreign_capture_groups: [3],\n            is_standalone: false,\n            file_extension: 'md'\n        })\n    ]\n};\n//# sourceMappingURL=extractors.js.map","function escape(x) {\n    return x.replace(/([\"\\\\])/g, '\\\\$1');\n}\nfunction unescape(x) {\n    return x.replace(/\\\\([\\\\\"])/g, '$1');\n}\nfunction empty_or_escaped(x) {\n    if (!x) {\n        return '';\n    }\n    else {\n        return escape(x);\n    }\n}\n/**\n * Line magics do not have to start with the new line, for example:\n *    x = !ls\n *    x = %ls\n *    x =%ls\n * are all valid.\n *\n * The percent may also appear in strings, e.g. ls('%').\n *\n * IPython allows magics on start of a line or in assignments (but only there!), thus:\n *    x = (!ls)\n * is invalid syntax!\n *\n * Therefore we can require that the match starts with either:\n * - zero or more whitespaces right after the beginning of a line, or\n * - variable then equals (with optional whitespaces)\n *\n * This will not always work: e.g.:\n *    x['a = !ls'] = !ls\n * is perfectly valid IPython, but regular expressions cannot help here.\n *\n * Look behind could be used to avoid capturing the group,\n * but at the time of writing support is only at 77%.\n */\nexport const LINE_MAGIC_PREFIX = '^(\\\\s*|\\\\s*\\\\S+\\\\s*=\\\\s*)';\nexport const PYTHON_IDENTIFIER = '([^?\\\\s\\'\"\\\\(\\\\)-\\\\+\\\\/#]+)';\nexport let overrides = [\n    /**\n     * Line magics\n     */\n    // filter out IPython line magics and shell assignments:\n    //  keep the content, keep magic/command name and new line at the end\n    {\n        pattern: LINE_MAGIC_PREFIX + '!([^=\\\\s]+)(.*)(\\n)?',\n        replacement: '$1get_ipython().getoutput(\"$2$3\")$4',\n        scope: 'line',\n        reverse: {\n            pattern: 'get_ipython\\\\(\\\\).getoutput\\\\(\"(.*?)\"\\\\)(\\n)?',\n            replacement: '!$1$2',\n            scope: 'line'\n        }\n    },\n    {\n        // note: assignments of pinfo/pinfo2 are not supported by IPython\n        // and only \"simple\" identifiers are supported, i.e.\n        //    ?x['a']\n        // would not be solved, leading to \"Object `x['a']` not found.\"\n        pattern: '^(\\\\s*)' + '(\\\\?{1,2})' + PYTHON_IDENTIFIER + '(\\n)?$',\n        replacement: (match, prefix, marks, name, line_break) => {\n            const cmd = marks == '?' ? 'pinfo' : 'pinfo2';\n            line_break = line_break || '';\n            // trick: use single quotes to distinguish\n            return `${prefix}get_ipython().run_line_magic(\\'${cmd}\\', \\'${name}\\')${line_break}`;\n        },\n        scope: 'line',\n        reverse: {\n            pattern: \"get_ipython\\\\(\\\\).run_line_magic\\\\('(pinfo2?)', '(.*?)'\\\\)(\\n)?\",\n            replacement: (match, cmd, name) => {\n                const marks = cmd == 'pinfo' ? '?' : '??';\n                return `${marks}${name}`;\n            },\n            scope: 'line'\n        }\n    },\n    {\n        pattern: '^(\\\\s*)' + PYTHON_IDENTIFIER + '(\\\\?{1,2})(\\n)?',\n        replacement: (match, prefix, name, marks, line_break) => {\n            const cmd = marks == '?' ? 'pinfo' : 'pinfo2';\n            line_break = line_break || '';\n            // trick: use two spaces to distinguish pinfo using suffix (int?) from the one using prefix (?int)\n            return `${prefix}get_ipython().run_line_magic(\\'${cmd}\\',  \\'${name}\\')${line_break}`;\n        },\n        scope: 'line',\n        reverse: {\n            pattern: \"get_ipython\\\\(\\\\).run_line_magic\\\\('(pinfo2?)',  '(.*?)'\\\\)(\\n)?\",\n            replacement: (match, cmd, name) => {\n                const marks = cmd == 'pinfo' ? '?' : '??';\n                return `${name}${marks}`;\n            },\n            scope: 'line'\n        }\n    },\n    {\n        pattern: LINE_MAGIC_PREFIX + '%(\\\\S+)(.*)(\\n)?',\n        replacement: (match, prefix, name, args, line_break) => {\n            args = empty_or_escaped(args);\n            line_break = line_break || '';\n            return `${prefix}get_ipython().run_line_magic(\"${name}\", \"${args}\")${line_break}`;\n        },\n        scope: 'line',\n        reverse: {\n            pattern: 'get_ipython\\\\(\\\\).run_line_magic\\\\(\"(.*?)\", \"(.*?)\"\\\\)(\\n)?',\n            replacement: (match, name, args) => {\n                args = unescape(args);\n                return `%${name}${args}`;\n            },\n            scope: 'line'\n        }\n    },\n    /**\n     * Cell magics\n     */\n    {\n        pattern: '^%%(\\\\S+)(.*\\n)([\\\\s\\\\S]*)',\n        replacement: (match, name, first_line, content, offset, entire) => {\n            first_line = empty_or_escaped(first_line);\n            if (first_line) {\n                // remove the new line\n                first_line = first_line.slice(0, -1);\n            }\n            content = content.replace(/\"\"\"/g, '\\\\\"\\\\\"\\\\\"');\n            return `get_ipython().run_cell_magic(\"${name}\", \"${first_line}\", \"\"\"${content}\"\"\")`;\n        },\n        scope: 'cell',\n        reverse: {\n            pattern: '^get_ipython\\\\(\\\\).run_cell_magic\\\\(\"(.*?)\", \"(.*?)\", \"\"\"([\\\\s\\\\S]*)\"\"\"\\\\)',\n            replacement: (match, name, line, content) => {\n                content = content.replace(/\\\\\"\\\\\"\\\\\"/g, '\"\"\"');\n                line = unescape(line);\n                return `%%${name}${line}\\n${content}`;\n            },\n            scope: 'cell'\n        }\n    }\n];\n//# sourceMappingURL=overrides.js.map","import { ILSPCodeOverridesManager } from '../../overrides/tokens';\nimport { ILSPCodeExtractorsManager, PLUGIN_ID } from '../../tokens';\nimport { foreign_code_extractors } from './extractors';\nimport { overrides } from './overrides';\nexport const IPYTHON_TRANSCLUSIONS = {\n    id: PLUGIN_ID + ':ipython',\n    requires: [ILSPCodeExtractorsManager, ILSPCodeOverridesManager],\n    activate: (app, extractors_manager, overrides_manager) => {\n        for (let language of Object.keys(foreign_code_extractors)) {\n            for (let extractor of foreign_code_extractors[language]) {\n                extractors_manager.register(extractor, language);\n            }\n        }\n        for (let override of overrides) {\n            overrides_manager.register(override, 'python');\n        }\n    },\n    autoStart: true\n};\n//# sourceMappingURL=index.js.map","import { RegExpForeignCodeExtractor } from '../../extractors/regexp';\nexport const SQL_URL_PATTERN = '(?:(?:.*?)://(?:.*))';\n// note: -a/--connection_arguments and -f/--file are not supported yet\nconst single_argument_options = [\n    '--destination_table',\n    '--project',\n    '--use_bqstorage_api',\n    '--use_rest_api',\n    '--use_legacy_sql',\n    '--verbose',\n    '--params'\n];\nconst zero_argument_options = ['-l', '--connections'];\nconst COMMAND_PATTERN = '(?:' +\n    (zero_argument_options.join('|') +\n        '|' +\n        single_argument_options.map(command => command + ' \\\\w+').join('|')) +\n    ')';\nexport let foreign_code_extractors = {\n    // general note: to match new lines use [^] instead of dot, unless the target is ES2018, then use /s\n    python: [\n        new RegExpForeignCodeExtractor({\n            language: 'sql',\n            pattern: `^%%bigquery(?: (?:${SQL_URL_PATTERN}|${COMMAND_PATTERN}|(?:\\\\w+ << )|(?:\\\\w+@\\\\w+)))?\\n?((?:.+\\n)?(?:[^]*))`,\n            foreign_capture_groups: [1],\n            is_standalone: true,\n            file_extension: 'sql'\n        })\n    ]\n};\n//# sourceMappingURL=extractors.js.map","import { ILSPCodeExtractorsManager, PLUGIN_ID } from '../../tokens';\nimport { foreign_code_extractors } from './extractors';\n/**\n * Implements extraction of code for IPython Magics for BigQuery, see:\n * https://googleapis.dev/python/bigquery/latest/magics.html.\n */\nexport const IPYTHON_BIGQUERY_TRANSCLUSIONS = {\n    id: PLUGIN_ID + ':ipython-bigquery',\n    requires: [ILSPCodeExtractorsManager],\n    activate: (app, extractors_manager) => {\n        for (let language of Object.keys(foreign_code_extractors)) {\n            for (let extractor of foreign_code_extractors[language]) {\n                extractors_manager.register(extractor, language);\n            }\n        }\n    },\n    autoStart: true\n};\n//# sourceMappingURL=index.js.map","export const RPY2_MAX_ARGS = 10;\nexport function extract_r_args(args, content_position) {\n    let inputs = [];\n    let outputs = [];\n    let others = [];\n    for (let i = 0; i < args.length; i = i + 2) {\n        let arg = args[i];\n        let variable = args[i + 1];\n        if (arg == null) {\n            break;\n        }\n        else if (arg === 'i' || arg === '-input') {\n            inputs.push(variable);\n        }\n        else if (arg === 'o' || arg === '-output') {\n            outputs.push(variable);\n        }\n        else {\n            others.push('-' + arg + ' ' + variable);\n        }\n    }\n    return {\n        inputs: inputs,\n        outputs: outputs,\n        rest: args[args.length + content_position],\n        others: others\n    };\n}\nexport function parse_r_args(args, content_position) {\n    let { inputs, outputs, rest, others } = extract_r_args(args, content_position);\n    let input_variables = inputs.join(', ');\n    if (input_variables) {\n        input_variables = ', ' + input_variables;\n    }\n    let output_variables = outputs.join(', ');\n    if (output_variables) {\n        output_variables = output_variables + ' = ';\n    }\n    return {\n        content: rest,\n        others: others.join(' '),\n        inputs: input_variables,\n        outputs: output_variables\n    };\n}\nexport function rpy2_reverse_pattern(quote = '\"', multi_line = false, magic = 'R') {\n    return ('(\\\\S+)?' +\n        '(?:, (\\\\S+))?'.repeat(9) +\n        '( = )?rpy2\\\\.ipython\\\\.rmagic\\\\.RMagics.' +\n        magic +\n        '\\\\(' +\n        quote +\n        (multi_line ? '([\\\\s\\\\S]*)' : '(.*?)') +\n        quote +\n        ', \"(.*?)\"' +\n        '(?:, (\\\\S+))?'.repeat(10) +\n        '\\\\)');\n}\nexport function rpy2_reverse_replacement(match, ...args) {\n    let outputs = [];\n    for (let i = 0; i < 10; i++) {\n        if (args[i] == null) {\n            break;\n        }\n        outputs.push(args[i]);\n    }\n    let inputs = [];\n    for (let i = 13; i < 23; i++) {\n        if (args[i] == null) {\n            break;\n        }\n        inputs.push(args[i]);\n    }\n    let input_variables = inputs.join(' -i ');\n    if (input_variables) {\n        input_variables = ' -i ' + input_variables;\n    }\n    let output_variables = outputs.join(' -o ');\n    if (output_variables) {\n        output_variables = ' -o ' + output_variables;\n    }\n    let contents = args[11];\n    let other_args = args[12];\n    if (other_args) {\n        other_args = ' ' + other_args;\n    }\n    return {\n        input: input_variables,\n        output: output_variables,\n        other: other_args,\n        contents: contents\n    };\n}\nexport function rpy2_args_pattern(max_n) {\n    return '(?: -(\\\\S+) (\\\\S+))?'.repeat(max_n);\n}\n//# sourceMappingURL=rpy2.js.map","import { RegExpForeignCodeExtractor } from '../../extractors/regexp';\nimport { RPY2_MAX_ARGS, extract_r_args, rpy2_args_pattern } from './rpy2';\nfunction create_rpy_code_extractor(strip_leading_space) {\n    function rpy2_code_extractor(match, ...args) {\n        let r = extract_r_args(args, -3);\n        let code;\n        if (r.rest == null) {\n            code = '';\n        }\n        else if (strip_leading_space) {\n            code = r.rest.startsWith(' ') ? r.rest.slice(1) : r.rest;\n        }\n        else {\n            code = r.rest;\n        }\n        return code;\n    }\n    return rpy2_code_extractor;\n}\nlet rpy2_code_extractor_non_stripping = create_rpy_code_extractor(false);\nfunction rpy2_args(match, ...args) {\n    let r = extract_r_args(args, -3);\n    // define dummy input variables using empty data frames\n    let inputs = r.inputs.map(i => i + ' <- data.frame();').join(' ');\n    let code = rpy2_code_extractor_non_stripping(match, ...args);\n    if (inputs !== '' && code) {\n        inputs += ' ';\n    }\n    return inputs;\n}\nexport let foreign_code_extractors = {\n    // general note: to match new lines use [^] instead of dot, unless the target is ES2018, then use /s\n    python: [\n        //\n        // R magics (non-standalone: the R code will always be in the same, single R-namespace)\n        //\n        new RegExpForeignCodeExtractor({\n            language: 'r',\n            pattern: '^%%R' + rpy2_args_pattern(RPY2_MAX_ARGS) + '\\n([^]*)',\n            foreign_capture_groups: [RPY2_MAX_ARGS * 2 + 1],\n            // it is important to not strip any leading spaces\n            foreign_replacer: rpy2_code_extractor_non_stripping,\n            extract_arguments: rpy2_args,\n            is_standalone: false,\n            file_extension: 'R'\n        }),\n        new RegExpForeignCodeExtractor({\n            language: 'r',\n            // it is very important to not include the space which will be trimmed in the capture group,\n            // otherwise the offset will be off by one and the R language server will crash\n            pattern: '(?:^|\\n)%R' + rpy2_args_pattern(RPY2_MAX_ARGS) + '(?: (.*))?(?:\\n|$)',\n            foreign_capture_groups: [RPY2_MAX_ARGS * 2 + 1],\n            foreign_replacer: create_rpy_code_extractor(true),\n            extract_arguments: rpy2_args,\n            is_standalone: false,\n            file_extension: 'R'\n        })\n    ]\n};\n//# sourceMappingURL=extractors.js.map","import { LINE_MAGIC_PREFIX } from '../ipython/overrides';\nimport { RPY2_MAX_ARGS, parse_r_args, rpy2_args_pattern, rpy2_reverse_pattern, rpy2_reverse_replacement } from './rpy2';\nexport let overrides = [\n    {\n        // support up to 10 arguments\n        pattern: LINE_MAGIC_PREFIX +\n            '%R' +\n            rpy2_args_pattern(RPY2_MAX_ARGS) +\n            '( .*)?(\\n|$)',\n        replacement: (match, prefix, ...args) => {\n            let r = parse_r_args(args, -4);\n            // note: only supports assignment or -o/--output, not both\n            // TODO assignment like in x = %R 1 should be distinguished from -o\n            return `${prefix}${r.outputs}rpy2.ipython.rmagic.RMagics.R(\"${r.content || ''}\", \"${r.others}\"${r.inputs})`;\n        },\n        scope: 'line',\n        reverse: {\n            pattern: rpy2_reverse_pattern(),\n            replacement: (match, ...args) => {\n                let r = rpy2_reverse_replacement(match, ...args);\n                return '%R' + r.input + r.output + r.other + r.contents;\n            },\n            scope: 'line'\n        }\n    },\n    // rpy2 extension R magic - this should likely go as an example to the user documentation, rather than being a default\n    //   only handles simple one input - one output case\n    {\n        pattern: '^%%R' + rpy2_args_pattern(RPY2_MAX_ARGS) + '(\\n)?([\\\\s\\\\S]*)',\n        replacement: (match, ...args) => {\n            let r = parse_r_args(args, -3);\n            return `${r.outputs}rpy2.ipython.rmagic.RMagics.R(\"\"\"${r.content}\"\"\", \"${r.others}\"${r.inputs})`;\n        },\n        scope: 'cell',\n        reverse: {\n            pattern: rpy2_reverse_pattern('\"\"\"', true),\n            replacement: (match, ...args) => {\n                let r = rpy2_reverse_replacement(match, ...args);\n                return '%%R' + r.input + r.output + r.other + '\\n' + r.contents;\n            },\n            scope: 'cell'\n        }\n    },\n    {\n        pattern: LINE_MAGIC_PREFIX + '%Rdevice( .*)?(\\n|$)',\n        replacement: (match, prefix, ...args) => {\n            return `${prefix}rpy2.ipython.rmagic.RMagics.Rdevice(\"${args[0]}\", \"\")`;\n        },\n        scope: 'line',\n        reverse: {\n            pattern: rpy2_reverse_pattern('\"', false, 'Rdevice'),\n            replacement: (match, ...args) => {\n                let r = rpy2_reverse_replacement(match, ...args);\n                return '%Rdevice' + r.input + r.output + r.other + r.contents;\n            },\n            scope: 'line'\n        }\n    }\n];\n//# sourceMappingURL=overrides.js.map","import { ILSPCodeOverridesManager } from '../../overrides/tokens';\nimport { ILSPCodeExtractorsManager, PLUGIN_ID } from '../../tokens';\nimport { foreign_code_extractors } from './extractors';\nimport { overrides } from './overrides';\nexport const IPYTHON_RPY2_TRANSCLUSIONS = {\n    id: PLUGIN_ID + ':ipython-rpy2',\n    requires: [ILSPCodeExtractorsManager, ILSPCodeOverridesManager],\n    activate: (app, extractors_manager, overrides_manager) => {\n        for (let language of Object.keys(foreign_code_extractors)) {\n            for (let extractor of foreign_code_extractors[language]) {\n                extractors_manager.register(extractor, language);\n            }\n        }\n        for (let override of overrides) {\n            overrides_manager.register(override, 'python');\n        }\n    },\n    autoStart: true\n};\n//# sourceMappingURL=index.js.map","import { RegExpForeignCodeExtractor } from '../../extractors/regexp';\nexport const SQL_URL_PATTERN = '(?:(?:.*?)://(?:.*))';\n// note: -a/--connection_arguments and -f/--file are not supported yet\nconst single_argument_options = [\n    '-x',\n    '--close',\n    '-c',\n    '--creator',\n    '-p',\n    '--persist',\n    '--append'\n];\nconst zero_argument_options = ['-l', '--connections'];\nconst COMMAND_PATTERN = '(?:' +\n    (zero_argument_options.join('|') +\n        '|' +\n        single_argument_options.map(command => command + ' \\\\w+').join('|')) +\n    ')';\nexport let foreign_code_extractors = {\n    // general note: to match new lines use [^] instead of dot, unless the target is ES2018, then use /s\n    python: [\n        new RegExpForeignCodeExtractor({\n            language: 'sql',\n            pattern: `^%%sql(?: (?:${SQL_URL_PATTERN}|${COMMAND_PATTERN}|(?:\\\\w+ << )|(?:\\\\w+@\\\\w+)))?\\n?((?:.+\\n)?(?:[^]*))`,\n            foreign_capture_groups: [1],\n            is_standalone: true,\n            file_extension: 'sql'\n        }),\n        new RegExpForeignCodeExtractor({\n            language: 'sql',\n            pattern: `(?:^|\\n)%sql (?:${SQL_URL_PATTERN}|${COMMAND_PATTERN}|(.*))\\n?`,\n            foreign_capture_groups: [1],\n            is_standalone: false,\n            file_extension: 'sql'\n        })\n    ]\n};\n//# sourceMappingURL=extractors.js.map","import { ILSPCodeExtractorsManager, PLUGIN_ID } from '../../tokens';\nimport { foreign_code_extractors } from './extractors';\n/**\n * Implements extraction of code for ipython-sql, see:\n * https://github.com/catherinedevlin/ipython-sql.\n * No dedicated code overrides are provided (but the default IPython\n * overrides should prevent any syntax errors in the virtual documents)\n */\nexport const IPYTHON_SQL_TRANSCLUSIONS = {\n    id: PLUGIN_ID + ':ipython-sql',\n    requires: [ILSPCodeExtractorsManager],\n    activate: (app, extractors_manager) => {\n        for (let language of Object.keys(foreign_code_extractors)) {\n            for (let extractor of foreign_code_extractors[language]) {\n                extractors_manager.register(extractor, language);\n            }\n        }\n    },\n    autoStart: true\n};\n//# sourceMappingURL=index.js.map","import { IPYTHON_TRANSCLUSIONS } from './ipython';\nimport { IPYTHON_BIGQUERY_TRANSCLUSIONS } from './ipython-bigquery';\nimport { IPYTHON_RPY2_TRANSCLUSIONS } from './ipython-rpy2';\nimport { IPYTHON_SQL_TRANSCLUSIONS } from './ipython-sql';\nexport const DEFAULT_TRANSCLUSIONS = [\n    IPYTHON_RPY2_TRANSCLUSIONS,\n    IPYTHON_SQL_TRANSCLUSIONS,\n    IPYTHON_BIGQUERY_TRANSCLUSIONS,\n    IPYTHON_TRANSCLUSIONS\n];\n//# sourceMappingURL=defaults.js.map","import { CodeMirrorEditor } from '@jupyterlab/codemirror';\nimport { Signal } from '@lumino/signaling';\nimport { ILSPVirtualEditorManager, PLUGIN_ID } from '../tokens';\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nclass DocDispatcher {\n    constructor(virtual_editor, adapter) {\n        this.virtual_editor = virtual_editor;\n        this.adapter = adapter;\n    }\n    markText(from, to, options) {\n        // TODO: edgecase: from and to in different cells\n        let ce_editor = this.virtual_editor.virtual_document.get_editor_at_source_line(from);\n        let cm_editor = this.virtual_editor.ce_editor_to_cm_editor.get(ce_editor);\n        let notebook_map = this.virtual_editor;\n        return cm_editor\n            .getDoc()\n            .markText(notebook_map.transform_from_root_to_editor(from), notebook_map.transform_from_root_to_editor(to), options);\n    }\n    getCursor(start) {\n        let active_editor = this.adapter.activeEditor;\n        if (active_editor == null) {\n            // TODO\n            return undefined;\n        }\n        let cursor = active_editor.editor\n            .getDoc()\n            .getCursor(start);\n        return this.virtual_editor.transform_from_editor_to_root(active_editor, cursor);\n    }\n}\n/**\n * VirtualEditor extends the CodeMirror.Editor interface; its subclasses may either\n * fast-forward any requests to an existing instance of the CodeMirror.Editor\n * (using ES6 Proxy), or implement custom behaviour, allowing for the use of\n * virtual documents representing code in complex entities such as notebooks.\n */\nexport class CodeMirrorVirtualEditor {\n    constructor(options) {\n        // TODO: getValue could be made private in the virtual editor and the virtual editor\n        //  could stop exposing the full implementation of CodeMirror but rather hide it inside.\n        this.editor_name = 'CodeMirrorEditor';\n        this.isDisposed = false;\n        this._event_wrappers = new Map();\n        this.adapter = options.adapter;\n        this.virtual_document = options.virtual_document;\n        this.console = this.adapter.console;\n        this.change = new Signal(this);\n        this.block_added_handlers = [];\n        this.block_removed_handlers = [];\n        this.editor_to_source_line = new Map();\n        this.cm_editor_to_ce_editor = new Map();\n        this.ce_editor_to_cm_editor = new Map();\n        this._proxy = new Proxy(this, {\n            get: function (target, prop, receiver) {\n                if (!(prop in target)) {\n                    console.warn(`Unimplemented method ${prop.toString()} for CodeMirrorVirtualEditor`);\n                    return;\n                }\n                else {\n                    return Reflect.get(target, prop, receiver);\n                }\n            }\n        });\n        // this is not the most efficient, but probably the most reliable way\n        this.virtual_document.update_manager.update_began.connect(this.onEditorsUpdated, this);\n        this.virtual_document.update_manager.block_added.connect(this.save_block_position, this);\n        this.virtual_document.update_manager.update_finished.connect(() => {\n            this.editor_to_source_line = this.editor_to_source_line_new;\n        }, this);\n        this.set_event_handlers();\n        return this._proxy;\n    }\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this.editor_to_source_line.clear();\n        this.cm_editor_to_ce_editor.clear();\n        this.ce_editor_to_cm_editor.clear();\n        this.off('change', this.emit_change);\n        for (let [[eventName], wrapped_handler] of this._event_wrappers.entries()) {\n            this.forEveryBlockEditor(cm_editor => {\n                cm_editor.off(eventName, wrapped_handler);\n            }, false);\n        }\n        this._event_wrappers.clear();\n        this.disconnectBlockMonitoring();\n        this.virtual_document.dispose();\n        // just to be sure\n        this.virtual_document = null;\n        this.code_extractors = null;\n        this.isDisposed = true;\n        // just to be sure\n        this.forEveryBlockEditor = null;\n        this._proxy = null;\n    }\n    get_cursor_position() {\n        return this.getDoc().getCursor('end');\n    }\n    onEditorsUpdated(update_manager, blocks) {\n        this.cm_editor_to_ce_editor.clear();\n        this.ce_editor_to_cm_editor.clear();\n        this.editor_to_source_line_new = new Map();\n        for (let block of blocks) {\n            let ce_editor = block.ce_editor;\n            let cm_editor = ce_editor.editor;\n            this.cm_editor_to_ce_editor.set(cm_editor, ce_editor);\n            this.ce_editor_to_cm_editor.set(ce_editor, cm_editor);\n        }\n    }\n    save_block_position(update_manager, block_data) {\n        this.editor_to_source_line_new.set(block_data.block.ce_editor, block_data.virtual_document.last_source_line);\n    }\n    set_event_handlers() {\n        this.on('change', this.emit_change.bind(this));\n    }\n    emit_change(instance, change) {\n        this.change.emit(change);\n    }\n    window_coords_to_root_position(coordinates) {\n        const position = this.coordsChar(coordinates, 'window');\n        if (position.line === -1 && position.ch === -1) {\n            return null;\n        }\n        return position;\n    }\n    get_token_at(position) {\n        let token = this.getTokenAt(position);\n        return {\n            value: token.string,\n            offset: token.start,\n            type: token.type || ''\n        };\n    }\n    get_cm_editor(position) {\n        return this.get_editor_at_root_line(position);\n    }\n    transform_virtual_to_editor(position) {\n        return this.virtual_document.transform_virtual_to_editor(position);\n    }\n    // TODO .root is not really needed as we are in editor now...\n    document_at_root_position(position) {\n        let root_as_source = position;\n        return this.virtual_document.root.document_at_source_position(root_as_source);\n    }\n    root_position_to_virtual_position(position) {\n        let root_as_source = position;\n        return this.virtual_document.root.virtual_position_at_document(root_as_source);\n    }\n    get_editor_at_root_position(root_position) {\n        return this.virtual_document.root.get_editor_at_source_line(root_position);\n    }\n    root_position_to_editor(root_position) {\n        return this.virtual_document.root.transform_source_to_editor(root_position);\n    }\n    /**\n     * Proxy the event handler binding to the CodeMirror editors,\n     * allowing for multiple actual editors per a virtual editor.\n     *\n     * Only handlers accepting CodeMirror.Editor are supported for simplicity.\n     */\n    on(eventName, handler, ...args) {\n        let wrapped_handler = (instance, ...args) => {\n            try {\n                return handler(this, ...args);\n            }\n            catch (error) {\n                this.console.warn('CodeMirrorVirtualEditor handler (which should accept a CodeMirror Editor instance) failed', { error, instance, args, this: this });\n            }\n        };\n        this._event_wrappers.set([eventName, handler], wrapped_handler);\n        this.forEveryBlockEditor(cm_editor => {\n            cm_editor.on(eventName, wrapped_handler);\n        }, true, cm_editor => {\n            cm_editor.off(eventName, wrapped_handler);\n        });\n    }\n    off(eventName, handler, ...args) {\n        let wrapped_handler = this._event_wrappers.get([eventName, handler]);\n        this.forEveryBlockEditor(cm_editor => {\n            cm_editor.off(eventName, wrapped_handler);\n        });\n    }\n    find_ce_editor(cm_editor) {\n        return this.cm_editor_to_ce_editor.get(cm_editor);\n    }\n    transform_from_editor_to_root(editor, position) {\n        if (!this.editor_to_source_line.has(editor)) {\n            this.console.warn('Editor not found in editor_to_source_line map');\n            return null;\n        }\n        let shift = this.editor_to_source_line.get(editor);\n        return Object.assign(Object.assign({}, position), { line: position.line + shift });\n    }\n    transform_from_root_to_editor(pos) {\n        // from notebook to editor space\n        return this.virtual_document.transform_source_to_editor(pos);\n    }\n    addKeyMap(map, bottom) {\n        return;\n    }\n    addLineClass(line, where, _class) {\n        return undefined;\n    }\n    addLineWidget(line, node, options) {\n        return undefined;\n    }\n    addOverlay(mode, options) {\n        for (let editor of this.adapter.editors) {\n            // TODO: use some more intelligent strategy to determine editors to test\n            let cm_editor = editor;\n            cm_editor.editor.addOverlay(mode, options);\n        }\n    }\n    addPanel(node, \n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    options\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    ) {\n        return undefined;\n    }\n    charCoords(pos, mode) {\n        try {\n            let editor = this.get_editor_at_root_line(pos);\n            return editor.charCoords(pos, mode);\n        }\n        catch (e) {\n            console.log(e);\n            return { bottom: 0, left: 0, right: 0, top: 0 };\n        }\n    }\n    /**\n     * @note returns {line: -1, ch: -1} if position is outside of all editors\n     */\n    coordsChar(object, mode) {\n        let bestGuess = null;\n        for (let editor of this.adapter.editors) {\n            // TODO: use some more intelligent strategy to determine editors to test\n            let cm_editor = editor;\n            let pos = cm_editor.editor.coordsChar(object, mode);\n            if (pos.outside === 1) {\n                continue;\n            }\n            bestGuess = this.transform_from_editor_to_root(editor, pos);\n            break;\n        }\n        if (bestGuess == null) {\n            return {\n                line: -1,\n                ch: -1\n            };\n        }\n        return bestGuess;\n    }\n    cursorCoords(where, mode) {\n        if (typeof where !== 'boolean' && where != null) {\n            let editor = this.get_editor_at_root_line(where);\n            return editor.cursorCoords(this.transform_from_root_to_editor(where));\n        }\n        return { bottom: 0, left: 0, top: 0 };\n    }\n    get any_editor() {\n        return this.adapter.editors[0].editor;\n    }\n    defaultCharWidth() {\n        return this.any_editor.defaultCharWidth();\n    }\n    defaultTextHeight() {\n        return this.any_editor.defaultTextHeight();\n    }\n    endOperation() {\n        for (let editor of this.adapter.editors) {\n            let cm_editor = editor;\n            cm_editor.editor.endOperation();\n        }\n    }\n    execCommand(name) {\n        for (let editor of this.adapter.editors) {\n            let cm_editor = editor;\n            cm_editor.editor.execCommand(name);\n        }\n    }\n    getDoc() {\n        let dummy_doc = new DocDispatcher(this, this.adapter);\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        return dummy_doc;\n    }\n    get_editor_at_root_line(pos) {\n        let ce_editor = this.virtual_document.root.get_editor_at_source_line(pos);\n        return this.ce_editor_to_cm_editor.get(ce_editor);\n    }\n    getTokenAt(pos, precise) {\n        let editor = this.get_editor_at_root_line(pos);\n        return editor.getTokenAt(this.transform_from_root_to_editor(pos));\n    }\n    getTokenTypeAt(pos) {\n        let ce_editor = this.virtual_document.get_editor_at_source_line(pos);\n        let cm_editor = this.ce_editor_to_cm_editor.get(ce_editor);\n        return cm_editor.getTokenTypeAt(this.transform_from_root_to_editor(pos));\n    }\n    get_editor_value(editor) {\n        let codemirror_editor = editor;\n        return codemirror_editor.model.value.text;\n        // A previous implementation was using the underlying\n        // CodeMirror editor instance (as one could expect), i.e:\n        //     let cm_editor = codemirror_editor.editor;\n        //     return cm_editor.getValue();\n        // however, because we are listening to:\n        // this.widget.context.model.contentChanged\n        // it turns out that the model can not be as fast to propagate\n        // the changes to the underlying CodeMirror editor instance yet\n        // so it seems reasonable to use the newer value from the model\n        // to build the next VirtualDocument; it turned out to solve some\n        // of the failures to resolve position within the virtual document\n        // which were due to race conditions.\n    }\n    getWrapperElement() {\n        return this.adapter.wrapper_element;\n    }\n    heightAtLine(line, mode, includeWidgets) {\n        return 0;\n    }\n    isReadOnly() {\n        return false;\n    }\n    lineAtHeight(height, mode) {\n        return 0;\n    }\n    disconnectBlockMonitoring() {\n        for (let handler of this.block_added_handlers) {\n            this.adapter.editorAdded.disconnect(handler);\n        }\n        this.block_added_handlers = [];\n        for (let handler of this.block_removed_handlers) {\n            this.adapter.editorRemoved.disconnect(handler);\n        }\n        this.block_removed_handlers = [];\n    }\n    forEveryBlockEditor(callback, monitor_for_new_blocks = true, on_editor_removed_callback = null) {\n        const editors_with_handlers = new Set();\n        // TODO... the need of iterating over all editors is universal - so this could be\n        //  generalised to the VirtualEditor rather than live in CodeMirrorVirtualEditor;\n        //  How would the VirtualEditor get knowledge of the editor instances?\n        //  From the adapter (obviously).\n        for (let editor of this.adapter.editors) {\n            let cm_editor = editor.editor;\n            editors_with_handlers.add(cm_editor);\n            callback(cm_editor);\n        }\n        if (monitor_for_new_blocks) {\n            const on_block_added = (adapter, data) => {\n                let { editor } = data;\n                if (editor == null) {\n                    return;\n                }\n                let cm_editor = editor.editor;\n                if (!editors_with_handlers.has(cm_editor)) {\n                    callback(cm_editor);\n                }\n            };\n            const on_block_removed = (adapter, data) => {\n                if (on_editor_removed_callback == null) {\n                    return;\n                }\n                let { editor } = data;\n                if (editor == null) {\n                    return;\n                }\n                let cm_editor = editor.editor;\n                on_editor_removed_callback(cm_editor);\n            };\n            this.block_added_handlers.push(on_block_added);\n            this.block_added_handlers.push(on_block_removed);\n            this.adapter.editorAdded.connect(on_block_added);\n            this.adapter.editorRemoved.connect(on_block_removed);\n        }\n    }\n    /**\n     * Find a cell in notebook which uses given CodeMirror editor.\n     * This function is O(n) - when looking up many cells\n     * using a hashmap based approach may be more efficient.\n     * @param cm_editor\n     */\n    find_editor(cm_editor) {\n        let ce_editor = this.cm_editor_to_ce_editor.get(cm_editor);\n        return {\n            index: this.adapter.get_editor_index(ce_editor),\n            node: this.adapter.get_editor_wrapper(ce_editor)\n        };\n    }\n}\nexport const CODEMIRROR_VIRTUAL_EDITOR = {\n    id: PLUGIN_ID + ':CodeMirrorVirtualEditor',\n    requires: [ILSPVirtualEditorManager],\n    activate: (app, editorManager) => {\n        return editorManager.registerEditorType({\n            implementation: CodeMirrorVirtualEditor,\n            name: 'CodeMirrorEditor',\n            supports: CodeMirrorEditor\n        });\n    },\n    autoStart: true\n};\n//# sourceMappingURL=codemirror_editor.js.map","import { ILSPVirtualEditorManager, PLUGIN_ID } from '../tokens';\nexport class VirtualEditorManager {\n    constructor() {\n        this.editorTypes = [];\n    }\n    registerEditorType(options) {\n        this.editorTypes.push(options);\n    }\n    findBestImplementation(editors) {\n        // for now, we check if all editors are of the same type,\n        // but it could be good enough if majority of the editors\n        // had the requested type\n        for (let editorType of this.editorTypes) {\n            if (editors.every(editor => editor instanceof editorType.supports)) {\n                return editorType;\n            }\n        }\n        console.warn('Cold not find a VirtualEditor suitable for the provided set of editors:', editors);\n        return null;\n    }\n}\nexport const VIRTUAL_EDITOR_MANAGER = {\n    id: PLUGIN_ID + ':ILSPVirtualEditorManager',\n    requires: [],\n    activate: app => {\n        return new VirtualEditorManager();\n    },\n    provides: ILSPVirtualEditorManager,\n    autoStart: true\n};\n//# sourceMappingURL=editor.js.map","/** The Public API, as exposed in the `main` field of package.json */\n/** General public tokens, including lumino Tokens and namespaces */\nexport * from './tokens';\n/** Component- and feature-specific APIs */\nexport * from './api';\nimport { JupyterFrontEnd } from '@jupyterlab/application';\nimport { ICommandPalette } from '@jupyterlab/apputils';\nimport { IDocumentManager } from '@jupyterlab/docmanager';\nimport { ILoggerRegistry } from '@jupyterlab/logconsole';\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { IStatusBar } from '@jupyterlab/statusbar';\nimport { ITranslator, nullTranslator } from '@jupyterlab/translation';\nimport { COMPLETION_THEME_MANAGER } from '@krassowski/completion-theme';\nimport { plugin as THEME_MATERIAL } from '@krassowski/theme-material';\nimport { plugin as THEME_VSCODE } from '@krassowski/theme-vscode';\nimport { Signal } from '@lumino/signaling';\nimport '../style/index.css';\nimport { WIDGET_ADAPTER_MANAGER } from './adapter_manager';\nimport { FILE_EDITOR_ADAPTER } from './adapters/file_editor';\nimport { NOTEBOOK_ADAPTER } from './adapters/notebook';\nimport { ContextCommandManager } from './command_manager';\nimport { StatusButtonExtension } from './components/statusbar';\nimport { DocumentConnectionManager } from './connection_manager';\nimport { CODE_EXTRACTORS_MANAGER } from './extractors/manager';\nimport { COMPLETION_PLUGIN } from './features/completion';\nimport { DIAGNOSTICS_PLUGIN } from './features/diagnostics';\nimport { HIGHLIGHTS_PLUGIN } from './features/highlights';\nimport { HOVER_PLUGIN } from './features/hover';\nimport { JUMP_PLUGIN } from './features/jump_to';\nimport { RENAME_PLUGIN } from './features/rename';\nimport { SIGNATURE_PLUGIN } from './features/signature';\nimport { SYNTAX_HIGHLIGHTING_PLUGIN } from './features/syntax_highlighting';\nimport { LanguageServerManager } from './manager';\nimport { CODE_OVERRIDES_MANAGER } from './overrides';\nimport { ILSPCodeOverridesManager } from './overrides/tokens';\nimport { ILSPAdapterManager, ILSPCodeExtractorsManager, ILSPFeatureManager, ILSPLogConsole, ILSPVirtualEditorManager, PLUGIN_ID } from './tokens';\nimport { DEFAULT_TRANSCLUSIONS } from './transclusions/defaults';\nimport { CODEMIRROR_VIRTUAL_EDITOR } from './virtual/codemirror_editor';\nimport { LOG_CONSOLE } from './virtual/console';\nimport { VIRTUAL_EDITOR_MANAGER } from './virtual/editor';\nvar IPaths = JupyterFrontEnd.IPaths;\nexport class FeatureManager {\n    constructor() {\n        this.features = [];\n        this.command_managers = [];\n        this.command_manager_registered = new Signal(this);\n    }\n    _register(options) {\n        if (options.supersedes) {\n            for (let option of options.supersedes) {\n                this.features = this.features.filter(feature => feature.id != option);\n            }\n        }\n        this.features.push(options.feature);\n        if (options.feature.commands) {\n            for (let command_manager of this.command_managers) {\n                command_manager.add(options.feature.commands);\n            }\n            this.command_manager_registered.connect((feature_manager, command_manager) => {\n                if (options.feature.commands) {\n                    command_manager.add(options.feature.commands);\n                }\n            });\n        }\n    }\n    register(options) {\n        if (options.feature.settings && options.feature.settings.ready) {\n            options.feature.settings.ready\n                .then(() => {\n                var _a, _b;\n                if (!((_b = (_a = options.feature) === null || _a === void 0 ? void 0 : _a.settings) === null || _b === void 0 ? void 0 : _b.composite.disable)) {\n                    this._register(options);\n                }\n                else {\n                    console.log('Skipping ', options.feature.id, 'as disabled');\n                }\n            })\n                .catch(console.warn);\n            return;\n        }\n        else {\n            this._register(options);\n        }\n    }\n    registerCommandManager(manager) {\n        this.command_managers.push(manager);\n        this.command_manager_registered.emit(manager);\n    }\n}\nexport class LSPExtension {\n    constructor(app, setting_registry, palette, documentManager, paths, adapterManager, editor_type_manager, code_extractors_manager, code_overrides_manager, console, translator, user_console, status_bar) {\n        this.app = app;\n        this.setting_registry = setting_registry;\n        this.palette = palette;\n        this.editor_type_manager = editor_type_manager;\n        this.code_extractors_manager = code_extractors_manager;\n        this.code_overrides_manager = code_overrides_manager;\n        this.console = console;\n        this.translator = translator;\n        this.user_console = user_console;\n        const trans = (translator || nullTranslator).load('jupyterlab_lsp');\n        this.language_server_manager = new LanguageServerManager({\n            console: this.console.scope('LanguageServerManager')\n        });\n        this.connection_manager = new DocumentConnectionManager({\n            language_server_manager: this.language_server_manager,\n            console: this.console.scope('DocumentConnectionManager')\n        });\n        const statusButtonExtension = new StatusButtonExtension({\n            language_server_manager: this.language_server_manager,\n            connection_manager: this.connection_manager,\n            adapter_manager: adapterManager,\n            translator_bundle: trans\n        });\n        if (status_bar !== null) {\n            status_bar.registerStatusItem(PLUGIN_ID + ':language-server-status', {\n                item: statusButtonExtension.createItem(),\n                align: 'left',\n                rank: 1,\n                isActive: () => adapterManager.isAnyActive()\n            });\n        }\n        else {\n            app.docRegistry.addWidgetExtension('Notebook', statusButtonExtension);\n        }\n        this.feature_manager = new FeatureManager();\n        this.setting_registry\n            .load(plugin.id)\n            .then(settings => {\n            const options = settings.composite;\n            // Store the initial server settings, to be sent asynchronously\n            // when the servers are initialized.\n            const initial_configuration = (options.language_servers ||\n                {});\n            this.connection_manager.initial_configurations = initial_configuration;\n            // update the server-independent part of configuration immediately\n            this.connection_manager.updateConfiguration(initial_configuration);\n            this.connection_manager.updateLogging(options.logAllCommunication, options.setTrace);\n            settings.changed.connect(() => {\n                this.updateOptions(settings);\n            });\n        })\n            .catch((reason) => {\n            console.error(reason.message);\n        });\n        adapterManager.registerExtension(this);\n    }\n    registerAdapterType(adapterManager, type) {\n        let command_manger = new ContextCommandManager(Object.assign({ adapter_manager: adapterManager, app: this.app, palette: this.palette, tracker: type.tracker, suffix: type.name, entry_point: type.entrypoint, console: this.console }, type.context_menu));\n        this.feature_manager.registerCommandManager(command_manger);\n    }\n    get foreign_code_extractors() {\n        return this.code_extractors_manager.registry;\n    }\n    get code_overrides() {\n        return this.code_overrides_manager.registry;\n    }\n    updateOptions(settings) {\n        const options = settings.composite;\n        const languageServerSettings = (options.language_servers ||\n            {});\n        this.connection_manager.initial_configurations = languageServerSettings;\n        // TODO: if priorities changed reset connections\n        this.connection_manager.updateConfiguration(languageServerSettings);\n        this.connection_manager.updateServerConfigurations(languageServerSettings);\n        this.connection_manager.updateLogging(options.logAllCommunication, options.setTrace);\n    }\n}\n/**\n * The plugin registration information.\n */\nconst plugin = {\n    id: PLUGIN_ID + ':plugin',\n    requires: [\n        ISettingRegistry,\n        ICommandPalette,\n        IDocumentManager,\n        IPaths,\n        ILSPAdapterManager,\n        ILSPVirtualEditorManager,\n        ILSPCodeExtractorsManager,\n        ILSPCodeOverridesManager,\n        ILSPLogConsole,\n        ITranslator\n    ],\n    optional: [ILoggerRegistry, IStatusBar],\n    activate: (app, ...args) => {\n        let extension = new LSPExtension(app, ...args);\n        return extension.feature_manager;\n    },\n    provides: ILSPFeatureManager,\n    autoStart: true\n};\nconst default_features = [\n    JUMP_PLUGIN,\n    COMPLETION_PLUGIN,\n    SIGNATURE_PLUGIN,\n    HOVER_PLUGIN,\n    RENAME_PLUGIN,\n    HIGHLIGHTS_PLUGIN,\n    DIAGNOSTICS_PLUGIN,\n    SYNTAX_HIGHLIGHTING_PLUGIN\n];\nconst plugins = [\n    LOG_CONSOLE,\n    CODE_EXTRACTORS_MANAGER,\n    WIDGET_ADAPTER_MANAGER,\n    NOTEBOOK_ADAPTER,\n    FILE_EDITOR_ADAPTER,\n    VIRTUAL_EDITOR_MANAGER,\n    CODEMIRROR_VIRTUAL_EDITOR,\n    COMPLETION_THEME_MANAGER,\n    THEME_VSCODE,\n    THEME_MATERIAL,\n    CODE_OVERRIDES_MANAGER,\n    plugin,\n    ...DEFAULT_TRANSCLUSIONS,\n    ...default_features\n];\n/**\n * Export the plugins as default.\n */\nexport default plugins;\n//# sourceMappingURL=index.js.map","import { PageConfig } from '@jupyterlab/coreutils';\nimport mergeWith from 'lodash.mergewith';\nconst RE_PATH_ANCHOR = /^file:\\/\\/([^\\/]+|\\/[a-zA-Z](?::|%3A))/;\nexport async function sleep(timeout) {\n    return new Promise(resolve => {\n        setTimeout(() => {\n            resolve();\n        }, timeout);\n    });\n}\n// TODO: there is a JL native version of this which uses adaptive rate, maybe use instead?\nexport function until_ready(is_ready, max_retrials = 35, interval = 50, interval_modifier = (i) => i) {\n    return new Promise(async (resolve, reject) => {\n        let i = 0;\n        while (is_ready() !== true) {\n            i += 1;\n            if (max_retrials !== -1 && i > max_retrials) {\n                reject('Too many retrials');\n                break;\n            }\n            interval = interval_modifier(interval);\n            await sleep(interval);\n        }\n        resolve(is_ready);\n    });\n}\n/**\n * CodeMirror-proof implementation of event.getModifierState()\n */\nexport function getModifierState(event, modifierKey) {\n    // Note: Safari does not support getModifierState on MouseEvent, see:\n    // https://github.com/krassowski/jupyterlab-go-to-definition/issues/3\n    // thus AltGraph and others are not supported on Safari\n    // Full list of modifier keys and mappings to physical keys on different OSes:\n    // https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/getModifierState\n    // the key approach is needed for CodeMirror events which do not set\n    // *key (e.g. ctrlKey) correctly\n    const key = event.key || null;\n    let value = false;\n    switch (modifierKey) {\n        case 'Shift':\n            value = event.shiftKey || key == 'Shift';\n            break;\n        case 'Alt':\n            value = event.altKey || key == 'Alt';\n            break;\n        case 'AltGraph':\n            value = key == 'AltGraph';\n            break;\n        case 'Control':\n            value = event.ctrlKey || key == 'Control';\n            break;\n        case 'Meta':\n            value = event.metaKey || key == 'Meta';\n            break;\n        case 'Accel':\n            value =\n                event.metaKey || key == 'Meta' || event.ctrlKey || key == 'Control';\n            break;\n    }\n    if (event.getModifierState !== undefined) {\n        return value || event.getModifierState(modifierKey);\n    }\n    return value;\n}\nexport class DefaultMap extends Map {\n    constructor(default_factory, entries) {\n        super(entries);\n        this.default_factory = default_factory;\n    }\n    get(k) {\n        return this.get_or_create(k);\n    }\n    get_or_create(k, ...args) {\n        if (this.has(k)) {\n            return super.get(k);\n        }\n        else {\n            let v = this.default_factory(k, ...args);\n            this.set(k, v);\n            return v;\n        }\n    }\n}\nexport function server_root_uri() {\n    return PageConfig.getOption('rootUri');\n}\n/**\n * compare two URIs, discounting:\n * - drive capitalization\n * - uri encoding\n * TODO: probably use vscode-uri\n */\nexport function uris_equal(a, b) {\n    const win_paths = is_win_path(a) && is_win_path(b);\n    if (win_paths) {\n        a = normalize_win_path(a);\n        b = normalize_win_path(b);\n    }\n    return a === b || decodeURI(a) === decodeURI(b);\n}\n/**\n * grossly detect whether a URI represents a file on a windows drive\n */\nexport function is_win_path(uri) {\n    return uri.match(RE_PATH_ANCHOR);\n}\n/**\n * lowercase the drive component of a URI\n */\nexport function normalize_win_path(uri) {\n    // Pyright encodes colon on Windows, see:\n    // https://github.com/jupyter-lsp/jupyterlab-lsp/pull/587#issuecomment-844225253\n    return uri.replace(RE_PATH_ANCHOR, it => it.replace('%3A', ':').toLowerCase());\n}\nexport function uri_to_contents_path(child, parent) {\n    parent = parent || server_root_uri();\n    if (parent == null) {\n        return null;\n    }\n    if (child.startsWith(parent)) {\n        // 'decodeURIComponent' is needed over 'decodeURI' for '@' in TS/JS paths\n        return decodeURIComponent(child.replace(parent, ''));\n    }\n    return null;\n}\n/**\n * The docs for many language servers show settings in the\n * VSCode format, e.g.: \"pyls.plugins.pyflakes.enabled\"\n *\n * VSCode converts that dot notation to JSON behind the scenes,\n * as the language servers themselves don't accept that syntax.\n */\nexport const expandPath = (path, value) => {\n    const obj = {};\n    let curr = obj;\n    path.forEach((prop, i) => {\n        curr[prop] = {};\n        if (i === path.length - 1) {\n            curr[prop] = value;\n        }\n        else {\n            curr = curr[prop];\n        }\n    });\n    return obj;\n};\nexport const expandDottedPaths = (obj) => {\n    const settings = [];\n    for (let key in obj) {\n        const parsed = expandPath(key.split('.'), obj[key]);\n        settings.push(parsed);\n    }\n    return mergeWith({}, ...settings);\n};\nexport function escapeMarkdown(text) {\n    // note: keeping backticks for highlighting of code sections\n    text = text.replace(/([\\\\#*_[\\]])/g, '\\\\$1');\n    // escape HTML\n    const span = document.createElement('span');\n    span.textContent = text;\n    return span.innerHTML.replace(/\\n/g, '<br>').replace(/ {2}/g, '\\u00A0\\u00A0');\n}\n//# sourceMappingURL=utils.js.map","import { Token } from '@lumino/coreutils';\nexport const COMPLETER_THEME_PREFIX = 'lsp-completer-theme-';\n// TODO, once features are extracted to standalone packages,\n//  import the CompletionItemKindStrings from @feature-completer\nvar CompletionItemKind;\n(function (CompletionItemKind) {\n    CompletionItemKind[CompletionItemKind[\"Text\"] = 1] = \"Text\";\n    CompletionItemKind[CompletionItemKind[\"Method\"] = 2] = \"Method\";\n    CompletionItemKind[CompletionItemKind[\"Function\"] = 3] = \"Function\";\n    CompletionItemKind[CompletionItemKind[\"Constructor\"] = 4] = \"Constructor\";\n    CompletionItemKind[CompletionItemKind[\"Field\"] = 5] = \"Field\";\n    CompletionItemKind[CompletionItemKind[\"Variable\"] = 6] = \"Variable\";\n    CompletionItemKind[CompletionItemKind[\"Class\"] = 7] = \"Class\";\n    CompletionItemKind[CompletionItemKind[\"Interface\"] = 8] = \"Interface\";\n    CompletionItemKind[CompletionItemKind[\"Module\"] = 9] = \"Module\";\n    CompletionItemKind[CompletionItemKind[\"Property\"] = 10] = \"Property\";\n    CompletionItemKind[CompletionItemKind[\"Unit\"] = 11] = \"Unit\";\n    CompletionItemKind[CompletionItemKind[\"Value\"] = 12] = \"Value\";\n    CompletionItemKind[CompletionItemKind[\"Enum\"] = 13] = \"Enum\";\n    CompletionItemKind[CompletionItemKind[\"Keyword\"] = 14] = \"Keyword\";\n    CompletionItemKind[CompletionItemKind[\"Snippet\"] = 15] = \"Snippet\";\n    CompletionItemKind[CompletionItemKind[\"Color\"] = 16] = \"Color\";\n    CompletionItemKind[CompletionItemKind[\"File\"] = 17] = \"File\";\n    CompletionItemKind[CompletionItemKind[\"Reference\"] = 18] = \"Reference\";\n    CompletionItemKind[CompletionItemKind[\"Folder\"] = 19] = \"Folder\";\n    CompletionItemKind[CompletionItemKind[\"EnumMember\"] = 20] = \"EnumMember\";\n    CompletionItemKind[CompletionItemKind[\"Constant\"] = 21] = \"Constant\";\n    CompletionItemKind[CompletionItemKind[\"Struct\"] = 22] = \"Struct\";\n    CompletionItemKind[CompletionItemKind[\"Event\"] = 23] = \"Event\";\n    CompletionItemKind[CompletionItemKind[\"Operator\"] = 24] = \"Operator\";\n    CompletionItemKind[CompletionItemKind[\"TypeParameter\"] = 25] = \"TypeParameter\";\n})(CompletionItemKind || (CompletionItemKind = {}));\nexport const PLUGIN_ID = '@krassowski/completion-manager';\nexport const KernelKind = 'Kernel';\nexport const ILSPCompletionThemeManager = new Token(PLUGIN_ID + ':ILSPCompletionThemeManager');\n//# sourceMappingURL=types.js.map","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".lsp-floating-console {\\n  position: absolute;\\n  width: 600px;\\n  min-height: 350px;\\n  height: 25%;\\n  right: 0;\\n  bottom: 0;\\n  background: rgba(255, 255, 255, 0.8);\\n  border: 3px solid rgba(204, 204, 204, 0.7);\\n  font-size: 12px;\\n  overflow-y: auto;\\n  margin: 0;\\n  list-style-type: none;\\n  padding: 5px;\\n  z-index: 100;\\n}\\n\\n.lsp-code {\\n  font-family: monospace;\\n  background: #eee;\\n  border-radius: 2px;\\n  padding: 2px 5px;\\n}\\n\\n.lsp-kind {\\n  padding: 2px 5px;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/console.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,kBAAkB;EAClB,YAAY;EACZ,iBAAiB;EACjB,WAAW;EACX,QAAQ;EACR,SAAS;EACT,oCAAoC;EACpC,0CAA0C;EAC1C,eAAe;EACf,gBAAgB;EAChB,SAAS;EACT,qBAAqB;EACrB,YAAY;EACZ,YAAY;AACd;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,kBAAkB;EAClB,gBAAgB;AAClB;;AAEA;EACE,gBAAgB;AAClB\",\"sourcesContent\":[\".lsp-floating-console {\\n  position: absolute;\\n  width: 600px;\\n  min-height: 350px;\\n  height: 25%;\\n  right: 0;\\n  bottom: 0;\\n  background: rgba(255, 255, 255, 0.8);\\n  border: 3px solid rgba(204, 204, 204, 0.7);\\n  font-size: 12px;\\n  overflow-y: auto;\\n  margin: 0;\\n  list-style-type: none;\\n  padding: 5px;\\n  z-index: 100;\\n}\\n\\n.lsp-code {\\n  font-family: monospace;\\n  background: #eee;\\n  border-radius: 2px;\\n  padding: 2px 5px;\\n}\\n\\n.lsp-kind {\\n  padding: 2px 5px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".lsp-diagnostics-panel-content {\\n  overflow-y: auto;\\n}\\n\\n.lsp-diagnostics-listing {\\n  color: var(--jp-ui-font-color1);\\n  background: var(--jp-layout-color1);\\n  font-size: var(--jp-ui-font-size1);\\n  border-spacing: 0;\\n  /* required to preserve borders of `<th>` when using position:sticky */\\n  border-collapse: separate;\\n  width: 100%;\\n}\\n\\n.lsp-diagnostics-listing thead {\\n  box-shadow: var(--jp-toolbar-box-shadow);\\n}\\n\\n.lsp-diagnostics-listing tbody {\\n  overflow-y: auto;\\n  overflow-x: hidden;\\n}\\n\\n.lsp-diagnostics-listing th,\\n.lsp-diagnostics-listing td {\\n  padding: 4px 12px 2px 12px;\\n  height: 18px;\\n}\\n\\n.lsp-diagnostics-listing th {\\n  font-weight: 500;\\n  text-align: left;\\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);\\n  background: var(--jp-layout-color1);\\n  position: sticky;\\n  top: 0;\\n  z-index: 2;\\n  white-space: nowrap;\\n  user-select: none;\\n}\\n\\n.lsp-diagnostics-listing th:not(:first-child) {\\n  border-left: var(--jp-border-width) solid var(--jp-border-color2);\\n}\\n\\n.lsp-diagnostics-listing th:hover {\\n  background: var(--jp-layout-color2);\\n}\\n\\n.lsp-diagnostics-listing tbody tr:hover {\\n  background: var(--jp-layout-color2);\\n}\\n\\n.lsp-diagnostics-listing thead th > div {\\n  flex-direction: row;\\n  display: flex;\\n}\\n\\n.lsp-diagnostics-listing thead th > div > label {\\n  flex: 1;\\n  text-overflow: ellipsis;\\n}\\n\\n.lsp-sort-icon {\\n  flex: 0;\\n  height: var(--jp-ui-font-size1);\\n  width: var(--jp-ui-font-size1);\\n}\\n\\n.lsp-sort-icon svg {\\n  display: inline;\\n  height: auto;\\n}\\n\\n.lsp-diagnostics-listing thead th:not(.lsp-sorted-header) .lsp-sort-icon {\\n  opacity: 0;\\n}\\n\\n.lsp-diagnostics-listing thead th:not(.lsp-sorted-header):hover .lsp-sort-icon {\\n  opacity: 0.5;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/diagnostics_listing.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,gBAAgB;AAClB;;AAEA;EACE,+BAA+B;EAC/B,mCAAmC;EACnC,kCAAkC;EAClC,iBAAiB;EACjB,sEAAsE;EACtE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,wCAAwC;AAC1C;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;AACpB;;AAEA;;EAEE,0BAA0B;EAC1B,YAAY;AACd;;AAEA;EACE,gBAAgB;EAChB,gBAAgB;EAChB,mEAAmE;EACnE,mCAAmC;EACnC,gBAAgB;EAChB,MAAM;EACN,UAAU;EACV,mBAAmB;EACnB,iBAAiB;AACnB;;AAEA;EACE,iEAAiE;AACnE;;AAEA;EACE,mCAAmC;AACrC;;AAEA;EACE,mCAAmC;AACrC;;AAEA;EACE,mBAAmB;EACnB,aAAa;AACf;;AAEA;EACE,OAAO;EACP,uBAAuB;AACzB;;AAEA;EACE,OAAO;EACP,+BAA+B;EAC/B,8BAA8B;AAChC;;AAEA;EACE,eAAe;EACf,YAAY;AACd;;AAEA;EACE,UAAU;AACZ;;AAEA;EACE,YAAY;AACd\",\"sourcesContent\":[\".lsp-diagnostics-panel-content {\\n  overflow-y: auto;\\n}\\n\\n.lsp-diagnostics-listing {\\n  color: var(--jp-ui-font-color1);\\n  background: var(--jp-layout-color1);\\n  font-size: var(--jp-ui-font-size1);\\n  border-spacing: 0;\\n  /* required to preserve borders of `<th>` when using position:sticky */\\n  border-collapse: separate;\\n  width: 100%;\\n}\\n\\n.lsp-diagnostics-listing thead {\\n  box-shadow: var(--jp-toolbar-box-shadow);\\n}\\n\\n.lsp-diagnostics-listing tbody {\\n  overflow-y: auto;\\n  overflow-x: hidden;\\n}\\n\\n.lsp-diagnostics-listing th,\\n.lsp-diagnostics-listing td {\\n  padding: 4px 12px 2px 12px;\\n  height: 18px;\\n}\\n\\n.lsp-diagnostics-listing th {\\n  font-weight: 500;\\n  text-align: left;\\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);\\n  background: var(--jp-layout-color1);\\n  position: sticky;\\n  top: 0;\\n  z-index: 2;\\n  white-space: nowrap;\\n  user-select: none;\\n}\\n\\n.lsp-diagnostics-listing th:not(:first-child) {\\n  border-left: var(--jp-border-width) solid var(--jp-border-color2);\\n}\\n\\n.lsp-diagnostics-listing th:hover {\\n  background: var(--jp-layout-color2);\\n}\\n\\n.lsp-diagnostics-listing tbody tr:hover {\\n  background: var(--jp-layout-color2);\\n}\\n\\n.lsp-diagnostics-listing thead th > div {\\n  flex-direction: row;\\n  display: flex;\\n}\\n\\n.lsp-diagnostics-listing thead th > div > label {\\n  flex: 1;\\n  text-overflow: ellipsis;\\n}\\n\\n.lsp-sort-icon {\\n  flex: 0;\\n  height: var(--jp-ui-font-size1);\\n  width: var(--jp-ui-font-size1);\\n}\\n\\n.lsp-sort-icon svg {\\n  display: inline;\\n  height: auto;\\n}\\n\\n.lsp-diagnostics-listing thead th:not(.lsp-sorted-header) .lsp-sort-icon {\\n  opacity: 0;\\n}\\n\\n.lsp-diagnostics-listing thead th:not(.lsp-sorted-header):hover .lsp-sort-icon {\\n  opacity: 0.5;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../../css-loader/dist/cjs.js!./variables/base.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_1___ from \"-!../../../css-loader/dist/cjs.js!./variables/cm-themes.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_2___ from \"-!../../../css-loader/dist/cjs.js!./variables/jupyterlab-dark.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_3___ from \"-!../../../css-loader/dist/cjs.js!./variables/jupyterlab-light.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_1___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_2___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_3___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".cm-lsp-diagnostic {\\n  text-decoration-line: underline;\\n  /* For Chrome */\\n  text-decoration-skip-ink: none;\\n}\\n\\n.cm-lsp-diagnostic-tag-Unnecessary {\\n  /*\\n   * LSP: \\\"Clients are allowed to render diagnostics with this tag faded out instead of having an error squiggle.\\\"\\n   */\\n  filter: grayscale(1);\\n  opacity: 0.7;\\n  text-decoration: none !important;\\n}\\n\\n.cm-lsp-diagnostic-tag-Deprecated {\\n  /*\\n   * LSP: \\\"Clients are allowed to rendered diagnostics with this tag strike through.\\\"\\n   */\\n  text-decoration: line-through !important;\\n}\\n\\n.cm-lsp-diagnostic-Error {\\n  /*\\n    \\\"wavy\\\" would be ideal, but there seems to be a bug in Chrome which makes it\\n    fail to render the last character see:\\n    https://stackoverflow.com/questions/57559588/how-to-make-the-wavy-underline-extend-cover-all-the-characters-in-chrome\\n    an alternative would be to use background image trick to simulate the underline\\n  */\\n\\n  text-decoration-style: var(\\n    --jp-editor-mirror-lsp-diagnostic-decoration-style\\n  );\\n  text-decoration-color: var(\\n    --jp-editor-mirror-lsp-diagnostic-error-decoration-color\\n  );\\n}\\n\\n.cm-lsp-diagnostic-Warning {\\n  text-decoration-style: var(\\n    --jp-editor-mirror-lsp-diagnostic-decoration-style\\n  );\\n  text-decoration-color: var(\\n    --jp-editor-mirror-lsp-diagnostic-warning-decoration-color\\n  );\\n}\\n\\n.cm-lsp-diagnostic-Information {\\n  text-decoration-style: var(\\n    --jp-editor-mirror-lsp-diagnostic-decoration-style\\n  );\\n  text-decoration-color: var(\\n    --jp-editor-mirror-lsp-diagnostic-information-decoration-color\\n  );\\n}\\n\\n.cm-lsp-diagnostic-Hint {\\n  text-decoration-style: var(\\n    --jp-editor-mirror-lsp-diagnostic-decoration-style\\n  );\\n  text-decoration-color: var(\\n    --jp-editor-mirror-lsp-diagnostic-hint-decoration-color\\n  );\\n}\\n\\n/* hover */\\n.cm-lsp-hover-available {\\n  text-decoration: var(--jp-editor-mirror-lsp-hover-decoration-style);\\n  text-decoration-color: var(--jp-editor-mirror-lsp-hover-decoration-color);\\n  text-decoration-line: underline;\\n  text-decoration-skip-ink: none;\\n}\\n\\n/* highlight */\\n.cm-lsp-highlight {\\n  background-color: var(--jp-editor-mirror-lsp-highlight-background-color);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/highlight.css\"],\"names\":[],\"mappings\":\"AAKA;EACE,+BAA+B;EAC/B,eAAe;EACf,8BAA8B;AAChC;;AAEA;EACE;;IAEE;EACF,oBAAoB;EACpB,YAAY;EACZ,gCAAgC;AAClC;;AAEA;EACE;;IAEE;EACF,wCAAwC;AAC1C;;AAEA;EACE;;;;;GAKC;;EAED;;GAEC;EACD;;GAEC;AACH;;AAEA;EACE;;GAEC;EACD;;GAEC;AACH;;AAEA;EACE;;GAEC;EACD;;GAEC;AACH;;AAEA;EACE;;GAEC;EACD;;GAEC;AACH;;AAEA,UAAU;AACV;EACE,mEAAmE;EACnE,yEAAyE;EACzE,+BAA+B;EAC/B,8BAA8B;AAChC;;AAEA,cAAc;AACd;EACE,wEAAwE;AAC1E\",\"sourcesContent\":[\"@import url('./variables/base.css');\\n@import url('./variables/cm-themes.css');\\n@import url('./variables/jupyterlab-dark.css');\\n@import url('./variables/jupyterlab-light.css');\\n\\n.cm-lsp-diagnostic {\\n  text-decoration-line: underline;\\n  /* For Chrome */\\n  text-decoration-skip-ink: none;\\n}\\n\\n.cm-lsp-diagnostic-tag-Unnecessary {\\n  /*\\n   * LSP: \\\"Clients are allowed to render diagnostics with this tag faded out instead of having an error squiggle.\\\"\\n   */\\n  filter: grayscale(1);\\n  opacity: 0.7;\\n  text-decoration: none !important;\\n}\\n\\n.cm-lsp-diagnostic-tag-Deprecated {\\n  /*\\n   * LSP: \\\"Clients are allowed to rendered diagnostics with this tag strike through.\\\"\\n   */\\n  text-decoration: line-through !important;\\n}\\n\\n.cm-lsp-diagnostic-Error {\\n  /*\\n    \\\"wavy\\\" would be ideal, but there seems to be a bug in Chrome which makes it\\n    fail to render the last character see:\\n    https://stackoverflow.com/questions/57559588/how-to-make-the-wavy-underline-extend-cover-all-the-characters-in-chrome\\n    an alternative would be to use background image trick to simulate the underline\\n  */\\n\\n  text-decoration-style: var(\\n    --jp-editor-mirror-lsp-diagnostic-decoration-style\\n  );\\n  text-decoration-color: var(\\n    --jp-editor-mirror-lsp-diagnostic-error-decoration-color\\n  );\\n}\\n\\n.cm-lsp-diagnostic-Warning {\\n  text-decoration-style: var(\\n    --jp-editor-mirror-lsp-diagnostic-decoration-style\\n  );\\n  text-decoration-color: var(\\n    --jp-editor-mirror-lsp-diagnostic-warning-decoration-color\\n  );\\n}\\n\\n.cm-lsp-diagnostic-Information {\\n  text-decoration-style: var(\\n    --jp-editor-mirror-lsp-diagnostic-decoration-style\\n  );\\n  text-decoration-color: var(\\n    --jp-editor-mirror-lsp-diagnostic-information-decoration-color\\n  );\\n}\\n\\n.cm-lsp-diagnostic-Hint {\\n  text-decoration-style: var(\\n    --jp-editor-mirror-lsp-diagnostic-decoration-style\\n  );\\n  text-decoration-color: var(\\n    --jp-editor-mirror-lsp-diagnostic-hint-decoration-color\\n  );\\n}\\n\\n/* hover */\\n.cm-lsp-hover-available {\\n  text-decoration: var(--jp-editor-mirror-lsp-hover-decoration-style);\\n  text-decoration-color: var(--jp-editor-mirror-lsp-hover-decoration-color);\\n  text-decoration-line: underline;\\n  text-decoration-skip-ink: none;\\n}\\n\\n/* highlight */\\n.cm-lsp-highlight {\\n  background-color: var(--jp-editor-mirror-lsp-highlight-background-color);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_0___ from \"-!../../../css-loader/dist/cjs.js!./highlight.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_1___ from \"-!../../../css-loader/dist/cjs.js!./tooltip.css\";\nimport ___CSS_LOADER_AT_RULE_IMPORT_2___ from \"-!../../../css-loader/dist/cjs.js!./signature.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_0___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_1___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_AT_RULE_IMPORT_2___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".lsp-document-locator:hover {\\n  cursor: pointer;\\n}\\n\\n.lsp-document-locator span:not(:last-child)::after {\\n  content: ' > ';\\n}\\n\\n.lsp-icon-flip-x {\\n  transform: scaleX(-1);\\n  transform-origin: center center;\\n}\\n\\n.lsp-external-link {\\n  color: var(--jp-content-link-color);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/index.css\"],\"names\":[],\"mappings\":\"AAIA;EACE,eAAe;AACjB;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE,qBAAqB;EACrB,+BAA+B;AACjC;;AAEA;EACE,mCAAmC;AACrC\",\"sourcesContent\":[\"@import url('./highlight.css');\\n@import url('./tooltip.css');\\n@import url('./signature.css');\\n\\n.lsp-document-locator:hover {\\n  cursor: pointer;\\n}\\n\\n.lsp-document-locator span:not(:last-child)::after {\\n  content: ' > ';\\n}\\n\\n.lsp-icon-flip-x {\\n  transform: scaleX(-1);\\n  transform-origin: center center;\\n}\\n\\n.lsp-external-link {\\n  color: var(--jp-content-link-color);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".lsp-signature-help pre code {\\n  font-size: var(--jp-code-font-size);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/signature.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,mCAAmC;AACrC\",\"sourcesContent\":[\".lsp-signature-help pre code {\\n  font-size: var(--jp-code-font-size);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".lsp-popover {\\n  /* jupyterlab Menu */\\n  z-index: 10000;\\n  padding: 4px 0px;\\n  background: var(--jp-layout-color0);\\n  color: var(--jp-ui-font-color1);\\n  border: var(--jp-border-width) solid var(--jp-border-color1);\\n  font-size: var(--jp-ui-font-size1);\\n  box-shadow: var(--jp-elevation-z6);\\n}\\n\\n.lsp-popover-content {\\n  padding: 5px 10px;\\n}\\n\\n.lsp-servers-title {\\n  margin-bottom: 5px;\\n}\\n\\n.lsp-servers-menu {\\n  height: 350px;\\n  overflow-y: auto;\\n}\\n\\n.lsp-server-status,\\n.lsp-missing-server,\\n.lsp-documents-by-language {\\n  margin-left: 20px;\\n}\\n\\nh5 .lsp-language-server-name {\\n  color: var(--jp-ui-font-color2);\\n}\\n\\n.lsp-documents-by-language ul,\\n.lsp-server-status ul {\\n  margin: 0;\\n  padding-left: 25px;\\n}\\n\\n.lsp-servers-menu h5 {\\n  font-weight: normal;\\n  font-size: 100%;\\n  white-space: nowrap;\\n}\\n\\n.lsp-servers-lists {\\n  margin-left: 5px;\\n}\\n\\n.lsp-popover-status {\\n  padding-top: 5px;\\n  border-top: 1px solid var(--jp-border-color1);\\n}\\n\\n.lsp-popover-status a {\\n  color: var(--jp-content-link-color);\\n}\\n\\n.lsp-servers-menu h3,\\nh4,\\nh5 {\\n  margin: 0;\\n}\\n\\n.lsp-documents-by-language li {\\n  width: 100%;\\n  display: flex;\\n  justify-content: space-between;\\n}\\n\\n.lsp-document-status {\\n  float: right;\\n  padding-left: 15px;\\n}\\n\\n.lsp-document-status-icon {\\n  margin-left: 5px;\\n  position: relative;\\n  top: 3px;\\n}\\n\\n.lsp-collapsible-list h4 {\\n  cursor: pointer;\\n}\\n\\n.lsp-collapsible-list .lsp-caret-icon {\\n  position: relative;\\n  top: 3px;\\n}\\n\\n.lsp-collapsible-list.lsp-collapsed div {\\n  display: none;\\n}\\n\\n.lsp-statusbar-item {\\n  overflow: hidden;\\n  white-space: nowrap;\\n}\\n\\n.lsp-status-icon.ready svg g {\\n  fill: var(--jp-success-color0);\\n}\\n\\n.lsp-status-icon.preparing svg g {\\n  fill: var(--jp-warn-color0);\\n}\\n\\n.lsp-status-icon.error svg g {\\n  fill: var(--jp-error-color0);\\n}\\n\\n.lsp-status-icon.inactive svg g {\\n  fill: var(--jp-layout-color3);\\n}\\n\\n.lsp-status-message {\\n  user-select: none;\\n}\\n\\nbody[data-jp-theme-light='false'] .lsp-status-icon.ready svg g {\\n  fill: var(--jp-success-color1);\\n}\\n\\n.lsp-statusbar-item.jp-mod-selected .jp-icon-selectable[fill] {\\n  fill: #fff;\\n}\\n\\n.jp-ToolbarButton .lsp-status-icon svg {\\n  top: 5px;\\n}\\n\\n.lsp-help-button {\\n  background: var(--jp-layout-color2);\\n  border: 1px solid var(--jp-brand-color0);\\n  float: right;\\n}\\n\\n.lsp-help-button:hover {\\n  background: var(--jp-layout-color3);\\n}\\n\\n.lsp-server-links-list a {\\n  color: var(--jp-content-link-color);\\n}\\n\\n.lsp-troubleshoot-section {\\n  white-space: pre-wrap;\\n  margin: 10px 0;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/statusbar.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,oBAAoB;EACpB,cAAc;EACd,gBAAgB;EAChB,mCAAmC;EACnC,+BAA+B;EAC/B,4DAA4D;EAC5D,kCAAkC;EAClC,kCAAkC;AACpC;;AAEA;EACE,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,aAAa;EACb,gBAAgB;AAClB;;AAEA;;;EAGE,iBAAiB;AACnB;;AAEA;EACE,+BAA+B;AACjC;;AAEA;;EAEE,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,mBAAmB;EACnB,eAAe;EACf,mBAAmB;AACrB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,gBAAgB;EAChB,6CAA6C;AAC/C;;AAEA;EACE,mCAAmC;AACrC;;AAEA;;;EAGE,SAAS;AACX;;AAEA;EACE,WAAW;EACX,aAAa;EACb,8BAA8B;AAChC;;AAEA;EACE,YAAY;EACZ,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,QAAQ;AACV;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,kBAAkB;EAClB,QAAQ;AACV;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,gBAAgB;EAChB,mBAAmB;AACrB;;AAEA;EACE,8BAA8B;AAChC;;AAEA;EACE,2BAA2B;AAC7B;;AAEA;EACE,4BAA4B;AAC9B;;AAEA;EACE,6BAA6B;AAC/B;;AAEA;EACE,iBAAiB;AACnB;;AAEA;EACE,8BAA8B;AAChC;;AAEA;EACE,UAAU;AACZ;;AAEA;EACE,QAAQ;AACV;;AAEA;EACE,mCAAmC;EACnC,wCAAwC;EACxC,YAAY;AACd;;AAEA;EACE,mCAAmC;AACrC;;AAEA;EACE,mCAAmC;AACrC;;AAEA;EACE,qBAAqB;EACrB,cAAc;AAChB\",\"sourcesContent\":[\".lsp-popover {\\n  /* jupyterlab Menu */\\n  z-index: 10000;\\n  padding: 4px 0px;\\n  background: var(--jp-layout-color0);\\n  color: var(--jp-ui-font-color1);\\n  border: var(--jp-border-width) solid var(--jp-border-color1);\\n  font-size: var(--jp-ui-font-size1);\\n  box-shadow: var(--jp-elevation-z6);\\n}\\n\\n.lsp-popover-content {\\n  padding: 5px 10px;\\n}\\n\\n.lsp-servers-title {\\n  margin-bottom: 5px;\\n}\\n\\n.lsp-servers-menu {\\n  height: 350px;\\n  overflow-y: auto;\\n}\\n\\n.lsp-server-status,\\n.lsp-missing-server,\\n.lsp-documents-by-language {\\n  margin-left: 20px;\\n}\\n\\nh5 .lsp-language-server-name {\\n  color: var(--jp-ui-font-color2);\\n}\\n\\n.lsp-documents-by-language ul,\\n.lsp-server-status ul {\\n  margin: 0;\\n  padding-left: 25px;\\n}\\n\\n.lsp-servers-menu h5 {\\n  font-weight: normal;\\n  font-size: 100%;\\n  white-space: nowrap;\\n}\\n\\n.lsp-servers-lists {\\n  margin-left: 5px;\\n}\\n\\n.lsp-popover-status {\\n  padding-top: 5px;\\n  border-top: 1px solid var(--jp-border-color1);\\n}\\n\\n.lsp-popover-status a {\\n  color: var(--jp-content-link-color);\\n}\\n\\n.lsp-servers-menu h3,\\nh4,\\nh5 {\\n  margin: 0;\\n}\\n\\n.lsp-documents-by-language li {\\n  width: 100%;\\n  display: flex;\\n  justify-content: space-between;\\n}\\n\\n.lsp-document-status {\\n  float: right;\\n  padding-left: 15px;\\n}\\n\\n.lsp-document-status-icon {\\n  margin-left: 5px;\\n  position: relative;\\n  top: 3px;\\n}\\n\\n.lsp-collapsible-list h4 {\\n  cursor: pointer;\\n}\\n\\n.lsp-collapsible-list .lsp-caret-icon {\\n  position: relative;\\n  top: 3px;\\n}\\n\\n.lsp-collapsible-list.lsp-collapsed div {\\n  display: none;\\n}\\n\\n.lsp-statusbar-item {\\n  overflow: hidden;\\n  white-space: nowrap;\\n}\\n\\n.lsp-status-icon.ready svg g {\\n  fill: var(--jp-success-color0);\\n}\\n\\n.lsp-status-icon.preparing svg g {\\n  fill: var(--jp-warn-color0);\\n}\\n\\n.lsp-status-icon.error svg g {\\n  fill: var(--jp-error-color0);\\n}\\n\\n.lsp-status-icon.inactive svg g {\\n  fill: var(--jp-layout-color3);\\n}\\n\\n.lsp-status-message {\\n  user-select: none;\\n}\\n\\nbody[data-jp-theme-light='false'] .lsp-status-icon.ready svg g {\\n  fill: var(--jp-success-color1);\\n}\\n\\n.lsp-statusbar-item.jp-mod-selected .jp-icon-selectable[fill] {\\n  fill: #fff;\\n}\\n\\n.jp-ToolbarButton .lsp-status-icon svg {\\n  top: 5px;\\n}\\n\\n.lsp-help-button {\\n  background: var(--jp-layout-color2);\\n  border: 1px solid var(--jp-brand-color0);\\n  float: right;\\n}\\n\\n.lsp-help-button:hover {\\n  background: var(--jp-layout-color3);\\n}\\n\\n.lsp-server-links-list a {\\n  color: var(--jp-content-link-color);\\n}\\n\\n.lsp-troubleshoot-section {\\n  white-space: pre-wrap;\\n  margin: 10px 0;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".lsp-tooltip .jp-RenderedHTMLCommon {\\n  /* Reduce the default padding from 20px to 0px */\\n  padding-right: 0px;\\n}\\n\\n.lsp-tooltip .jp-RenderedHTMLCommon > *:last-child {\\n  /* Reduce the default margin */\\n  margin-bottom: 0;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/tooltip.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,gDAAgD;EAChD,kBAAkB;AACpB;;AAEA;EACE,8BAA8B;EAC9B,gBAAgB;AAClB\",\"sourcesContent\":[\".lsp-tooltip .jp-RenderedHTMLCommon {\\n  /* Reduce the default padding from 20px to 0px */\\n  padding-right: 0px;\\n}\\n\\n.lsp-tooltip .jp-RenderedHTMLCommon > *:last-child {\\n  /* Reduce the default margin */\\n  margin-bottom: 0;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \":root {\\n  /* highlight */\\n  --jp-editor-mirror-lsp-highlight-background-color: var(--jp-layout-color2);\\n  /* diagnostics */\\n  --jp-editor-mirror-lsp-diagnostic-decoration-style: dashed;\\n  --jp-editor-mirror-lsp-diagnostic-error-decoration-color: var(\\n    --jp-error-color1\\n  );\\n  --jp-editor-mirror-lsp-diagnostic-warning-decoration-color: var(\\n    --jp-warn-color1\\n  );\\n  --jp-editor-mirror-lsp-diagnostic-information-decoration-color: var(\\n    --jp-info-color1\\n  );\\n  --jp-editor-mirror-lsp-diagnostic-hint-decoration-color: var(\\n    --jp-success-color1\\n  );\\n  /* hover */\\n  --jp-editor-mirror-lsp-hover-decoration-style: dotted;\\n  --jp-editor-mirror-lsp-hover-decoration-color: var(--jp-brand-color1);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/variables/base.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,cAAc;EACd,0EAA0E;EAC1E,gBAAgB;EAChB,0DAA0D;EAC1D;;GAEC;EACD;;GAEC;EACD;;GAEC;EACD;;GAEC;EACD,UAAU;EACV,qDAAqD;EACrD,qEAAqE;AACvE\",\"sourcesContent\":[\":root {\\n  /* highlight */\\n  --jp-editor-mirror-lsp-highlight-background-color: var(--jp-layout-color2);\\n  /* diagnostics */\\n  --jp-editor-mirror-lsp-diagnostic-decoration-style: dashed;\\n  --jp-editor-mirror-lsp-diagnostic-error-decoration-color: var(\\n    --jp-error-color1\\n  );\\n  --jp-editor-mirror-lsp-diagnostic-warning-decoration-color: var(\\n    --jp-warn-color1\\n  );\\n  --jp-editor-mirror-lsp-diagnostic-information-decoration-color: var(\\n    --jp-info-color1\\n  );\\n  --jp-editor-mirror-lsp-diagnostic-hint-decoration-color: var(\\n    --jp-success-color1\\n  );\\n  /* hover */\\n  --jp-editor-mirror-lsp-hover-decoration-style: dotted;\\n  --jp-editor-mirror-lsp-hover-decoration-color: var(--jp-brand-color1);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".cm-s-abcdef {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(144, 199, 255, 0.2);\\n}\\n\\n.cm-s-base16-dark {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\\n}\\n\\n.cm-s-base16-light {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(186, 192, 161, 0.1);\\n}\\n\\n.cm-s-default {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\\n}\\n\\n.cm-s-hopscotch {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(207, 18, 255, 0.2);\\n}\\n\\n.cm-s-material {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 255, 58, 0.2);\\n}\\n\\n.cm-s-mbo {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\\n}\\n\\n.cm-s-material {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\\n}\\n\\n.cm-s-mdn-like {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\\n}\\n\\n.cm-s-seti {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\\n}\\n\\n.cm-s-solarized {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\\n}\\n\\n.cm-s-the-matrix {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.1);\\n}\\n\\n.cm-s-xq-light {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\\n}\\n\\n.cm-s-zenburn {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/variables/cm-themes.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,2EAA2E;AAC7E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,yEAAyE;AAC3E;;AAEA;EACE,0EAA0E;AAC5E;;AAEA;EACE,yEAAyE;AAC3E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,yEAAyE;AAC3E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,yEAAyE;AAC3E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,yEAAyE;AAC3E;;AAEA;EACE,2EAA2E;AAC7E\",\"sourcesContent\":[\".cm-s-abcdef {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(144, 199, 255, 0.2);\\n}\\n\\n.cm-s-base16-dark {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\\n}\\n\\n.cm-s-base16-light {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(186, 192, 161, 0.1);\\n}\\n\\n.cm-s-default {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\\n}\\n\\n.cm-s-hopscotch {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(207, 18, 255, 0.2);\\n}\\n\\n.cm-s-material {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 255, 58, 0.2);\\n}\\n\\n.cm-s-mbo {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\\n}\\n\\n.cm-s-material {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\\n}\\n\\n.cm-s-mdn-like {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\\n}\\n\\n.cm-s-seti {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\\n}\\n\\n.cm-s-solarized {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\\n}\\n\\n.cm-s-the-matrix {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.1);\\n}\\n\\n.cm-s-xq-light {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\\n}\\n\\n.cm-s-zenburn {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"body[data-jp-theme-light='false'] .cm-s-jupyter {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(151, 173, 255, 0.3);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/variables/jupyterlab-dark.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,2EAA2E;AAC7E\",\"sourcesContent\":[\"body[data-jp-theme-light='false'] .cm-s-jupyter {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(151, 173, 255, 0.3);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"body[data-jp-theme-light='true'] .cm-s-jupyter {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@krassowski/jupyterlab-lsp/style/variables/jupyterlab-light.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,yEAAyE;AAC3E\",\"sourcesContent\":[\"body[data-jp-theme-light='true'] .cm-s-jupyter {\\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n"],"sourceRoot":""}